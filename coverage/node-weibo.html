<!DOCTYPE html><html><head><title>Coverage</title><script>

headings = [];

onload = function(){
  headings = document.querySelectorAll('h2');
};

onscroll = function(e){
  var heading = find(window.scrollY);
  if (!heading) return;
  var links = document.querySelectorAll('#menu a')
    , link;

  for (var i = 0, len = links.length; i < len; ++i) {
    link = links[i];
    link.className = link.getAttribute('href') == '#' + heading.id
      ? 'active'
      : '';
  }
};

function find(y) {
  var i = headings.length
    , heading;

  while (i--) {
    heading = headings[i];
    if (y > heading.offsetTop) {
      return heading;
    }
  }
}
</script><style>

body {
  font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
  color: #2C2C2C;
  border-top: 2px solid #ddd;
}

#coverage {
  padding: 60px;
}

h1 a {
  color: inherit;
  font-weight: inherit;
}

h1 a:hover {
  text-decoration: none;
}

.onload h1 {
  opacity: 1;
}

h2 {
  width: 80%;
  margin-top: 80px;
  margin-bottom: 0;
  font-weight: 100;
  letter-spacing: 1px;
  border-bottom: 1px solid #eee;
}

a {
  color: #8A6343;
  font-weight: bold;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

ul {
  margin-top: 20px;
  padding: 0 15px;
  width: 100%;
}

ul li {
  float: left;
  width: 40%;
  margin-top: 5px;
  margin-right: 60px;
  list-style: none;
  border-bottom: 1px solid #eee;
  padding: 5px 0;
  font-size: 12px;
}

ul::after {
  content: '.';
  height: 0;
  display: block;
  visibility: hidden;
  clear: both;
}

code {
  font: 12px monaco, monospace;
}

pre {
  margin: 30px;
  padding: 30px;
  border: 1px solid #eee;
  border-bottom-color: #ddd;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -webkit-box-shadow: inset 0 0 10px #eee;
  -moz-box-shadow: inset 0 0 10px #eee;
  overflow-x: auto;
}

img {
  margin: 30px;
  padding: 1px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  max-width: 100%;
}

footer {
  background: #eee;
  width: 100%;
  padding: 50px 0;
  text-align: right;
  border-top: 1px solid #ddd;
}

footer span {
  display: block;
  margin-right: 30px;
  color: #888;
  font-size: 12px;
}

#menu {
  position: fixed;
  font-size: 12px;
  overflow-y: auto;
  top: 0;
  right: 0;
  margin: 0;
  height: 100%;
  padding: 15px 0;
  text-align: right;
  border-left: 1px solid #eee;
  -moz-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-font-smoothing: antialiased;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#logo {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(255,255,255,.1);
  font-size: 11px;
  display: block;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  -webkit-border-radius: 20px;
  -moz-border-radius: 20px;
  -webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
  -moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
  color: inherit;
}

#menu li a {
  display: block;
  color: white;
  padding: 0 35px 0 25px;
  -webkit-transition: background 300ms;
  -moz-transition: background 300ms;
}

#menu li {
  position: relative;
  list-style: none;
}

#menu a:hover,
#menu a.active {
  text-decoration: none;
  background: rgba(255,255,255,.1);
}

#menu li:hover .cov {
  opacity: 1;
}

#menu li .dirname {
  opacity: .60;
  padding-right: 2px;
}

#menu li .basename {
  opacity: 1;
}

#menu .cov {
  background: rgba(0,0,0,.4);
  position: absolute;
  top: 0;
  right: 8px;
  font-size: 9px;
  opacity: .6;
  text-align: left;
  width: 17px;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  padding: 2px 3px;
  text-align: center;
}

#stats:nth-child(2n) {
  display: inline-block;
  margin-top: 15px;
  border: 1px solid #eee;
  padding: 10px;
  -webkit-box-shadow: inset 0 0 2px #eee;
  -moz-box-shadow: inset 0 0 2px #eee;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
}

#stats div {
  float: left;
  padding: 0 5px;
}

#stats::after {
  display: block;
  content: '';
  clear: both;
}

#stats .sloc::after {
  content: ' SLOC';
  color: #b6b6b6;
}

#stats .percentage::after {
  content: ' coverage';
  color: #b6b6b6;
}

#stats .hits,
#stats .misses {
  display: none;
}

.high {
  color: #00d4b4;
}
.medium {
  color: #e87d0d;
}
.low {
  color: #d4081a;
}
.terrible {
  color: #d4081a;
  font-weight: bold;
}

table {
  width: 80%;
  margin-top: 10px;
  border-collapse: collapse;
  border: 1px solid #cbcbcb;
  color: #363636;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
}

table thead {
  display: none;
}

table td.line,
table td.hits {
  width: 20px;
  background: #eaeaea;
  text-align: center;
  font-size: 11px;
  padding: 0 10px;
  color: #949494;
}

table td.hits {
  width: 10px;
  padding: 2px 5px;
  color: rgba(0,0,0,.2);
  background: #f0f0f0;
}

tr.miss td.line,
tr.miss td.hits {
  background: #e6c3c7;
}

tr.miss td {
  background: #f8d5d8;
}

td.source {
  padding-left: 15px;
  line-height: 15px;
  white-space: pre;
  font: 12px monaco, monospace;
}

code .comment { color: #ddd }
code .init { color: #2F6FAD }
code .string { color: #5890AD }
code .keyword { color: #8A6343 }
code .number { color: #2F6FAD }
</style></head><body><div id="coverage"><h1 id="overview">Coverage</h1><div id="menu"><li><a href="#overview">overview</a></li><li><span class="cov high">77</span><a href="#tapi.js"><span class="basename">tapi.js</span></a></li><li><span class="cov high">95</span><a href="#utils.js"><span class="basename">utils.js</span></a></li><li><span class="cov high">84</span><a href="#sha1.js"><span class="basename">sha1.js</span></a></li><li><span class="cov low">36</span><a href="#tsina.js"><span class="basename">tsina.js</span></a></li><li><span class="cov high">90</span><a href="#tbase.js"><span class="basename">tbase.js</span></a></li><li><span class="cov medium">63</span><a href="#oauth.js"><span class="basename">oauth.js</span></a></li><li><span class="cov medium">56</span><a href="#weibo_util.js"><span class="basename">weibo_util.js</span></a></li><li><span class="cov high">93</span><a href="#tqq.js"><span class="basename">tqq.js</span></a></li><li><span class="cov high">95</span><a href="#weibo.js"><span class="basename">weibo.js</span></a></li><li><span class="cov high">87</span><a href="#tbase_oauth_v2.js"><span class="basename">tbase_oauth_v2.js</span></a></li><li><span class="cov high">95</span><a href="#github.js"><span class="basename">github.js</span></a></li><li><span class="cov low">41</span><a href="#base64.js"><span class="basename">base64.js</span></a></li><a id="logo" href="http://visionmedia.github.com/mocha/">m</a></div><div id="stats" class="high"><div class="percentage">79%</div><div class="sloc">1453</div><div class="hits">1158</div><div class="misses">295</div></div><div id="files"><div class="file"><h2 id="tapi.js">tapi.js</h2><div id="stats" class="high"><div class="percentage">77%</div><div class="sloc">109</div><div class="hits">84</div><div class="misses">25</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/tapi.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var TSinaAPI = require('./tsina');</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var TQQAPI = require('./tqq');</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var WeiboAPI = require('./weibo');</td></tr><tr class="hit"> <td class="line">17</td><td class="hits">1</td><td class="source">var GithubAPI = require('./github');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">19</td><td class="hits">1</td><td class="source">var TAPI = module.exports = {</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  TYPES: {</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">    weibo: WeiboAPI, // api v2.0</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    github: GithubAPI,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    tsina: TSinaAPI, // api v1.0</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    // twitter: TwitterAPI,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    tqq: TQQAPI,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    // tsohu: TSOHUAPI </td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  enables: {},</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">   * Init API options, must init before use it.</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">   * @param {String} blogtype, blog api type, e.g.: 'weibo', 'tqq', 'github' and so on.</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">   * @param {String} appkey</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">   * @param {String} secret</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">   * @param {String|Object} [oauth_callback] or [oauth_options]</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">   *  - {String} [oauth_callback], oauth callback redirect uri.</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">   *  - {String} [oauth_scope], comma separated list of scopes. e.g.: `status, user`</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">   * @return {[type]} [description]</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  init: function (blogtype, appkey, secret, oauth_options) {</td></tr><tr class="hit"> <td class="line">43</td><td class="hits">3</td><td class="source">    if (!appkey) {</td></tr><tr class="miss"> <td class="line">44</td><td class="hits">0</td><td class="source">      throw new TypeError('appkey must be set');</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">46</td><td class="hits">3</td><td class="source">    if (!secret) {</td></tr><tr class="miss"> <td class="line">47</td><td class="hits">0</td><td class="source">      throw new TypeError('secret must be set');</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">49</td><td class="hits">3</td><td class="source">    if (typeof oauth_options === 'string') {</td></tr><tr class="hit"> <td class="line">50</td><td class="hits">3</td><td class="source">      oauth_options = {</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">        oauth_callback: oauth_options</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">      };</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">54</td><td class="hits">3</td><td class="source">    var TypeAPI = this.TYPES[blogtype];</td></tr><tr class="hit"> <td class="line">55</td><td class="hits">3</td><td class="source">    if (!TypeAPI) {</td></tr><tr class="miss"> <td class="line">56</td><td class="hits">0</td><td class="source">      throw new TypeError(blogtype + ' api not exists');</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">58</td><td class="hits">3</td><td class="source">    var options = {</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">      appkey: appkey,</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">      secret: secret</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"> <td class="line">62</td><td class="hits">3</td><td class="source">    options = utils.extend(options, oauth_options);</td></tr><tr class="hit"> <td class="line">63</td><td class="hits">3</td><td class="source">    var instance = new TypeAPI(options);</td></tr><tr class="hit"> <td class="line">64</td><td class="hits">3</td><td class="source">    this.enables[blogtype] = instance;</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">   * Auto detech which API instance to use by user.</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">   * @return {API} api instance</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">  api_dispatch: function (user) {</td></tr><tr class="hit"> <td class="line">74</td><td class="hits">115</td><td class="source">    var apiType = user.blogtype || user.blogType;</td></tr><tr class="hit"> <td class="line">75</td><td class="hits">115</td><td class="source">    return this.enables[apiType];</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">   * Get api instance config by user</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">   * @return {Object} config</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  get_config: function (user) {</td></tr><tr class="hit"> <td class="line">85</td><td class="hits">13</td><td class="source">    return this.api_dispatch(user).config;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">   * Check api support the method or not.</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">   * @param {String} method</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">   * @return {Boolean} true or false</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  support: function (user, method) {</td></tr><tr class="hit"> <td class="line">96</td><td class="hits">13</td><td class="source">    return this.get_config(user)['support_' + method] !== false;</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">   * Process text to display format.</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">   * @param {Status} status</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">   * @return {String}</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  process_text: function (user, status) {</td></tr><tr class="hit"> <td class="line">107</td><td class="hits">6</td><td class="source">    return this.api_dispatch(user).process_text(status);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">   * Utils methods</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  _timeline: function (method, user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">115</td><td class="hits">32</td><td class="source">    if (typeof cursor === 'function') {</td></tr><tr class="hit"> <td class="line">116</td><td class="hits">15</td><td class="source">      callback = cursor;</td></tr><tr class="hit"> <td class="line">117</td><td class="hits">15</td><td class="source">      cursor = null;</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">119</td><td class="hits">32</td><td class="source">    cursor = cursor || {};</td></tr><tr class="hit"> <td class="line">120</td><td class="hits">32</td><td class="source">    cursor.count = cursor.count || 20;</td></tr><tr class="hit"> <td class="line">121</td><td class="hits">32</td><td class="source">    var max_id = cursor.max_id;</td></tr><tr class="hit"> <td class="line">122</td><td class="hits">32</td><td class="source">    var self = this;</td></tr><tr class="hit"> <td class="line">123</td><td class="hits">32</td><td class="source">    return self.api_dispatch(user)[method](user, cursor, function (err, result) {</td></tr><tr class="hit"> <td class="line">124</td><td class="hits">32</td><td class="source">      if (err || !max_id) {</td></tr><tr class="hit"> <td class="line">125</td><td class="hits">32</td><td class="source">        return callback(err, result);</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">127</td><td class="hits">0</td><td class="source">      max_id = String(max_id);</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">      // ignore the max_id status</td></tr><tr class="miss"> <td class="line">129</td><td class="hits">0</td><td class="source">      var needs = [];</td></tr><tr class="miss"> <td class="line">130</td><td class="hits">0</td><td class="source">      var statuses = result.items || [];</td></tr><tr class="miss"> <td class="line">131</td><td class="hits">0</td><td class="source">      for (var i = 0, l = statuses.length; i &lt; l; i++) {</td></tr><tr class="miss"> <td class="line">132</td><td class="hits">0</td><td class="source">        var status = statuses[i];</td></tr><tr class="miss"> <td class="line">133</td><td class="hits">0</td><td class="source">        if (status.id === max_id) {</td></tr><tr class="miss"> <td class="line">134</td><td class="hits">0</td><td class="source">          continue;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">        }</td></tr><tr class="miss"> <td class="line">136</td><td class="hits">0</td><td class="source">        needs.push(status);</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">138</td><td class="hits">0</td><td class="source">      result.items = needs;</td></tr><tr class="miss"> <td class="line">139</td><td class="hits">0</td><td class="source">      callback(null, result);</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">   * Status</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">   * Post a status</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">   *</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">   * @param {User} user, oauth user.</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">   * @param {String|Object} status</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">   *  - {String} status, content text.</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">   *  - {Number} [lat], latitude.</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">   *  - {Number} [long], longitude.</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">   *  - {String} [annotations], addtional information.</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">   * @param {Function(Error, Status)} callback</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">  update: function (user, status, callback) {</td></tr><tr class="hit"> <td class="line">160</td><td class="hits">8</td><td class="source">    if (typeof status === 'string') {</td></tr><tr class="hit"> <td class="line">161</td><td class="hits">6</td><td class="source">      status = {status: status};</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">163</td><td class="hits">8</td><td class="source">    return this.api_dispatch(user).update(user, status, callback);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">   * Post a status contain an image.</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">   * @param {User} user, oauth user.</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">   * @param {String|Object} status</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">   *  - {String} status, content text.</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">   *  - {Number} [lat], latitude.</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">   *  - {Number} [long], longitude.</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">   *  - {String} [annotations], addtional information.</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">   * @param {Object} pic</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">   *  - {Buffer|ReadStream} data</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">   *  - {String} [name], image file name</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">   *  - {String} [content_type], data content type</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">   * @param {Function(Error, Status)} callback</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">  upload: function (user, status, pic, callback) {</td></tr><tr class="hit"> <td class="line">183</td><td class="hits">6</td><td class="source">    if (typeof status === 'string') {</td></tr><tr class="hit"> <td class="line">184</td><td class="hits">4</td><td class="source">      status = {status: status};</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">186</td><td class="hits">6</td><td class="source">    return this.api_dispatch(user).upload(user, status, pic, callback);</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">   * Repost a status.</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">   * @param {String|Number} id, need to repost status id.</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">   * @param {String|Object} status</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">   *  - {String} status, content text</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">   *  - {Number} [lat], latitude.</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">   *  - {Number} [long], longitude.</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">   *  - {Boolean} isComment, is comment or not, default is `false`.</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source">   * @param {Function(Error, Status)} callback</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">  repost: function (user, id, status, callback) {</td></tr><tr class="hit"> <td class="line">203</td><td class="hits">4</td><td class="source">    if (typeof status === 'string') {</td></tr><tr class="miss"> <td class="line">204</td><td class="hits">0</td><td class="source">      status = {status: status};</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">206</td><td class="hits">4</td><td class="source">    id = String(id);</td></tr><tr class="hit"> <td class="line">207</td><td class="hits">4</td><td class="source">    return this.api_dispatch(user).repost(user, id, status, callback);</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">   * Remove a status by id.</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">   * @param {String|Number} id</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">   * @param {Function(Error, Status)} callback</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">  destroy: function (user, id, callback) {</td></tr><tr class="hit"> <td class="line">219</td><td class="hits">6</td><td class="source">    id = String(id);</td></tr><tr class="hit"> <td class="line">220</td><td class="hits">6</td><td class="source">    return this.api_dispatch(user).destroy(user, id, callback);</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">  // upload_pic_url: function (data, pic, callback, context) {</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">  //   return this.api_dispatch(data).upload_pic_url(data, pic, callback, context);</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">  // },</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">  // // id &#231;&#145;&#158;&#230;&#142;&#168;</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">  // retweet: function (data, callback, context) {</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">  //   return this.api_dispatch(data).retweet(data, callback, context);</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">  // },</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">   * Get a status by id.</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">   * @param {String|Number} id</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">   * @param {Function(Error, Status)} callback</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">  show: function (user, id, callback) {</td></tr><tr class="hit"> <td class="line">241</td><td class="hits">2</td><td class="source">    return this.api_dispatch(user).show(user, String(id), callback);</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">   * Get statuses comment count and repost count by ids.</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">   * @param {String|Array} ids, separate by comma.</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">   * @param {Function(err, counts)} callback</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">   *   - {String} id</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">   *   - {Number} comments</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">   *   - {Number} reposts</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">254</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">  count: function (user, ids, callback) {</td></tr><tr class="hit"> <td class="line">256</td><td class="hits">4</td><td class="source">    if (Array.isArray(ids)) {</td></tr><tr class="miss"> <td class="line">257</td><td class="hits">0</td><td class="source">      ids = ids.join(',');</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">259</td><td class="hits">4</td><td class="source">    return this.api_dispatch(user).count(user, ids, callback);</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">   * List home timeline statuses.</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">   *   - {Array} items, [Status, ...]</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">277</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">  home_timeline: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">281</td><td class="hits">4</td><td class="source">    return this._timeline('home_timeline', user, cursor, callback);</td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">   * List home timeline statuses.</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">297</td><td class="hits"></td><td class="source">   *   - {Array} items, [Status, ...]</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">299</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">300</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source">  public_timeline: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">303</td><td class="hits">4</td><td class="source">    return this._timeline('public_timeline', user, cursor, callback);</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source">   * List user personal timeline statuses.</td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">311</td><td class="hits"></td><td class="source">   *  - {String} [uid], user id</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">   *  - {String} [screen_name], `user.screen_name`, screen_name or uid must be set at least one.</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">   *  - {String} [since_id]</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">   *  - {String} [max_id]</td></tr><tr><td class="line">315</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">318</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">319</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source">   *   - {Array} items, [Status, ...]</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">323</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">  user_timeline: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">327</td><td class="hits">4</td><td class="source">    return this._timeline('user_timeline', user, cursor, callback);</td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">   * List @me statuses.</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">334</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">335</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">342</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">   *   - {Array} items, [Status, ...]</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">347</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">348</td><td class="hits"></td><td class="source">  mentions: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">349</td><td class="hits">4</td><td class="source">    return this._timeline('mentions', user, cursor, callback);</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">353</td><td class="hits"></td><td class="source">   * List one status's reposted statuses</td></tr><tr><td class="line">354</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">355</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">   * @param {String} id, status's id</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">359</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">361</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source">   *  - {Number} [filter_by_author], only support by `weibo`;</td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">   *    Filter statuses by author type, 0: all, 1: only I following&#227;&#128;&#129;2: stranger, default is `0`.</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">367</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source">   *   - {Array} items, [Status, ...]</td></tr><tr><td class="line">369</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">371</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">372</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">373</td><td class="hits"></td><td class="source">  repost_timeline: function (user, id, cursor, callback) {</td></tr><tr class="hit"> <td class="line">374</td><td class="hits">2</td><td class="source">    if (typeof cursor === 'function') {</td></tr><tr class="miss"> <td class="line">375</td><td class="hits">0</td><td class="source">      callback = cursor;</td></tr><tr class="miss"> <td class="line">376</td><td class="hits">0</td><td class="source">      cursor = null;</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">378</td><td class="hits">2</td><td class="source">    cursor = cursor || {};</td></tr><tr class="hit"> <td class="line">379</td><td class="hits">2</td><td class="source">    cursor.id = id;</td></tr><tr class="hit"> <td class="line">380</td><td class="hits">2</td><td class="source">    return this._timeline('repost_timeline', user, cursor, callback);</td></tr><tr><td class="line">381</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">383</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source">   * Search statuses by query.</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">386</td><td class="hits"></td><td class="source">   * @param {AccessToken} user</td></tr><tr><td class="line">387</td><td class="hits"></td><td class="source">   * @param {String|Object} query</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source">   *  - {String} q, query keyword</td></tr><tr><td class="line">389</td><td class="hits"></td><td class="source">   *  - {String} [long], longitude</td></tr><tr><td class="line">390</td><td class="hits"></td><td class="source">   *  - {String} [lat], latitude</td></tr><tr><td class="line">391</td><td class="hits"></td><td class="source">   *  - {String} [radius], radius for longitude and latitude.</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">393</td><td class="hits"></td><td class="source">   *  - {Number} [count], default is `20`</td></tr><tr><td class="line">394</td><td class="hits"></td><td class="source">   *  - {Number} [page], default is the first page.</td></tr><tr><td class="line">395</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source">  search: function (user, query, cursor, callback) {</td></tr><tr class="hit"> <td class="line">399</td><td class="hits">1</td><td class="source">    if (typeof query === 'string') {</td></tr><tr class="hit"> <td class="line">400</td><td class="hits">1</td><td class="source">      query = {</td></tr><tr><td class="line">401</td><td class="hits"></td><td class="source">        q: query</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">      };</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">404</td><td class="hits">1</td><td class="source">    if (typeof cursor === 'function') {</td></tr><tr class="hit"> <td class="line">405</td><td class="hits">1</td><td class="source">      callback = cursor;</td></tr><tr class="hit"> <td class="line">406</td><td class="hits">1</td><td class="source">      cursor = null;</td></tr><tr><td class="line">407</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">408</td><td class="hits">1</td><td class="source">    return this.api_dispatch(user).search(user, query, cursor, callback);</td></tr><tr><td class="line">409</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">410</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">411</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">412</td><td class="hits"></td><td class="source">   * Favorite</td></tr><tr><td class="line">413</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source">   /**</td></tr><tr><td class="line">416</td><td class="hits"></td><td class="source">   * List favorites.</td></tr><tr><td class="line">417</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">420</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">421</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">422</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">424</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">428</td><td class="hits"></td><td class="source">   *   - {Array} items, [Favorite, ...]</td></tr><tr><td class="line">429</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">431</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">432</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source">  favorites: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">434</td><td class="hits">2</td><td class="source">    return this._timeline('favorites', user, cursor, callback);</td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">437</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source">   * Show a favorite item by item id.</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">440</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">441</td><td class="hits"></td><td class="source">   * @param {String} id, favorite item's id.</td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source">   * @param {Function(err, favorite)} callback</td></tr><tr><td class="line">443</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">444</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">445</td><td class="hits"></td><td class="source">  favorite_show: function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">446</td><td class="hits">0</td><td class="source">    return this.api_dispatch(user).favorite_show(user, id, callback);</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">448</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">449</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">   * Add a status to favorites.</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">452</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">453</td><td class="hits"></td><td class="source">   * @param {String} id, status's id.</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source">   *  - {Object} result</td></tr><tr><td class="line">456</td><td class="hits"></td><td class="source">   *   - {String} id, relation item's id.</td></tr><tr><td class="line">457</td><td class="hits"></td><td class="source">   *   - addtional infomation maybe.</td></tr><tr><td class="line">458</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">459</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">460</td><td class="hits"></td><td class="source">  favorite_create: function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">461</td><td class="hits">0</td><td class="source">    return this.api_dispatch(user).favorite_create(user, id, callback);</td></tr><tr><td class="line">462</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">463</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">464</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">465</td><td class="hits"></td><td class="source">   * Remove the status from favorites.</td></tr><tr><td class="line">466</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">467</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source">   * @param {String} id, the favorite item's id.</td></tr><tr><td class="line">469</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">   *  - {Object} result</td></tr><tr><td class="line">471</td><td class="hits"></td><td class="source">   *   - {String} id, relation item's id.</td></tr><tr><td class="line">472</td><td class="hits"></td><td class="source">   *   - addtional infomation maybe.</td></tr><tr><td class="line">473</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">474</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">475</td><td class="hits"></td><td class="source">  favorite_destroy: function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">476</td><td class="hits">0</td><td class="source">    return this.api_dispatch(user).favorite_destroy(user, id, callback);</td></tr><tr><td class="line">477</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">478</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">479</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">480</td><td class="hits"></td><td class="source">   * Comment</td></tr><tr><td class="line">481</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">482</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">484</td><td class="hits"></td><td class="source">   * List comments to my statues</td></tr><tr><td class="line">485</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">486</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">487</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">488</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">489</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">490</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">491</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">492</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">493</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">495</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">496</td><td class="hits"></td><td class="source">   *   - {Array} items, [Comment, ...]</td></tr><tr><td class="line">497</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">499</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">501</td><td class="hits"></td><td class="source">  comments_timeline: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">502</td><td class="hits">4</td><td class="source">    return this._timeline('comments_timeline', user, cursor, callback);</td></tr><tr><td class="line">503</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">505</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">506</td><td class="hits"></td><td class="source">   * List @me comments</td></tr><tr><td class="line">507</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">508</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">509</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">511</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">512</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">513</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">514</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">515</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">516</td><td class="hits"></td><td class="source">   *   - {Array} items, [Comment, ...]</td></tr><tr><td class="line">517</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">518</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">519</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">520</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">521</td><td class="hits"></td><td class="source">  comments_mentions: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">522</td><td class="hits">2</td><td class="source">    return this._timeline('comments_mentions', user, cursor, callback);</td></tr><tr><td class="line">523</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">524</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source">   * List comments post by me</td></tr><tr><td class="line">527</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">528</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">529</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">530</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">531</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">532</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">533</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">534</td><td class="hits"></td><td class="source">   *  - {Number} [filter_by_source], only support by `weibo`;</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">   *    Filter comments by source type, 0: all, 1: come from weibo, 2: come from weiqun, default is `0`.</td></tr><tr><td class="line">536</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">537</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">538</td><td class="hits"></td><td class="source">   *   - {Array} items, [Comment, ...]</td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">542</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source">  comments_by_me: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">544</td><td class="hits">2</td><td class="source">    return this._timeline('comments_by_me', user, cursor, callback);</td></tr><tr><td class="line">545</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">546</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">547</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">548</td><td class="hits"></td><td class="source">   * List comments to me</td></tr><tr><td class="line">549</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">550</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">551</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">552</td><td class="hits"></td><td class="source">   *  - {String} [since_id]</td></tr><tr><td class="line">553</td><td class="hits"></td><td class="source">   *  - {String} [max_id]</td></tr><tr><td class="line">554</td><td class="hits"></td><td class="source">   *  - {Number} [count], default is `20`</td></tr><tr><td class="line">555</td><td class="hits"></td><td class="source">   *  - {Number} [page]</td></tr><tr><td class="line">556</td><td class="hits"></td><td class="source">   *  - {Number} [filter_by_author], only support by `weibo`;</td></tr><tr><td class="line">557</td><td class="hits"></td><td class="source">   *    Filter comments by author type, 0: all, 1: I following, 2: stranger, default is `0`.</td></tr><tr><td class="line">558</td><td class="hits"></td><td class="source">   *  - {Number} [filter_by_source], only support by `weibo`;</td></tr><tr><td class="line">559</td><td class="hits"></td><td class="source">   *    Filter comments by source type, 0: all, 1: come from weibo, 2: come from weiqun, default is `0`.</td></tr><tr><td class="line">560</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">561</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">562</td><td class="hits"></td><td class="source">   *   - {Array} items, [Comment, ...]</td></tr><tr><td class="line">563</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">565</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">566</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">567</td><td class="hits"></td><td class="source">  comments_to_me: function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">568</td><td class="hits">2</td><td class="source">    return this._timeline('comments_to_me', user, cursor, callback);</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">570</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">571</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">572</td><td class="hits"></td><td class="source">   * List one status's comments</td></tr><tr><td class="line">573</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">574</td><td class="hits"></td><td class="source">   * @param {User} user</td></tr><tr><td class="line">575</td><td class="hits"></td><td class="source">   * @param {String} id, status's id</td></tr><tr><td class="line">576</td><td class="hits"></td><td class="source">   * @param {Cursor} [cursor]</td></tr><tr><td class="line">577</td><td class="hits"></td><td class="source">   *  - {String} since_id</td></tr><tr><td class="line">578</td><td class="hits"></td><td class="source">   *  - {String} max_id</td></tr><tr><td class="line">579</td><td class="hits"></td><td class="source">   *  - {String} [since_time], only for tqq</td></tr><tr><td class="line">580</td><td class="hits"></td><td class="source">   *  - {String} [max_time], only for tqq</td></tr><tr><td class="line">581</td><td class="hits"></td><td class="source">   *  - {Number} count, default is `20`</td></tr><tr><td class="line">582</td><td class="hits"></td><td class="source">   *  - {Number} page</td></tr><tr><td class="line">583</td><td class="hits"></td><td class="source">   *  - {Number} [filter_by_author], only support by `weibo`;</td></tr><tr><td class="line">584</td><td class="hits"></td><td class="source">   *    Filter comments by author type, 0: all, 1: only I following&#227;&#128;&#129;2: stranger, default is `0`.</td></tr><tr><td class="line">585</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">586</td><td class="hits"></td><td class="source">   *  {Object} result:</td></tr><tr><td class="line">587</td><td class="hits"></td><td class="source">   *   - {Array} items, [Comment, ...]</td></tr><tr><td class="line">588</td><td class="hits"></td><td class="source">   *   - {Cursor} cursor</td></tr><tr><td class="line">589</td><td class="hits"></td><td class="source">   *   - ...</td></tr><tr><td class="line">590</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">591</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">592</td><td class="hits"></td><td class="source">  comments: function (user, id, cursor, callback) {</td></tr><tr class="hit"> <td class="line">593</td><td class="hits">2</td><td class="source">    if (typeof cursor === 'function') {</td></tr><tr class="miss"> <td class="line">594</td><td class="hits">0</td><td class="source">      callback = cursor;</td></tr><tr class="miss"> <td class="line">595</td><td class="hits">0</td><td class="source">      cursor = null;</td></tr><tr><td class="line">596</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">597</td><td class="hits">2</td><td class="source">    cursor = cursor || {};</td></tr><tr class="hit"> <td class="line">598</td><td class="hits">2</td><td class="source">    cursor.id = id;</td></tr><tr class="hit"> <td class="line">599</td><td class="hits">2</td><td class="source">    return this._timeline('comments', user, cursor, callback);</td></tr><tr><td class="line">600</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">601</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">602</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">603</td><td class="hits"></td><td class="source">   * post a comment to a status</td></tr><tr><td class="line">604</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">605</td><td class="hits"></td><td class="source">   * @param {AccessToken} user</td></tr><tr><td class="line">606</td><td class="hits"></td><td class="source">   * @param {String} id, status's id</td></tr><tr><td class="line">607</td><td class="hits"></td><td class="source">   * @param {String|Object} comment</td></tr><tr><td class="line">608</td><td class="hits"></td><td class="source">   *  - {String} comment</td></tr><tr><td class="line">609</td><td class="hits"></td><td class="source">   *  - {Number} [comment_ori], same comment to the original status when comment on a repost status,</td></tr><tr><td class="line">610</td><td class="hits"></td><td class="source">   *    0: no, 1: yes, default is `0`.</td></tr><tr><td class="line">611</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">612</td><td class="hits"></td><td class="source">   *  - {Object} result</td></tr><tr><td class="line">613</td><td class="hits"></td><td class="source">   *   - {String} id, the comment id</td></tr><tr><td class="line">614</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">615</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">616</td><td class="hits"></td><td class="source">  comment_create: function (user, id, comment, callback) {</td></tr><tr class="hit"> <td class="line">617</td><td class="hits">7</td><td class="source">    if (typeof comment === 'string') {</td></tr><tr class="hit"> <td class="line">618</td><td class="hits">7</td><td class="source">      comment = {comment: comment};</td></tr><tr><td class="line">619</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">620</td><td class="hits">7</td><td class="source">    return this.api_dispatch(user).comment_create(user, id, comment, callback);</td></tr><tr><td class="line">621</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">622</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">623</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">624</td><td class="hits"></td><td class="source">   * reply to a comment</td></tr><tr><td class="line">625</td><td class="hits"></td><td class="source">   * @param {AccessToken} user</td></tr><tr><td class="line">626</td><td class="hits"></td><td class="source">   * @param {String} cid, comment's id</td></tr><tr><td class="line">627</td><td class="hits"></td><td class="source">   * @param {String} id, status's id</td></tr><tr><td class="line">628</td><td class="hits"></td><td class="source">   * @param {String|Object} comment</td></tr><tr><td class="line">629</td><td class="hits"></td><td class="source">   *  - {String} comment</td></tr><tr><td class="line">630</td><td class="hits"></td><td class="source">   *  - {Number} without_mention, don't auto add `'reply@username'` to comment text or not,</td></tr><tr><td class="line">631</td><td class="hits"></td><td class="source">   *    0: yes, 1: no, default is `0`, won't auto add.</td></tr><tr><td class="line">632</td><td class="hits"></td><td class="source">   *  - {Number} [comment_ori], same comment to the original status when comment on a repost status,</td></tr><tr><td class="line">633</td><td class="hits"></td><td class="source">   *    0: no, 1: yes, default is `0`.</td></tr><tr><td class="line">634</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">635</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">636</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">637</td><td class="hits"></td><td class="source">  comment_reply: function (user, cid, id, comment, callback) {</td></tr><tr class="hit"> <td class="line">638</td><td class="hits">6</td><td class="source">    if (typeof comment === 'string') {</td></tr><tr class="hit"> <td class="line">639</td><td class="hits">6</td><td class="source">      comment = {comment: comment};</td></tr><tr><td class="line">640</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">641</td><td class="hits">6</td><td class="source">    return this.api_dispatch(user).comment_reply(user, cid, id, comment, callback);</td></tr><tr><td class="line">642</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">643</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">644</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">645</td><td class="hits"></td><td class="source">   * remove a comment</td></tr><tr><td class="line">646</td><td class="hits"></td><td class="source">   * @param {AccessToken} user</td></tr><tr><td class="line">647</td><td class="hits"></td><td class="source">   * @param {String} cid, comment's id</td></tr><tr><td class="line">648</td><td class="hits"></td><td class="source">   * @param {Function(err, result)} callback</td></tr><tr><td class="line">649</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">650</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">651</td><td class="hits"></td><td class="source">  comment_destroy: function (user, cid, callback) {</td></tr><tr class="hit"> <td class="line">652</td><td class="hits">1</td><td class="source">    return this.api_dispatch(user).comment_destroy(user, cid, callback);</td></tr><tr><td class="line">653</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">654</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">655</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">656</td><td class="hits"></td><td class="source">   * OAuth</td></tr><tr><td class="line">657</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">658</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">659</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">660</td><td class="hits"></td><td class="source">   * Get authorization token and login url.</td></tr><tr><td class="line">661</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">662</td><td class="hits"></td><td class="source">   * @param {Object} user</td></tr><tr><td class="line">663</td><td class="hits"></td><td class="source">   *  - {String} blogtype, 'weibo' or other blog type,</td></tr><tr><td class="line">664</td><td class="hits"></td><td class="source">   *  - {String} oauth_callback, 'login callback url' or 'oob'</td></tr><tr><td class="line">665</td><td class="hits"></td><td class="source">   * @param {Function(err, auth_info)} callback</td></tr><tr><td class="line">666</td><td class="hits"></td><td class="source">   *  - {Object} auth_info</td></tr><tr><td class="line">667</td><td class="hits"></td><td class="source">   *   - {String} auth_url: 'http://xxxx/auth?xxx',</td></tr><tr><td class="line">668</td><td class="hits"></td><td class="source">   *   - {String} oauth_token: $oauth_token,</td></tr><tr><td class="line">669</td><td class="hits"></td><td class="source">   *   - {String} oauth_token_secret: $oauth_token_secret</td></tr><tr><td class="line">670</td><td class="hits"></td><td class="source">   * @return {Context} this, blogType api.</td></tr><tr><td class="line">671</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">672</td><td class="hits"></td><td class="source">  get_authorization_url: function (user, callback) {</td></tr><tr class="hit"> <td class="line">673</td><td class="hits">6</td><td class="source">    return this.api_dispatch(user).get_authorization_url(user, callback);</td></tr><tr><td class="line">674</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">675</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">676</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">677</td><td class="hits"></td><td class="source">   * Get access token.</td></tr><tr><td class="line">678</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">679</td><td class="hits"></td><td class="source">   * @param {Object} user</td></tr><tr><td class="line">680</td><td class="hits"></td><td class="source">   *  - {String} blogtype</td></tr><tr><td class="line">681</td><td class="hits"></td><td class="source">   *  - {String} oauth_token, authorization `oauth_token`</td></tr><tr><td class="line">682</td><td class="hits"></td><td class="source">   *  - {String} oauth_verifier, authorization `oauth_verifier`</td></tr><tr><td class="line">683</td><td class="hits"></td><td class="source">   *  - {String} oauth_token_secret, request token secret</td></tr><tr><td class="line">684</td><td class="hits"></td><td class="source">   * @param {Function(err, token)} callback</td></tr><tr><td class="line">685</td><td class="hits"></td><td class="source">   *  - {Object} token</td></tr><tr><td class="line">686</td><td class="hits"></td><td class="source">   *   - {String} oauth_token</td></tr><tr><td class="line">687</td><td class="hits"></td><td class="source">   *   - {String} oauth_token_secret</td></tr><tr><td class="line">688</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">689</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">690</td><td class="hits"></td><td class="source">  get_access_token: function (user, callback) {</td></tr><tr class="hit"> <td class="line">691</td><td class="hits">3</td><td class="source">    return this.api_dispatch(user).get_access_token(user, callback);</td></tr><tr><td class="line">692</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">693</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">694</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">695</td><td class="hits"></td><td class="source">   * User</td></tr><tr><td class="line">696</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">697</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">698</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">699</td><td class="hits"></td><td class="source">   * Get user profile infomation by access token.</td></tr><tr><td class="line">700</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">701</td><td class="hits"></td><td class="source">   * @param {Object} user</td></tr><tr><td class="line">702</td><td class="hits"></td><td class="source">   *  - {String} blogtype</td></tr><tr><td class="line">703</td><td class="hits"></td><td class="source">   *  - {String} oauth_token, access oauth token</td></tr><tr><td class="line">704</td><td class="hits"></td><td class="source">   *  - {String} [oauth_token_secret], access oauth token secret, oauth v2 don't need this param.</td></tr><tr><td class="line">705</td><td class="hits"></td><td class="source">   * @param {Function(err, User)} callback</td></tr><tr><td class="line">706</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">707</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">708</td><td class="hits"></td><td class="source">  verify_credentials: function (user, callback) {</td></tr><tr class="hit"> <td class="line">709</td><td class="hits">3</td><td class="source">    return this.api_dispatch(user).verify_credentials(user, callback);</td></tr><tr><td class="line">710</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">711</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">712</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">713</td><td class="hits"></td><td class="source">   * Get user profile infomation by uid.</td></tr><tr><td class="line">714</td><td class="hits"></td><td class="source">   * @param {Object} user</td></tr><tr><td class="line">715</td><td class="hits"></td><td class="source">   *  - {String} blogtype</td></tr><tr><td class="line">716</td><td class="hits"></td><td class="source">   *  - {String} oauth_token, access token</td></tr><tr><td class="line">717</td><td class="hits"></td><td class="source">   *  - {String} [oauth_token_secret], access oauth token secret, oauth v2 don't need this param.</td></tr><tr><td class="line">718</td><td class="hits"></td><td class="source">   * @param {String} [uid], user id</td></tr><tr><td class="line">719</td><td class="hits"></td><td class="source">   * @param {String} [screen_name], user screen_name</td></tr><tr><td class="line">720</td><td class="hits"></td><td class="source">   *   uid and screen_name MUST set one.</td></tr><tr><td class="line">721</td><td class="hits"></td><td class="source">   * @param {Function(err, User)} callback</td></tr><tr><td class="line">722</td><td class="hits"></td><td class="source">   * @return {Context} this</td></tr><tr><td class="line">723</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">724</td><td class="hits"></td><td class="source">  user_show: function (user, uid, screen_name, callback) {</td></tr><tr class="hit"> <td class="line">725</td><td class="hits">4</td><td class="source">    if (typeof screen_name === 'function') {</td></tr><tr class="hit"> <td class="line">726</td><td class="hits">3</td><td class="source">      callback = screen_name;</td></tr><tr class="hit"> <td class="line">727</td><td class="hits">3</td><td class="source">      screen_name = null;</td></tr><tr><td class="line">728</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">729</td><td class="hits">4</td><td class="source">    return this.api_dispatch(user).user_show(user, uid, screen_name, callback);</td></tr><tr><td class="line">730</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">731</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">732</td><td class="hits"></td><td class="source">  rate_limit_status: function (user, callback) {</td></tr><tr class="miss"> <td class="line">733</td><td class="hits">0</td><td class="source">    return this.api_dispatch(user).rate_limit_status(user, callback);</td></tr><tr><td class="line">734</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">735</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">736</td><td class="hits"></td><td class="source">  /*</td></tr><tr><td class="line">737</td><td class="hits"></td><td class="source">   * id false int64/string  &#231;&#148;&#168;&#230;&#136;&#183;ID(int64)&#230;&#136;&#150;&#232;&#128;&#133;&#230;&#152;&#181;&#231;&#167;&#176;(string)&#227;&#128;&#130;&#232;&#175;&#165;&#229;&#143;&#130;&#230;&#149;&#176;&#228;&#184;&#186;&#228;&#184;&#128;&#228;&#184;&#170;REST&#233;&#163;&#142;&#230;&#160;&#188;&#229;&#143;&#130;&#230;&#149;&#176;&#227;&#128;&#130;&#232;&#176;&#131;&#231;&#148;&#168;&#231;&#164;&#186;&#228;&#190;&#139;&#232;&#167;&#129;&#230;&#179;&#168;&#230;&#132;&#143;&#228;&#186;&#139;&#233;&#161;&#185;</td></tr><tr><td class="line">738</td><td class="hits"></td><td class="source">   * user_id  false int64 &#231;&#148;&#168;&#230;&#136;&#183;ID&#239;&#188;&#140;&#228;&#184;&#187;&#232;&#166;&#129;&#230;&#152;&#175;&#231;&#148;&#168;&#230;&#157;&#165;&#229;&#140;&#186;&#229;&#136;&#134;&#231;&#148;&#168;&#230;&#136;&#183;ID&#232;&#183;&#159;&#229;&#190;&#174;&#229;&#141;&#154;&#230;&#152;&#181;&#231;&#167;&#176;&#227;&#128;&#130;&#229;&#189;&#147;&#229;&#190;&#174;&#229;&#141;&#154;&#230;&#152;&#181;&#231;&#167;&#176;&#228;&#184;&#186;&#230;&#149;&#176;&#229;&#173;&#151;&#229;&#175;&#188;&#232;&#135;&#180;&#229;&#146;&#140;&#231;&#148;&#168;&#230;&#136;&#183;ID&#228;&#186;&#167;&#231;&#148;&#159;&#230;&#173;&#167;&#228;&#185;&#137;&#239;&#188;&#140;&#231;&#137;&#185;&#229;&#136;&#171;&#230;&#152;&#175;&#229;&#189;&#147;&#229;&#190;&#174;&#229;&#141;&#154;&#230;&#152;&#181;&#231;&#167;&#176;&#229;&#146;&#140;&#231;&#148;&#168;&#230;&#136;&#183;ID&#228;&#184;&#128;&#230;&#160;&#183;&#231;&#154;&#132;&#230;&#151;&#182;&#229;&#128;&#153;&#239;&#188;&#140;&#229;&#187;&#186;&#232;&#174;&#174;&#228;&#189;&#191;&#231;&#148;&#168;&#232;&#175;&#165;&#229;&#143;&#130;&#230;&#149;&#176;</td></tr><tr><td class="line">739</td><td class="hits"></td><td class="source">   * screen_name  false string  &#229;&#190;&#174;&#229;&#141;&#154;&#230;&#152;&#181;&#231;&#167;&#176;&#239;&#188;&#140;&#228;&#184;&#187;&#232;&#166;&#129;&#230;&#152;&#175;&#231;&#148;&#168;&#230;&#157;&#165;&#229;&#140;&#186;&#229;&#136;&#134;&#231;&#148;&#168;&#230;&#136;&#183;UID&#232;&#183;&#159;&#229;&#190;&#174;&#229;&#141;&#154;&#230;&#152;&#181;&#231;&#167;&#176;&#239;&#188;&#140;&#229;&#189;&#147;&#228;&#186;&#140;&#232;&#128;&#133;&#228;&#184;&#128;&#230;&#160;&#183;&#232;&#128;&#140;&#228;&#186;&#167;&#231;&#148;&#159;&#230;&#173;&#167;&#228;&#185;&#137;&#231;&#154;&#132;&#230;&#151;&#182;&#229;&#128;&#153;&#239;&#188;&#140;&#229;&#187;&#186;&#232;&#174;&#174;&#228;&#189;&#191;&#231;&#148;&#168;&#232;&#175;&#165;&#229;&#143;&#130;&#230;&#149;&#176;</td></tr><tr><td class="line">740</td><td class="hits"></td><td class="source">   * id, user_id, screen_name &#229;&#143;&#175;&#228;&#187;&#165;&#228;&#187;&#187;&#233;&#128;&#137;&#228;&#184;&#128;&#228;&#184;&#170;&#229;&#143;&#130;&#230;&#149;&#176;&#239;&#188;&#140;&#229;&#156;&#168;3&#228;&#184;&#170;&#233;&#131;&#189;&#228;&#184;&#141;&#230;&#143;&#144;&#228;&#190;&#155;&#231;&#154;&#132;&#230;&#131;&#133;&#229;&#134;&#181;&#228;&#184;&#139;&#239;&#188;&#140;&#231;&#179;&#187;&#231;&#187;&#159;&#232;&#191;&#148;&#229;&#155;&#158;&#229;&#189;&#147;&#229;&#137;&#141;&#231;&#153;&#187;&#229;&#189;&#149;&#231;&#148;&#168;&#230;&#136;&#183;&#231;&#154;&#132;&#229;&#133;&#179;&#230;&#179;&#168;&#229;&#136;&#151;&#232;&#161;&#168;</td></tr><tr><td class="line">741</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">742</td><td class="hits"></td><td class="source">   * cursor false int &#231;&#148;&#168;&#228;&#186;&#142;&#229;&#136;&#134;&#233;&#161;&#181;&#232;&#175;&#183;&#230;&#177;&#130;&#239;&#188;&#140;&#232;&#175;&#183;&#230;&#177;&#130;&#231;&#172;&#172;1&#233;&#161;&#181;cursor&#228;&#188;&#160;-1&#239;&#188;&#140;&#229;&#156;&#168;&#232;&#191;&#148;&#229;&#155;&#158;&#231;&#154;&#132;&#231;&#187;&#147;&#230;&#158;&#156;&#228;&#184;&#173;&#228;&#188;&#154;&#229;&#190;&#151;&#229;&#136;&#176;next_cursor&#229;&#173;&#151;&#230;&#174;&#181;&#239;&#188;&#140;&#232;&#161;&#168;&#231;&#164;&#186;&#228;&#184;&#139;&#228;&#184;&#128;&#233;&#161;&#181;&#231;&#154;&#132;cursor&#227;&#128;&#130;next_cursor&#228;&#184;&#186;0&#232;&#161;&#168;&#231;&#164;&#186;&#229;&#183;&#178;&#231;&#187;&#143;&#229;&#136;&#176;&#232;&#174;&#176;&#229;&#189;&#149;&#230;&#156;&#171;&#229;&#176;&#190;&#227;&#128;&#130;</td></tr><tr><td class="line">743</td><td class="hits"></td><td class="source">   * count  false int&#239;&#188;&#140;&#233;&#187;&#152;&#232;&#174;&#164;20&#239;&#188;&#140;&#230;&#156;&#128;&#229;&#164;&#167;200  &#230;&#175;&#143;&#233;&#161;&#181;&#232;&#191;&#148;&#229;&#155;&#158;&#231;&#154;&#132;&#230;&#156;&#128;&#229;&#164;&#167;&#232;&#174;&#176;&#229;&#189;&#149;&#230;&#149;&#176;&#239;&#188;&#140;&#230;&#156;&#128;&#229;&#164;&#167;&#228;&#184;&#141;&#232;&#131;&#189;&#232;&#182;&#133;&#232;&#191;&#135;200&#239;&#188;&#140;&#233;&#187;&#152;&#232;&#174;&#164;&#228;&#184;&#186;20&#227;&#128;&#130;</td></tr><tr><td class="line">744</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">745</td><td class="hits"></td><td class="source">  friends: function (data, callback, context) {</td></tr><tr class="miss"> <td class="line">746</td><td class="hits">0</td><td class="source">    return this.api_dispatch(data).friends(data, callback, context);</td></tr><tr><td class="line">747</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">748</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">749</td><td class="hits"></td><td class="source">  // &#229;&#144;&#140;friends</td></tr><tr><td class="line">750</td><td class="hits"></td><td class="source">  followers: function (data, callback, context) {</td></tr><tr class="miss"> <td class="line">751</td><td class="hits">0</td><td class="source">    return this.api_dispatch(data).followers(data, callback, context);</td></tr><tr><td class="line">752</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">753</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">754</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">755</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">756</td><td class="hits">1</td><td class="source">TAPI.friends_timeline = TAPI.home_timeline;</td></tr></tbody></table></div><div class="file"><h2 id="utils.js">utils.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">66</div><div class="hits">63</div><div class="misses">3</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/utils.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var STRING_FORMAT_REGEX = /\{\{([\w\s\.\'\&quot;\(\),-\[\]]+)?\}\}/g;</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">exports.format = function (s, values) {</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">94</td><td class="source">  return s.replace(STRING_FORMAT_REGEX, function (match, key) {</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">39</td><td class="source">    return values[key];</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> * &#230;&#160;&#188;&#229;&#188;&#143;&#229;&#140;&#150;&#229;&#173;&#151;&#231;&#172;&#166;&#228;&#184;&#178;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> * eg:</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> *  '{0}&#229;&#164;&#169;&#230;&#156;&#137;{1}&#228;&#184;&#170;&#229;&#176;&#143;&#230;&#151;&#182;'.format([1, 24]) </td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> *  or</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> *  '{{day}}&#229;&#164;&#169;&#230;&#156;&#137;{{hour}}&#228;&#184;&#170;&#229;&#176;&#143;&#230;&#151;&#182;'.format({day:1, hour:24}})</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> * @param {Object} values</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">28</td><td class="hits">1</td><td class="source">String.prototype.format = function (values) {</td></tr><tr class="hit"> <td class="line">29</td><td class="hits">84</td><td class="source">  return exports.format(this, values);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">32</td><td class="hits">1</td><td class="source">var b64_hmac_sha1 = require('./sha1').b64_hmac_sha1;</td></tr><tr class="hit"> <td class="line">33</td><td class="hits">1</td><td class="source">var crypto = require('crypto');</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">35</td><td class="hits">1</td><td class="source">var querystring = {</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  parse: function (s) {</td></tr><tr class="hit"> <td class="line">37</td><td class="hits">7</td><td class="source">    var qs = {};</td></tr><tr class="hit"> <td class="line">38</td><td class="hits">7</td><td class="source">    if (typeof s !== 'string') {</td></tr><tr class="hit"> <td class="line">39</td><td class="hits">2</td><td class="source">      return qs;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">41</td><td class="hits">5</td><td class="source">    var pairs = s.split('&amp;');</td></tr><tr class="hit"> <td class="line">42</td><td class="hits">5</td><td class="source">    for (var i = 0, len = pairs.length; i &lt; len; i++) {</td></tr><tr class="hit"> <td class="line">43</td><td class="hits">8</td><td class="source">      var pair = pairs[i].split('=', 2);</td></tr><tr class="hit"> <td class="line">44</td><td class="hits">8</td><td class="source">      if (pair.length !== 2) {</td></tr><tr class="hit"> <td class="line">45</td><td class="hits">3</td><td class="source">        continue;</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">47</td><td class="hits">5</td><td class="source">      var key = pair[0].trim();</td></tr><tr class="hit"> <td class="line">48</td><td class="hits">5</td><td class="source">      if (!key) {</td></tr><tr class="hit"> <td class="line">49</td><td class="hits">1</td><td class="source">        continue;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">51</td><td class="hits">4</td><td class="source">      qs[decodeURIComponent(key)] = decodeURIComponent(pair[1]);</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">53</td><td class="hits">5</td><td class="source">    return qs;</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  stringify: function (data) {</td></tr><tr class="hit"> <td class="line">56</td><td class="hits">5</td><td class="source">    var pairs = [];</td></tr><tr class="hit"> <td class="line">57</td><td class="hits">5</td><td class="source">    data = data || {};</td></tr><tr class="hit"> <td class="line">58</td><td class="hits">5</td><td class="source">    for (var k in data) {</td></tr><tr class="hit"> <td class="line">59</td><td class="hits">7</td><td class="source">      pairs.push(encodeURIComponent(k) + '=' + encodeURIComponent('' + data[k]));</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">61</td><td class="hits">5</td><td class="source">    return pairs.join('&amp;');</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">65</td><td class="hits">1</td><td class="source">function urljoin(url, params) {</td></tr><tr class="hit"> <td class="line">66</td><td class="hits">5</td><td class="source">  if (typeof params === 'object') {</td></tr><tr class="hit"> <td class="line">67</td><td class="hits">4</td><td class="source">    params = querystring.stringify(params);</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">69</td><td class="hits">5</td><td class="source">  if (!params) {</td></tr><tr class="hit"> <td class="line">70</td><td class="hits">2</td><td class="source">    return url;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">72</td><td class="hits">3</td><td class="source">  if (url.indexOf('?') &lt; 0) {</td></tr><tr class="hit"> <td class="line">73</td><td class="hits">1</td><td class="source">    url += '?';</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"> <td class="line">75</td><td class="hits">2</td><td class="source">    url += '&amp;';</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">77</td><td class="hits">3</td><td class="source">  return url + params;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">80</td><td class="hits">1</td><td class="source">function base64HmacSha1(baseString, key) {</td></tr><tr class="hit"> <td class="line">81</td><td class="hits">44</td><td class="source">  if (b64_hmac_sha1) {</td></tr><tr class="hit"> <td class="line">82</td><td class="hits">44</td><td class="source">    return b64_hmac_sha1(key, baseString);</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">84</td><td class="hits">0</td><td class="source">  return new crypto.Hmac().init(&quot;sha1&quot;, key).update(baseString).digest(&quot;base64&quot;);</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">// HTML &#231;&#188;&#150;&#231;&#160;&#129;</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">// test: hard code testing &#227;&#128;&#130;&#227;&#128;&#130;&#227;&#128;&#130; '&quot;!@#$%^&amp;*()-=+ |][ {} ~` &amp;&amp;&amp;&amp;&amp;amp; &amp;lt; &amp; C++ c++c + +c &amp;amp;</td></tr><tr class="hit"> <td class="line">89</td><td class="hits">1</td><td class="source">function htmlencode(str) {</td></tr><tr class="miss"> <td class="line">90</td><td class="hits">0</td><td class="source">  if (!str) { return ''; }</td></tr><tr class="miss"> <td class="line">91</td><td class="hits">0</td><td class="source">  return str.replace(/&amp;/g, '&amp;amp;').replace(/&lt;/g, '&amp;lt;').replace(/&gt;/g, '&amp;gt;');</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">94</td><td class="hits">1</td><td class="source">exports.extend = function (destination) {</td></tr><tr class="hit"> <td class="line">95</td><td class="hits">8</td><td class="source">  for (var i = 1, len = arguments.length; i &lt; len; i++) {</td></tr><tr class="hit"> <td class="line">96</td><td class="hits">12</td><td class="source">    var source = arguments[i];</td></tr><tr class="hit"> <td class="line">97</td><td class="hits">12</td><td class="source">    if (!source) {</td></tr><tr class="hit"> <td class="line">98</td><td class="hits">1</td><td class="source">      continue;</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">11</td><td class="source">    for (var property in source) {</td></tr><tr class="hit"> <td class="line">101</td><td class="hits">109</td><td class="source">      destination[property] = source[property];</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">8</td><td class="source">  return destination;</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">107</td><td class="hits">1</td><td class="source">exports.STRING_FORMAT_REGEX = STRING_FORMAT_REGEX;</td></tr><tr class="hit"> <td class="line">108</td><td class="hits">1</td><td class="source">exports.querystring = querystring;</td></tr><tr class="hit"> <td class="line">109</td><td class="hits">1</td><td class="source">exports.base64HmacSha1 = base64HmacSha1;</td></tr><tr class="hit"> <td class="line">110</td><td class="hits">1</td><td class="source">exports.urljoin = urljoin;</td></tr><tr class="hit"> <td class="line">111</td><td class="hits">1</td><td class="source">exports.htmlencode = htmlencode;</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">113</td><td class="hits">1</td><td class="source">var MIME_TYPES = {</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  'jpg': 'image/jpeg',</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">  'jpeg': 'image/jpeg',</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">  'gif': 'image/gif',</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">  'png': 'image/png',</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">  'bmp': 'image/bmp',</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">121</td><td class="hits">1</td><td class="source">var BIN_TYPE = 'application/octet-stream';</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">123</td><td class="hits">1</td><td class="source">exports.mimeLookup = function (name, fallback) {</td></tr><tr class="hit"> <td class="line">124</td><td class="hits">19</td><td class="source">  var ext = name.replace(/.*[\.\/]/, '').toLowerCase();</td></tr><tr class="hit"> <td class="line">125</td><td class="hits">19</td><td class="source">  return MIME_TYPES[ext] || fallback || BIN_TYPE;</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source"> * Escape the given string of `html`.</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source"> * @param {String} html</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source"> * @return {String}</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">134</td><td class="hits">1</td><td class="source">exports.escape = function (html) {</td></tr><tr class="hit"> <td class="line">135</td><td class="hits">3</td><td class="source">  return String(html)</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">    .replace(/&amp;(?!\w+;)/g, '&amp;amp;')</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">    .replace(/&lt;/g, '&amp;lt;')</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    .replace(/&gt;/g, '&amp;gt;')</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">    .replace(/&quot;/g, '&amp;quot;');</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source"> * Remove all html tags.</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source"> * </td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> * @param {String} s</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> * @return {String}</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">148</td><td class="hits">1</td><td class="source">exports.removeHTML = function (s) {</td></tr><tr class="hit"> <td class="line">149</td><td class="hits">8</td><td class="source">  return s.replace(/(&lt;.*?&gt;)/ig, '');</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="sha1.js">sha1.js</h2><div id="stats" class="high"><div class="percentage">84%</div><div class="sloc">119</div><div class="hits">101</div><div class="misses">18</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * in FIPS PUB 180-1</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * Version 2.1a Copyright Paul Johnston 2000 - 2002.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> * Distributed under the BSD License</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> * See http://pajhome.org.uk/crypt/md5 for details.</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">10</td><td class="hits">1</td><td class="source">(function () {</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">12</td><td class="hits">1</td><td class="source">var root = this; // window on browser</td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var exports;</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var crypto;</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">if (typeof module === 'undefined') {</td></tr><tr class="miss"> <td class="line">16</td><td class="hits">0</td><td class="source">  root.weibo = root.weibo || {};</td></tr><tr class="miss"> <td class="line">17</td><td class="hits">0</td><td class="source">  exports = root.weibo.sha1 = {};</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="hit"> <td class="line">19</td><td class="hits">1</td><td class="source">  exports = module.exports;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> * Configurable variables. You may need to tweak these to be compatible with</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> * the server-side, but the defaults work in most cases.</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">26</td><td class="hits">1</td><td class="source">var hexcase = 0;  /* hex output format. 0 - lowercase; 1 - uppercase        */</td></tr><tr class="hit"> <td class="line">27</td><td class="hits">1</td><td class="source">var b64pad  = &quot;=&quot;; /* base-64 pad character. &quot;=&quot; for strict RFC compliance   */</td></tr><tr class="hit"> <td class="line">28</td><td class="hits">1</td><td class="source">var chrsz   = 8;  /* bits per input character. 8 - ASCII; 16 - Unicode      */</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> * These are the functions you'll usually want to call</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> * They take string arguments and return either hex or base-64 encoded strings</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">34</td><td class="hits">1</td><td class="source">function hex_sha1(s) {</td></tr><tr class="miss"> <td class="line">35</td><td class="hits">0</td><td class="source">  return binb2hex(core_sha1(str2binb(s), s.length * chrsz));</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">37</td><td class="hits">1</td><td class="source">exports.hex_sha1 = hex_sha1;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">39</td><td class="hits">1</td><td class="source">function b64_sha1(s) {</td></tr><tr class="miss"> <td class="line">40</td><td class="hits">0</td><td class="source">  return binb2b64(core_sha1(str2binb(s), s.length * chrsz));</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">42</td><td class="hits">1</td><td class="source">exports.b64_sha1 = b64_sha1;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">44</td><td class="hits">1</td><td class="source">function str_sha1(s) { </td></tr><tr class="miss"> <td class="line">45</td><td class="hits">0</td><td class="source">  return binb2str(core_sha1(str2binb(s), s.length * chrsz));</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">47</td><td class="hits">1</td><td class="source">exports.str_sha1 = str_sha1;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">49</td><td class="hits">1</td><td class="source">function hex_hmac_sha1(key, data) { </td></tr><tr class="miss"> <td class="line">50</td><td class="hits">0</td><td class="source">  return binb2hex(core_hmac_sha1(key, data));</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">52</td><td class="hits">1</td><td class="source">exports.hex_hmac_sha1 = hex_hmac_sha1;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">54</td><td class="hits">1</td><td class="source">function b64_hmac_sha1(key, data) { </td></tr><tr class="hit"> <td class="line">55</td><td class="hits">47</td><td class="source">  return binb2b64(core_hmac_sha1(key, data));</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">57</td><td class="hits">1</td><td class="source">exports.b64_hmac_sha1 = b64_hmac_sha1;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">59</td><td class="hits">1</td><td class="source">function str_hmac_sha1(key, data) { </td></tr><tr class="miss"> <td class="line">60</td><td class="hits">0</td><td class="source">  return binb2str(core_hmac_sha1(key, data));</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">62</td><td class="hits">1</td><td class="source">exports.str_hmac_sha1 = str_hmac_sha1;</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> * Perform a simple self-test to see if the VM is working</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">67</td><td class="hits">1</td><td class="source">function sha1_vm_test() {</td></tr><tr class="miss"> <td class="line">68</td><td class="hits">0</td><td class="source">  return hex_sha1(&quot;abc&quot;) === &quot;a9993e364706816aba3e25717850c26c9cd0d89d&quot;;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> * Calculate the SHA-1 of an array of big-endian words, and a bit length</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">74</td><td class="hits">1</td><td class="source">function core_sha1(x, len) {</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  /* append padding */</td></tr><tr class="hit"> <td class="line">76</td><td class="hits">133</td><td class="source">  x[len &gt;&gt; 5] |= 0x80 &lt;&lt; (24 - len % 32);</td></tr><tr class="hit"> <td class="line">77</td><td class="hits">133</td><td class="source">  x[((len + 64 &gt;&gt; 9) &lt;&lt; 4) + 15] = len;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">79</td><td class="hits">133</td><td class="source">  var w = new Array(80);</td></tr><tr class="hit"> <td class="line">80</td><td class="hits">133</td><td class="source">  var a =  1732584193;</td></tr><tr class="hit"> <td class="line">81</td><td class="hits">133</td><td class="source">  var b = -271733879;</td></tr><tr class="hit"> <td class="line">82</td><td class="hits">133</td><td class="source">  var c = -1732584194;</td></tr><tr class="hit"> <td class="line">83</td><td class="hits">133</td><td class="source">  var d =  271733878;</td></tr><tr class="hit"> <td class="line">84</td><td class="hits">133</td><td class="source">  var e = -1009589776;</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">86</td><td class="hits">133</td><td class="source">  for (var i = 0; i &lt; x.length; i += 16) {</td></tr><tr class="hit"> <td class="line">87</td><td class="hits">538</td><td class="source">    var olda = a;</td></tr><tr class="hit"> <td class="line">88</td><td class="hits">538</td><td class="source">    var oldb = b;</td></tr><tr class="hit"> <td class="line">89</td><td class="hits">538</td><td class="source">    var oldc = c;</td></tr><tr class="hit"> <td class="line">90</td><td class="hits">538</td><td class="source">    var oldd = d;</td></tr><tr class="hit"> <td class="line">91</td><td class="hits">538</td><td class="source">    var olde = e;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">93</td><td class="hits">538</td><td class="source">    for (var j = 0; j &lt; 80; j++) {</td></tr><tr class="hit"> <td class="line">94</td><td class="hits">43040</td><td class="source">      if (j &lt; 16) {</td></tr><tr class="hit"> <td class="line">95</td><td class="hits">8608</td><td class="source">        w[j] = x[i + j];</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">      else {</td></tr><tr class="hit"> <td class="line">98</td><td class="hits">34432</td><td class="source">        w[j] = rol(w[j-3] ^ w[j-8] ^ w[j-14] ^ w[j-16], 1);</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">43040</td><td class="source">      var t = safe_add(safe_add(rol(a, 5), sha1_ft(j, b, c, d)),</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">                       safe_add(safe_add(e, w[j]), sha1_kt(j)));</td></tr><tr class="hit"> <td class="line">102</td><td class="hits">43040</td><td class="source">      e = d;</td></tr><tr class="hit"> <td class="line">103</td><td class="hits">43040</td><td class="source">      d = c;</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">43040</td><td class="source">      c = rol(b, 30);</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">43040</td><td class="source">      b = a;</td></tr><tr class="hit"> <td class="line">106</td><td class="hits">43040</td><td class="source">      a = t;</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">109</td><td class="hits">538</td><td class="source">    a = safe_add(a, olda);</td></tr><tr class="hit"> <td class="line">110</td><td class="hits">538</td><td class="source">    b = safe_add(b, oldb);</td></tr><tr class="hit"> <td class="line">111</td><td class="hits">538</td><td class="source">    c = safe_add(c, oldc);</td></tr><tr class="hit"> <td class="line">112</td><td class="hits">538</td><td class="source">    d = safe_add(d, oldd);</td></tr><tr class="hit"> <td class="line">113</td><td class="hits">538</td><td class="source">    e = safe_add(e, olde);</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">115</td><td class="hits">133</td><td class="source">  return [ a, b, c, d, e ];</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source"> * Perform the appropriate triplet combination function for the current</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source"> * iteration</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">123</td><td class="hits">1</td><td class="source">function sha1_ft(t, b, c, d) {</td></tr><tr class="hit"> <td class="line">124</td><td class="hits">43040</td><td class="source">  if (t &lt; 20) {</td></tr><tr class="hit"> <td class="line">125</td><td class="hits">10760</td><td class="source">    return (b &amp; c) | ((~b) &amp; d);</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">127</td><td class="hits">32280</td><td class="source">  if (t &lt; 40) {</td></tr><tr class="hit"> <td class="line">128</td><td class="hits">10760</td><td class="source">    return b ^ c ^ d;</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">130</td><td class="hits">21520</td><td class="source">  if (t &lt; 60) {</td></tr><tr class="hit"> <td class="line">131</td><td class="hits">10760</td><td class="source">    return (b &amp; c) | (b &amp; d) | (c &amp; d);</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">133</td><td class="hits">10760</td><td class="source">  return b ^ c ^ d;</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> * Determine the appropriate additive constant for the current iteration</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">139</td><td class="hits">1</td><td class="source">function sha1_kt(t) {</td></tr><tr class="hit"> <td class="line">140</td><td class="hits">43040</td><td class="source">  return (t &lt; 20) ?  1518500249 : (t &lt; 40) ?  1859775393 :</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">         (t &lt; 60) ? -1894007588 : -899497514;</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> * Calculate the HMAC-SHA1 of a key and some data</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">147</td><td class="hits">1</td><td class="source">function core_hmac_sha1(key, data) {</td></tr><tr class="hit"> <td class="line">148</td><td class="hits">47</td><td class="source">  var bkey = str2binb(key);</td></tr><tr class="hit"> <td class="line">149</td><td class="hits">47</td><td class="source">  if (bkey.length &gt; 16) {</td></tr><tr class="hit"> <td class="line">150</td><td class="hits">39</td><td class="source">    bkey = core_sha1(bkey, key.length * chrsz);</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">153</td><td class="hits">47</td><td class="source">  var ipad = new Array(16), opad = new Array(16);</td></tr><tr class="hit"> <td class="line">154</td><td class="hits">47</td><td class="source">  for(var i = 0; i &lt; 16; i++) {</td></tr><tr class="hit"> <td class="line">155</td><td class="hits">752</td><td class="source">    ipad[i] = bkey[i] ^ 0x36363636;</td></tr><tr class="hit"> <td class="line">156</td><td class="hits">752</td><td class="source">    opad[i] = bkey[i] ^ 0x5C5C5C5C;</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">159</td><td class="hits">47</td><td class="source">  var hash = core_sha1(ipad.concat(str2binb(data)), 512 + data.length * chrsz);</td></tr><tr class="hit"> <td class="line">160</td><td class="hits">47</td><td class="source">  return core_sha1(opad.concat(hash), 512 + 160);</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source"> * Add integers, wrapping at 2^32. This uses 16-bit operations internally</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> * to work around bugs in some JS interpreters.</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">167</td><td class="hits">1</td><td class="source">function safe_add(x, y) {</td></tr><tr class="hit"> <td class="line">168</td><td class="hits">174850</td><td class="source">  var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);</td></tr><tr class="hit"> <td class="line">169</td><td class="hits">174850</td><td class="source">  var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);</td></tr><tr class="hit"> <td class="line">170</td><td class="hits">174850</td><td class="source">  return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> * Bitwise rotate a 32-bit number to the left.</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">176</td><td class="hits">1</td><td class="source">function rol(num, cnt) {</td></tr><tr class="hit"> <td class="line">177</td><td class="hits">120512</td><td class="source">  return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source"> * Convert an 8-bit or 16-bit string to an array of big-endian words</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source"> * In 8-bit function, characters &gt;255 have their hi-byte silently ignored.</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">184</td><td class="hits">1</td><td class="source">function str2binb(str) {</td></tr><tr class="hit"> <td class="line">185</td><td class="hits">94</td><td class="source">  var bin = Array();</td></tr><tr class="hit"> <td class="line">186</td><td class="hits">94</td><td class="source">  var mask = (1 &lt;&lt; chrsz) - 1;</td></tr><tr class="hit"> <td class="line">187</td><td class="hits">94</td><td class="source">  for(var i = 0; i &lt; str.length * chrsz; i += chrsz)</td></tr><tr class="hit"> <td class="line">188</td><td class="hits">21403</td><td class="source">    bin[i&gt;&gt;5] |= (str.charCodeAt(i / chrsz) &amp; mask) &lt;&lt; (32 - chrsz - i%32);</td></tr><tr class="hit"> <td class="line">189</td><td class="hits">94</td><td class="source">  return bin;</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">191</td><td class="hits">1</td><td class="source">exports.str2binb = str2binb;</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source"> * Convert an array of big-endian words to a string</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">196</td><td class="hits">1</td><td class="source">function binb2str(bin) {</td></tr><tr class="miss"> <td class="line">197</td><td class="hits">0</td><td class="source">  var str = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">198</td><td class="hits">0</td><td class="source">  var mask = (1 &lt;&lt; chrsz) - 1;</td></tr><tr class="miss"> <td class="line">199</td><td class="hits">0</td><td class="source">  for(var i = 0; i &lt; bin.length * 32; i += chrsz)</td></tr><tr class="miss"> <td class="line">200</td><td class="hits">0</td><td class="source">    str += String.fromCharCode((bin[i&gt;&gt;5] &gt;&gt;&gt; (32 - chrsz - i%32)) &amp; mask);</td></tr><tr class="miss"> <td class="line">201</td><td class="hits">0</td><td class="source">  return str;</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">203</td><td class="hits">1</td><td class="source">exports.binb2str = binb2str;</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source"> * Convert an array of big-endian words to a hex string.</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">208</td><td class="hits">1</td><td class="source">function binb2hex(binarray) {</td></tr><tr class="miss"> <td class="line">209</td><td class="hits">0</td><td class="source">  var hex_tab = hexcase ? &quot;0123456789ABCDEF&quot; : &quot;0123456789abcdef&quot;;</td></tr><tr class="miss"> <td class="line">210</td><td class="hits">0</td><td class="source">  var str = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">211</td><td class="hits">0</td><td class="source">  for(var i = 0; i &lt; binarray.length * 4; i++) {</td></tr><tr class="miss"> <td class="line">212</td><td class="hits">0</td><td class="source">    str += hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((3 - i%4)*8+4)) &amp; 0xF) +</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">     hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((3 - i%4)*8  )) &amp; 0xF);</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">215</td><td class="hits">0</td><td class="source">  return str;</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">217</td><td class="hits">1</td><td class="source">exports.binb2hex = binb2hex;</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source"> * Convert an array of big-endian words to a base-64 string</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">222</td><td class="hits">1</td><td class="source">function binb2b64(binarray) {</td></tr><tr class="hit"> <td class="line">223</td><td class="hits">47</td><td class="source">  var tab = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</td></tr><tr class="hit"> <td class="line">224</td><td class="hits">47</td><td class="source">  var str = &quot;&quot;;</td></tr><tr class="hit"> <td class="line">225</td><td class="hits">47</td><td class="source">  for(var i = 0; i &lt; binarray.length * 4; i += 3) {</td></tr><tr class="hit"> <td class="line">226</td><td class="hits">329</td><td class="source">    var triplet = (((binarray[i   &gt;&gt; 2] &gt;&gt; 8 * (3 -  i   %4)) &amp; 0xFF) &lt;&lt; 16)</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">                | (((binarray[i+1 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i+1)%4)) &amp; 0xFF) &lt;&lt; 8 )</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">                |  ((binarray[i+2 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i+2)%4)) &amp; 0xFF);</td></tr><tr class="hit"> <td class="line">229</td><td class="hits">329</td><td class="source">    for(var j = 0; j &lt; 4; j++)</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">    {</td></tr><tr class="hit"> <td class="line">231</td><td class="hits">1363</td><td class="source">      if(i * 8 + j * 6 &gt; binarray.length * 32) str += b64pad;</td></tr><tr class="hit"> <td class="line">232</td><td class="hits">1269</td><td class="source">      else str += tab.charAt((triplet &gt;&gt; 6*(3-j)) &amp; 0x3F);</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">235</td><td class="hits">47</td><td class="source">  return str;</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"> <td class="line">237</td><td class="hits">1</td><td class="source">exports.binb2b64 = binb2b64;</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">})();</td></tr></tbody></table></div><div class="file"><h2 id="tsina.js">tsina.js</h2><div id="stats" class="low"><div class="percentage">36%</div><div class="sloc">52</div><div class="hits">19</div><div class="misses">33</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/tsina.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var inherits = require('util').inherits;</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var EventProxy = require('eventproxy').EventProxy;</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var fs = require('fs');</td></tr><tr class="hit"> <td class="line">17</td><td class="hits">1</td><td class="source">var path = require('path');</td></tr><tr class="hit"> <td class="line">18</td><td class="hits">1</td><td class="source">var TBase = require('./tbase');</td></tr><tr class="hit"> <td class="line">19</td><td class="hits">1</td><td class="source">var weiboutil = require('./weibo_util');</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">22</td><td class="hits">1</td><td class="source">function TSinaAPI(options) {</td></tr><tr class="miss"> <td class="line">23</td><td class="hits">0</td><td class="source">  TSinaAPI.super_.call(this);</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">25</td><td class="hits">0</td><td class="source">  var config = utils.extend({}, options, {</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    host: 'http://api.t.sina.com.cn'</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  });</td></tr><tr class="miss"> <td class="line">28</td><td class="hits">0</td><td class="source">  this.init(config);</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">31</td><td class="hits">1</td><td class="source">inherits(TSinaAPI, TBase);</td></tr><tr class="hit"> <td class="line">32</td><td class="hits">1</td><td class="source">module.exports = TSinaAPI;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">34</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_authorization_url = function (params) {</td></tr><tr class="miss"> <td class="line">35</td><td class="hits">0</td><td class="source">  params.forcelogin = 'true';</td></tr><tr class="miss"> <td class="line">36</td><td class="hits">0</td><td class="source">  return TSinaAPI.super_.prototype.format_authorization_url.call(this, params);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">39</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.get_result_items = function (data, playload, args) {</td></tr><tr class="miss"> <td class="line">40</td><td class="hits">0</td><td class="source">  return data.results || data.users || data;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">43</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_search_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">44</td><td class="hits">0</td><td class="source">  if (!status.user &amp;&amp; status.from_user) { // search data</td></tr><tr class="miss"> <td class="line">45</td><td class="hits">0</td><td class="source">    status.user = {</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">      screen_name: status.from_user,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">      profile_image_url: status.profile_image_url,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">      id: status.from_user_id</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    };</td></tr><tr class="miss"> <td class="line">50</td><td class="hits">0</td><td class="source">    delete status.profile_image_url;</td></tr><tr class="miss"> <td class="line">51</td><td class="hits">0</td><td class="source">    delete status.from_user;</td></tr><tr class="miss"> <td class="line">52</td><td class="hits">0</td><td class="source">    delete status.from_user_id;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">54</td><td class="hits">0</td><td class="source">  return this.format_status(status, args);</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">57</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">58</td><td class="hits">0</td><td class="source">  if (status.user) {</td></tr><tr class="miss"> <td class="line">59</td><td class="hits">0</td><td class="source">    status.user = this.format_user(status.user, args);</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  </td></tr><tr class="miss"> <td class="line">62</td><td class="hits">0</td><td class="source">  if (status.retweeted_status) {</td></tr><tr class="miss"> <td class="line">63</td><td class="hits">0</td><td class="source">    status.retweeted_status = this.format_status(status.retweeted_status, args);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">65</td><td class="hits">0</td><td class="source">  if (status.user) {</td></tr><tr class="miss"> <td class="line">66</td><td class="hits">0</td><td class="source">    status.t_url = 'http://weibo.com/' + status.user.id + '/' + weiboutil.mid2url(status.mid);</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">68</td><td class="hits">0</td><td class="source">  return status;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">71</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_user = function (user, args) {</td></tr><tr class="miss"> <td class="line">72</td><td class="hits">0</td><td class="source">  user.t_url = 'http://weibo.com/' + (user.domain || user.id);</td></tr><tr class="miss"> <td class="line">73</td><td class="hits">0</td><td class="source">  if (user.status) {</td></tr><tr class="miss"> <td class="line">74</td><td class="hits">0</td><td class="source">    user.status = this.format_status(user.status, args);</td></tr><tr class="miss"> <td class="line">75</td><td class="hits">0</td><td class="source">    if (!user.status.t_url) {</td></tr><tr class="miss"> <td class="line">76</td><td class="hits">0</td><td class="source">      user.status.t_url = 'http://weibo.com/' + user.id + '/' + weiboutil.mid2url(user.status.mid || user.status.id);</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">79</td><td class="hits">0</td><td class="source">  return user;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">82</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_comment = function (comment, args) {</td></tr><tr class="miss"> <td class="line">83</td><td class="hits">0</td><td class="source">  comment.user = this.format_user(comment.user, args);</td></tr><tr class="miss"> <td class="line">84</td><td class="hits">0</td><td class="source">  comment.status = this.format_status(comment.status, args);</td></tr><tr class="miss"> <td class="line">85</td><td class="hits">0</td><td class="source">  return comment;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">88</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_message = function (message, args) {</td></tr><tr class="miss"> <td class="line">89</td><td class="hits">0</td><td class="source">  message.sender = this.format_user(message.sender, args);</td></tr><tr class="miss"> <td class="line">90</td><td class="hits">0</td><td class="source">  message.recipient = this.format_user(message.recipient, args);</td></tr><tr class="miss"> <td class="line">91</td><td class="hits">0</td><td class="source">  return message;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">94</td><td class="hits">1</td><td class="source">TSinaAPI.prototype.format_emotion = function (emotion, args) {</td></tr><tr class="miss"> <td class="line">95</td><td class="hits">0</td><td class="source">  emotion.title = emotion.phrase.substring(1, emotion.phrase.length - 1);</td></tr><tr class="miss"> <td class="line">96</td><td class="hits">0</td><td class="source">  return emotion;</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">        </td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">//   rate_limit_status: function (data, callback, context) {</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">//       url: this.config.rate_limit_status,</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">//       play_load: 'rate',</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">//   // since_id, max_id, count, page </td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">//   friends_timeline: function (data, callback, context) {</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">//       url: this.config.friends_timeline,</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">//   // id, user_id, screen_name, since_id, max_id, count, page </td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">//   user_timeline: function (data, callback, context) {</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">//       url: this.config.user_timeline,</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">//   // id, count, page</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">//   comments_timeline: function (data, callback, context) {</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">//       url: this.config.comments_timeline,</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">//       play_load: 'comment',</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">//   // id, since_id, max_id, count, page</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">//   repost_timeline: function (data, callback, context) {</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">//       url: this.config.repost_timeline,</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">//   // since_id, max_id, count, page </td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">//   mentions: function (data, callback, context){</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">//       url: this.config.mentions,</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">//   // id, user_id, screen_name, cursor, count</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">//   followers: function (data, callback, context) {</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">//       url: this.config.followers,</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">//   public_timeline: function (data, callback, context) {</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">//       url: this.config.public_timeline,</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">//   // id, user_id, screen_name, cursor, count</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">//   friends: function (data, callback, context) {</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">//       url: this.config.friends,</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">//   // page</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">//   favorites: function (data, callback, context) {</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">//       url: this.config.favorites,</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">//   favorites_create: function (data, callback, context) {</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">//       url: this.config.favorites_create,</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">//   favorites_destroy: function (data, callback, context) {</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">//       url: this.config.favorites_destroy,</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">//   // ids</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">//   counts: function (data, callback, context) {</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">//       url: this.config.counts,</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">//       play_load: 'count',</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">//   user_show: function (data, callback, context) {</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">//       url: this.config.user_show,</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">//     // since_id, max_id, count, page </td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source">//   direct_messages: function (data, callback, context) {</td></tr><tr><td class="line">254</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">//       url: this.config.direct_messages,</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">257</td><td class="hits"></td><td class="source">//       play_load: 'message',</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">//   destroy_msg: function (data, callback, context) {</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">//       url: this.config.destroy_msg,</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source">//       play_load: 'message',</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">//   /*data&#231;&#154;&#132;&#229;&#143;&#130;&#230;&#149;&#176;&#229;&#136;&#151;&#232;&#161;&#168;&#239;&#188;&#154;</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">//   content &#229;&#190;&#133;&#229;&#143;&#145;&#233;&#128;&#129;&#230;&#182;&#136;&#230;&#129;&#175;&#231;&#154;&#132;&#230;&#173;&#163;&#230;&#150;&#135;&#239;&#188;&#140;&#232;&#175;&#183;&#231;&#161;&#174;&#229;&#174;&#154;&#229;&#191;&#133;&#232;&#166;&#129;&#230;&#151;&#182;&#233;&#156;&#128;&#232;&#166;&#129;&#232;&#191;&#155;&#232;&#161;&#140;URL&#231;&#188;&#150;&#231;&#160;&#129; ( encode ) &#239;&#188;&#140;&#229;&#143;&#166;&#229;&#164;&#150;&#239;&#188;&#140;&#228;&#184;&#141;&#232;&#182;&#133;&#232;&#191;&#135;140&#232;&#139;&#177;&#230;&#150;&#135;&#230;&#136;&#150;140&#230;&#177;&#137;&#229;&#173;&#151;&#227;&#128;&#130;</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">//   message &#229;&#191;&#133;&#233;&#161;&#187; 0 &#232;&#161;&#168;&#231;&#164;&#186;&#230;&#130;&#132;&#230;&#130;&#132;&#232;&#175;&#157; 1 &#232;&#161;&#168;&#231;&#164;&#186;&#230;&#136;&#179;&#228;&#184;&#128;&#228;&#184;&#139;</td></tr><tr><td class="line">277</td><td class="hits"></td><td class="source">//   receiveUserId &#229;&#191;&#133;&#233;&#161;&#187;&#239;&#188;&#140;&#230;&#142;&#165;&#230;&#148;&#182;&#230;&#150;&#185;&#231;&#154;&#132;&#231;&#148;&#168;&#230;&#136;&#183;id</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">//   source &#229;&#143;&#175;&#233;&#128;&#137;&#239;&#188;&#140;&#230;&#152;&#190;&#231;&#164;&#186;&#229;&#156;&#168;&#231;&#189;&#145;&#231;&#171;&#153;&#228;&#184;&#138;&#231;&#154;&#132;&#230;&#157;&#165;&#232;&#135;&#170;&#229;&#147;&#170;&#233;&#135;&#140;&#229;&#175;&#185;&#229;&#186;&#148;&#231;&#154;&#132;&#230;&#160;&#135;&#232;&#175;&#134;&#231;&#172;&#166;&#227;&#128;&#130;&#229;&#166;&#130;&#230;&#158;&#156;&#230;&#131;&#179;&#230;&#152;&#190;&#231;&#164;&#186;&#230;&#140;&#135;&#229;&#174;&#154;&#231;&#154;&#132;&#229;&#173;&#151;&#231;&#172;&#166;&#239;&#188;&#140;&#232;&#175;&#183;&#228;&#184;&#142;&#229;&#174;&#152;&#230;&#150;&#185;&#228;&#186;&#186;&#229;&#145;&#152;&#232;&#129;&#148;&#231;&#179;&#187;&#227;&#128;&#130;</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">//   */</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">//   new_message: function (data, callback, context) {</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">//       url: this.config.new_message,</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">//       play_load: 'message',</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">//   status_show: function (data, callback, context) {</td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">//       url: this.config.status_show,</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">297</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">299</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">300</td><td class="hits"></td><td class="source">//   // &#230;&#160;&#188;&#229;&#188;&#143;&#228;&#184;&#138;&#228;&#188;&#160;&#229;&#143;&#130;&#230;&#149;&#176;&#239;&#188;&#140;&#230;&#150;&#185;&#228;&#190;&#191;&#229;&#173;&#144;&#231;&#177;&#187;&#232;&#166;&#134;&#231;&#155;&#150;&#229;&#129;&#154;&#231;&#137;&#185;&#230;&#174;&#138;&#229;&#164;&#132;&#231;&#144;&#134;</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">//   // &#229;&#173;&#144;&#231;&#177;&#187;&#229;&#143;&#175;&#228;&#187;&#165;&#229;&#162;&#158;&#229;&#138;&#160;&#232;&#135;&#170;&#229;&#183;&#177;&#231;&#154;&#132;&#229;&#143;&#130;&#230;&#149;&#176;</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source">//   format_upload_params: function (user, data, pic) {</td></tr><tr><td class="line">303</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source">//   repost: function (data, callback, context) {</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source">//       url: this.config.repost,</td></tr><tr><td class="line">311</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">315</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">318</td><td class="hits"></td><td class="source">//   comment: function (data, callback, context) {</td></tr><tr><td class="line">319</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">//       url: this.config.comment,</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">//       play_load: 'comment',</td></tr><tr><td class="line">323</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">//   reply: function (data, callback, context) {</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">//       url: this.config.reply,</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">//       play_load: 'comment',</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">334</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">335</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source">//   comments: function (data, callback, context) {</td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">//       url: this.config.comments,</td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">//       type: 'GET',</td></tr><tr><td class="line">342</td><td class="hits"></td><td class="source">//       play_load: 'comment',</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">347</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">348</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">349</td><td class="hits"></td><td class="source">//   comment_destroy: function (data, callback, context) {</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source">//       url: this.config.comment_destroy,</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">353</td><td class="hits"></td><td class="source">//       play_load: 'comment',</td></tr><tr><td class="line">354</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">355</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">359</td><td class="hits"></td><td class="source">//   friendships_create: function (data, callback, context) {</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">361</td><td class="hits"></td><td class="source">//       url: this.config.friendships_create,</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">367</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">369</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">//   friendships_destroy: function (data, callback, context) {</td></tr><tr><td class="line">371</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">372</td><td class="hits"></td><td class="source">//       url: this.config.friendships_destroy,</td></tr><tr><td class="line">373</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">374</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">375</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">376</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">378</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">379</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">380</td><td class="hits"></td><td class="source">//   friendships_show: function (data, callback, context) {</td></tr><tr><td class="line">381</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source">//       url: this.config.friendships_show,</td></tr><tr><td class="line">383</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">386</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">387</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">389</td><td class="hits"></td><td class="source">//   // type</td></tr><tr><td class="line">390</td><td class="hits"></td><td class="source">//   reset_count: function (data, callback, context) {</td></tr><tr><td class="line">391</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source">//       url: this.config.reset_count,</td></tr><tr><td class="line">393</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">394</td><td class="hits"></td><td class="source">//       play_load: 'result',</td></tr><tr><td class="line">395</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">399</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">400</td><td class="hits"></td><td class="source">//   // user_id, count, page</td></tr><tr><td class="line">401</td><td class="hits"></td><td class="source">//   tags: function (data, callback, context) {</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source">//       url: this.config.tags,</td></tr><tr><td class="line">404</td><td class="hits"></td><td class="source">//       play_load: 'tag',</td></tr><tr><td class="line">405</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">406</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">407</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">408</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">409</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">410</td><td class="hits"></td><td class="source">//   // count, page</td></tr><tr><td class="line">411</td><td class="hits"></td><td class="source">//   tags_suggestions: function (data, callback, context) {</td></tr><tr><td class="line">412</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">413</td><td class="hits"></td><td class="source">//       url: this.config.tags_suggestions,</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source">//       play_load: 'tag',</td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">416</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">417</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">420</td><td class="hits"></td><td class="source">//   // tags</td></tr><tr><td class="line">421</td><td class="hits"></td><td class="source">//   create_tag: function (data, callback, context) {</td></tr><tr><td class="line">422</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source">//       url: this.config.create_tag,</td></tr><tr><td class="line">424</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source">//       play_load: 'tag',</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">428</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">429</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">431</td><td class="hits"></td><td class="source">//   // tag_id</td></tr><tr><td class="line">432</td><td class="hits"></td><td class="source">//   destroy_tag: function (data, callback, context) {</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">434</td><td class="hits"></td><td class="source">//       url: this.config.destroy_tag,</td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source">//       play_load: 'tag',</td></tr><tr><td class="line">437</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">440</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">441</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source">//   // id</td></tr><tr><td class="line">443</td><td class="hits"></td><td class="source">//   destroy: function (data, callback, context) {</td></tr><tr><td class="line">444</td><td class="hits"></td><td class="source">//     if (!data || !data.id) {</td></tr><tr><td class="line">445</td><td class="hits"></td><td class="source">//       return;</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">448</td><td class="hits"></td><td class="source">//       url: this.config.destroy,</td></tr><tr><td class="line">449</td><td class="hits"></td><td class="source">//       type: 'POST',</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">452</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">453</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">456</td><td class="hits"></td><td class="source">//   // q, max_id, count</td></tr><tr><td class="line">457</td><td class="hits"></td><td class="source">//   search: function (data, callback, context) {</td></tr><tr><td class="line">458</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">459</td><td class="hits"></td><td class="source">//       url: this.config.search,</td></tr><tr><td class="line">460</td><td class="hits"></td><td class="source">//       play_load: 'status',</td></tr><tr><td class="line">461</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">462</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">463</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">464</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">465</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">466</td><td class="hits"></td><td class="source">//   // q, page, count</td></tr><tr><td class="line">467</td><td class="hits"></td><td class="source">//   user_search: function (data, callback, context) {</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source">//     var params = {</td></tr><tr><td class="line">469</td><td class="hits"></td><td class="source">//       url: this.config.user_search,</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">//       play_load: 'user',</td></tr><tr><td class="line">471</td><td class="hits"></td><td class="source">//       data: data</td></tr><tr><td class="line">472</td><td class="hits"></td><td class="source">//     };</td></tr><tr><td class="line">473</td><td class="hits"></td><td class="source">//     this._send_request(params, callback, context);</td></tr><tr><td class="line">474</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">475</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">476</td><td class="hits"></td><td class="source">//   /**</td></tr><tr><td class="line">477</td><td class="hits"></td><td class="source">//    * List all emotions.</td></tr><tr><td class="line">478</td><td class="hits"></td><td class="source">//    * </td></tr><tr><td class="line">479</td><td class="hits"></td><td class="source">//    * @param {Object} user</td></tr><tr><td class="line">480</td><td class="hits"></td><td class="source">//    * @param {Function(err, emotions)} callback</td></tr><tr><td class="line">481</td><td class="hits"></td><td class="source">//    *  - {Object} emotions: {</td></tr><tr><td class="line">482</td><td class="hits"></td><td class="source">//    *    '[&#229;&#147;&#136;&#229;&#147;&#136;]': {</td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source">//    *      url: &quot;http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/41/zz2_org.gif&quot;,</td></tr><tr><td class="line">484</td><td class="hits"></td><td class="source">//    *      type: &quot;face&quot;,</td></tr><tr><td class="line">485</td><td class="hits"></td><td class="source">//    *      title: &quot;&#229;&#147;&#136;&#229;&#147;&#136;&quot;,</td></tr><tr><td class="line">486</td><td class="hits"></td><td class="source">//    *    },</td></tr><tr><td class="line">487</td><td class="hits"></td><td class="source">//    *    ...</td></tr><tr><td class="line">488</td><td class="hits"></td><td class="source">//    *  }</td></tr><tr><td class="line">489</td><td class="hits"></td><td class="source">//    * @param {Object} context, callback context</td></tr><tr><td class="line">490</td><td class="hits"></td><td class="source">//    * @return this</td></tr><tr><td class="line">491</td><td class="hits"></td><td class="source">//    */</td></tr><tr><td class="line">492</td><td class="hits"></td><td class="source">//   emotions: function (user, callback, context) {</td></tr><tr><td class="line">493</td><td class="hits"></td><td class="source">//     // http://api.t.sina.com.cn/emotions.json?&amp;source=3538199806&amp;language=cnname</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">//     // http://api.t.sina.com.cn/emotions.json?&amp;source=3538199806&amp;language=twname</td></tr><tr><td class="line">495</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">496</td><td class="hits"></td><td class="source">//     var ep = EventProxy.create();</td></tr><tr><td class="line">497</td><td class="hits"></td><td class="source">//     ep.after('emotions', this.config.emotion_types.length, function (datas) {</td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source">//       var emotions = {};</td></tr><tr><td class="line">499</td><td class="hits"></td><td class="source">//       for (var i = 0, l = datas.length; i &lt; l; i++) {</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source">//         var items = datas[i];</td></tr><tr><td class="line">501</td><td class="hits"></td><td class="source">//         if (!items) {</td></tr><tr><td class="line">502</td><td class="hits"></td><td class="source">//           continue;</td></tr><tr><td class="line">503</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source">//         for (var j = 0, jl = items.length; j &lt; jl; j++) {</td></tr><tr><td class="line">505</td><td class="hits"></td><td class="source">//           var emotion = items[j];</td></tr><tr><td class="line">506</td><td class="hits"></td><td class="source">//           emotions[emotion.phrase] = emotion;</td></tr><tr><td class="line">507</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">508</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">509</td><td class="hits"></td><td class="source">//       callback.call(this, null, emotions);</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">511</td><td class="hits"></td><td class="source">//     ep.once('error', function (err) {</td></tr><tr><td class="line">512</td><td class="hits"></td><td class="source">//       ep.unbind();</td></tr><tr><td class="line">513</td><td class="hits"></td><td class="source">//       callback.call(this, err);</td></tr><tr><td class="line">514</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">515</td><td class="hits"></td><td class="source">//     var that = this;</td></tr><tr><td class="line">516</td><td class="hits"></td><td class="source">//     that.config.emotion_types.forEach(function (args) {</td></tr><tr><td class="line">517</td><td class="hits"></td><td class="source">//       var data = {</td></tr><tr><td class="line">518</td><td class="hits"></td><td class="source">//         user: user</td></tr><tr><td class="line">519</td><td class="hits"></td><td class="source">//       };</td></tr><tr><td class="line">520</td><td class="hits"></td><td class="source">//       for (var k in args) {</td></tr><tr><td class="line">521</td><td class="hits"></td><td class="source">//         data[k] = args[k];</td></tr><tr><td class="line">522</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">523</td><td class="hits"></td><td class="source">//       var params = {</td></tr><tr><td class="line">524</td><td class="hits"></td><td class="source">//         url: that.config.emotions,</td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source">//         play_load: 'emotion',</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source">//         need_source: true,</td></tr><tr><td class="line">527</td><td class="hits"></td><td class="source">//         data: data</td></tr><tr><td class="line">528</td><td class="hits"></td><td class="source">//       };</td></tr><tr><td class="line">529</td><td class="hits"></td><td class="source">//       that._send_request(params, function (err, emotions) {</td></tr><tr><td class="line">530</td><td class="hits"></td><td class="source">//         if (err) {</td></tr><tr><td class="line">531</td><td class="hits"></td><td class="source">//           return ep.emit('error', err);</td></tr><tr><td class="line">532</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">533</td><td class="hits"></td><td class="source">//         ep.emit('emotions', emotions);</td></tr><tr><td class="line">534</td><td class="hits"></td><td class="source">//       });</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">536</td><td class="hits"></td><td class="source">//     return this;</td></tr><tr><td class="line">537</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">538</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source">//   URL_RE: new RegExp('(?:\\[url\\s*=\\s*|)((?:www\\.|http[s]?://)[\\w\\.\\?%&amp;\\-/#=;:!\\+~]+)(?:\\](.+)\\[/url\\]|)', 'ig'),</td></tr><tr><td class="line">542</td><td class="hits"></td><td class="source">//   /**</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source">//    * format status.text to display</td></tr><tr><td class="line">544</td><td class="hits"></td><td class="source">//    */</td></tr><tr><td class="line">545</td><td class="hits"></td><td class="source">//   process_text: function (str_or_status, need_encode) {</td></tr><tr><td class="line">546</td><td class="hits"></td><td class="source">//     var str = str_or_status;</td></tr><tr><td class="line">547</td><td class="hits"></td><td class="source">//     if (need_encode === 'undedfined') {</td></tr><tr><td class="line">548</td><td class="hits"></td><td class="source">//         need_encode = true;</td></tr><tr><td class="line">549</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">550</td><td class="hits"></td><td class="source">//     if (str_or_status.text !== undefined) {</td></tr><tr><td class="line">551</td><td class="hits"></td><td class="source">//         str = str_or_status.text;</td></tr><tr><td class="line">552</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">553</td><td class="hits"></td><td class="source">//     if (str) {</td></tr><tr><td class="line">554</td><td class="hits"></td><td class="source">//       if (need_encode) {</td></tr><tr><td class="line">555</td><td class="hits"></td><td class="source">//         str = utils.htmlencode(str);</td></tr><tr><td class="line">556</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">557</td><td class="hits"></td><td class="source">//       str = str.replace(this.URL_RE, this._replace_url_callback);</td></tr><tr><td class="line">558</td><td class="hits"></td><td class="source">//       str = this.process_at(str, str_or_status); //@***</td></tr><tr><td class="line">559</td><td class="hits"></td><td class="source">//       str = this.process_emotional(str); </td></tr><tr><td class="line">560</td><td class="hits"></td><td class="source">//       str = this.process_search(str); //#xxXX#</td></tr><tr><td class="line">561</td><td class="hits"></td><td class="source">//       // iPhone emoji</td></tr><tr><td class="line">562</td><td class="hits"></td><td class="source">//       str = str.replace( /([\uE001-\uE537])/gi, this._get_iphone_emoji);</td></tr><tr><td class="line">563</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source">//     return str || '&amp;nbsp;';</td></tr><tr><td class="line">565</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">566</td><td class="hits"></td><td class="source">//   _replace_url_callback: function (m, g1, g2) {</td></tr><tr><td class="line">567</td><td class="hits"></td><td class="source">//     var _url = g1;</td></tr><tr><td class="line">568</td><td class="hits"></td><td class="source">//     if (g1.indexOf('http') !== 0) {</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source">//       _url = 'http://' + g1;</td></tr><tr><td class="line">570</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">571</td><td class="hits"></td><td class="source">//     return '&lt;a target=&quot;_blank&quot; class=&quot;link&quot; href=&quot;{{url}}&quot;&gt;{{value}}&lt;/a&gt;'.format({</td></tr><tr><td class="line">572</td><td class="hits"></td><td class="source">//       url: _url, title: g1, value: g2||g1</td></tr><tr><td class="line">573</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">574</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">575</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">576</td><td class="hits"></td><td class="source">//   _get_iphone_emoji: function (str) {</td></tr><tr><td class="line">577</td><td class="hits"></td><td class="source">//     return &quot;&lt;span class=\&quot;iphoneEmoji &quot;+ str.charCodeAt(0).toString(16).toUpperCase()+&quot;\&quot;&gt;&lt;/span&gt;&quot;;</td></tr><tr><td class="line">578</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">579</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">580</td><td class="hits"></td><td class="source">//   SEARCH_MATCH_RE: /#([^#]+)#/g,</td></tr><tr><td class="line">581</td><td class="hits"></td><td class="source">//   SEARCH_TPL: '&lt;a target=&quot;_blank&quot; href=&quot;{{search_url}}{{search}}&quot; title=&quot;Search #{{search}}&quot;&gt;#{{search}}#&lt;/a&gt;',</td></tr><tr><td class="line">582</td><td class="hits"></td><td class="source">  </td></tr><tr><td class="line">583</td><td class="hits"></td><td class="source">//   process_search: function (str) {</td></tr><tr><td class="line">584</td><td class="hits"></td><td class="source">//     var that = this;</td></tr><tr><td class="line">585</td><td class="hits"></td><td class="source">//     return str.replace(this.SEARCH_MATCH_RE, function (m, g1) {</td></tr><tr><td class="line">586</td><td class="hits"></td><td class="source">//       return that._process_search_callback(m, g1);</td></tr><tr><td class="line">587</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">588</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">589</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">590</td><td class="hits"></td><td class="source">//   _process_search_callback: function (m, g1) {</td></tr><tr><td class="line">591</td><td class="hits"></td><td class="source">//     // &#228;&#191;&#174;&#229;&#164;&#141;#xxx@xxx#&#229;&#181;&#140;&#229;&#165;&#151;&#233;&#151;&#174;&#233;&#162;&#152;</td></tr><tr><td class="line">592</td><td class="hits"></td><td class="source">//     // var search = g1.remove_html_tag();</td></tr><tr><td class="line">593</td><td class="hits"></td><td class="source">//     return this.SEARCH_TPL.format({ search: g1, search_url: this.config.search_url });</td></tr><tr><td class="line">594</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">595</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">596</td><td class="hits"></td><td class="source">//   format_search_text: function (str) { // &#230;&#160;&#188;&#229;&#188;&#143;&#229;&#140;&#150;&#228;&#184;&#187;&#233;&#162;&#152;</td></tr><tr><td class="line">597</td><td class="hits"></td><td class="source">//     return '#' + str.trim() + '#';</td></tr><tr><td class="line">598</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">599</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">600</td><td class="hits"></td><td class="source">//   AT_RE: /@([\w\-\_\u2E80-\u3000\u303F-\u9FFF]+)/g,</td></tr><tr><td class="line">601</td><td class="hits"></td><td class="source">//   process_at: function (str) { </td></tr><tr><td class="line">602</td><td class="hits"></td><td class="source">//     //@*** u4e00-\u9fa5:&#228;&#184;&#173;&#230;&#150;&#135;&#229;&#173;&#151;&#231;&#172;&#166; \u2E80-\u9FFF:&#228;&#184;&#173;&#230;&#151;&#165;&#233;&#159;&#169;&#229;&#173;&#151;&#231;&#172;&#166;</td></tr><tr><td class="line">603</td><td class="hits"></td><td class="source">//     //&#227;&#128;&#144;&#232;&#167;&#130;&#231;&#130;&#185;&#194;&#183;@&#228;&#187;&#187;&#229;&#191;&#151;&#229;&#188;&#186;&#227;&#128;&#145;&#228;&#187;&#138;&#229;&#185;&#180;&#230;&#143;&#144;&#229;&#135;&#186;&#231;&#154;&#132;1000&#228;&#184;&#135;&#229;&#165;&#151;&#231;&#154;&#132;&#228;&#191;&#157;&#233;&#154;&#156;&#230;&#136;&#191;&#228;&#187;&#187;&#229;&#138;&#161;&#229;&#143;&#175;&#232;&#131;&#189;&#230;&#160;&#185;&#230;&#156;&#172;&#229;&#174;&#140;&#228;&#184;&#141;&#230;&#136;&#144;</td></tr><tr><td class="line">604</td><td class="hits"></td><td class="source">//     // http://blog.oasisfeng.com/2006/10/19/full-cjk-unicode-range/</td></tr><tr><td class="line">605</td><td class="hits"></td><td class="source">//     // CJK&#230;&#160;&#135;&#231;&#130;&#185;&#231;&#172;&#166;&#229;&#143;&#183;&#239;&#188;&#154;3000-303F</td></tr><tr><td class="line">606</td><td class="hits"></td><td class="source">//     var tpl = '&lt;a class=&quot;at_user&quot; data-name=&quot;$1&quot; href=&quot;javascript:;&quot; rhref=&quot;' + </td></tr><tr><td class="line">607</td><td class="hits"></td><td class="source">//       this.config.user_home_url + '$1&quot; title=&quot;show users&quot;&gt;@$1&lt;/a&gt;';</td></tr><tr><td class="line">608</td><td class="hits"></td><td class="source">//     return str.replace(this.AT_RE, tpl);</td></tr><tr><td class="line">609</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">610</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">611</td><td class="hits"></td><td class="source">//   process_emotional: function (str) {</td></tr><tr><td class="line">612</td><td class="hits"></td><td class="source">//     var that = this;</td></tr><tr><td class="line">613</td><td class="hits"></td><td class="source">//     return str.replace(/\[([\u4e00-\u9fff,\uff1f,\w]{1,4})\]/g, function (m, g1) {</td></tr><tr><td class="line">614</td><td class="hits"></td><td class="source">//       return that._replace_emotional_callback(m, g1);</td></tr><tr><td class="line">615</td><td class="hits"></td><td class="source">//     });</td></tr><tr><td class="line">616</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">617</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">618</td><td class="hits"></td><td class="source">//   EMOTIONAL_TPL: '&lt;img title=&quot;{{title}}&quot; src=&quot;{{src}}&quot; /&gt;',</td></tr><tr><td class="line">619</td><td class="hits"></td><td class="source">//   _replace_emotional_callback: function (m, g1) {</td></tr><tr><td class="line">620</td><td class="hits"></td><td class="source">//     if (g1) {</td></tr><tr><td class="line">621</td><td class="hits"></td><td class="source">//       var face = this.EMOTIONS[g1];</td></tr><tr><td class="line">622</td><td class="hits"></td><td class="source">//       if (face) {</td></tr><tr><td class="line">623</td><td class="hits"></td><td class="source">//         return this.EMOTIONAL_TPL.format({ title: m, src: FACE_URL_PRE + face });</td></tr><tr><td class="line">624</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">625</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">626</td><td class="hits"></td><td class="source">//     return m;</td></tr><tr><td class="line">627</td><td class="hits"></td><td class="source">//   },</td></tr><tr><td class="line">628</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">629</td><td class="hits"></td><td class="source">// };</td></tr><tr><td class="line">630</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">631</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">632</td><td class="hits"></td><td class="source">// //&#230;&#150;&#176;&#230;&#181;&#170;&#229;&#190;&#174;&#229;&#141;&#154;&#232;&#161;&#168;&#230;&#131;&#133;&#232;&#189;&#172;&#229;&#140;&#150;</td></tr><tr><td class="line">633</td><td class="hits"></td><td class="source">// var FACE_URL_PRE = TSinaAPI.FACE_URL_PRE = 'http://timg.sjs.sinajs.cn/t3/style/images/common/face/ext/normal/';</td></tr><tr><td class="line">634</td><td class="hits"></td><td class="source">// var FACE_TPL = TSinaAPI.FACE_TPL = '[{{name}}]';</td></tr><tr><td class="line">635</td><td class="hits"></td><td class="source">// var FACES = TSinaAPI.FACES = {</td></tr><tr><td class="line">636</td><td class="hits"></td><td class="source">//   &quot;&#229;&#145;&#181;&#229;&#145;&#181;&quot;: &quot;eb/smile.gif&quot;,</td></tr><tr><td class="line">637</td><td class="hits"></td><td class="source">//   &quot;&#229;&#152;&#187;&#229;&#152;&#187;&quot;: &quot;c2/tooth.gif&quot;,</td></tr><tr><td class="line">638</td><td class="hits"></td><td class="source">//   &quot;&#229;&#147;&#136;&#229;&#147;&#136;&quot;: &quot;6a/laugh.gif&quot;,</td></tr><tr><td class="line">639</td><td class="hits"></td><td class="source">//   &quot;&#231;&#136;&#177;&#228;&#189;&#160;&quot;: &quot;7e/love.gif&quot;,</td></tr><tr><td class="line">640</td><td class="hits"></td><td class="source">//   &quot;&#230;&#153;&#149;&quot;: &quot;a4/dizzy.gif&quot;,</td></tr><tr><td class="line">641</td><td class="hits"></td><td class="source">//   &quot;&#230;&#179;&#170;&quot;: &quot;d8/sad.gif&quot;,</td></tr><tr><td class="line">642</td><td class="hits"></td><td class="source">//   &quot;&#233;&#166;&#139;&#229;&#152;&#180;&quot;: &quot;b8/cz_thumb.gif&quot;,</td></tr><tr><td class="line">643</td><td class="hits"></td><td class="source">//   &quot;&#230;&#138;&#147;&#231;&#139;&#130;&quot;: &quot;4d/crazy.gif&quot;,</td></tr><tr><td class="line">644</td><td class="hits"></td><td class="source">//   &quot;&#229;&#147;&#188;&quot;: &quot;19/hate.gif&quot;,</td></tr><tr><td class="line">645</td><td class="hits"></td><td class="source">//   &quot;&#229;&#143;&#175;&#231;&#136;&#177;&quot;: &quot;9c/tz_thumb.gif&quot;,</td></tr><tr><td class="line">646</td><td class="hits"></td><td class="source">//   &quot;&#230;&#128;&#146;&quot;: &quot;57/angry.gif&quot;,</td></tr><tr><td class="line">647</td><td class="hits"></td><td class="source">//   &quot;&#230;&#177;&#151;&quot;: &quot;13/sweat.gif&quot;,</td></tr><tr><td class="line">648</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#176;&quot;: &quot;8b/sleepy.gif&quot;,</td></tr><tr><td class="line">649</td><td class="hits"></td><td class="source">//   &quot;&#229;&#174;&#179;&#231;&#190;&#158;&quot;: &quot;05/shame_thumb.gif&quot;,</td></tr><tr><td class="line">650</td><td class="hits"></td><td class="source">//   &quot;&#231;&#157;&#161;&#232;&#167;&#137;&quot;: &quot;7d/sleep_thumb.gif&quot;,</td></tr><tr><td class="line">651</td><td class="hits"></td><td class="source">//   &quot;&#233;&#146;&#177;&quot;: &quot;90/money_thumb.gif&quot;,</td></tr><tr><td class="line">652</td><td class="hits"></td><td class="source">//   &quot;&#229;&#129;&#183;&#231;&#172;&#145;&quot;: &quot;7e/hei_thumb.gif&quot;,</td></tr><tr><td class="line">653</td><td class="hits"></td><td class="source">//   &quot;&#233;&#133;&#183;&quot;: &quot;40/cool_thumb.gif&quot;,</td></tr><tr><td class="line">654</td><td class="hits"></td><td class="source">//   &quot;&#232;&#161;&#176;&quot;: &quot;af/cry.gif&quot;,</td></tr><tr><td class="line">655</td><td class="hits"></td><td class="source">//   &quot;&#229;&#144;&#131;&#230;&#131;&#138;&quot;: &quot;f4/cj_thumb.gif&quot;,</td></tr><tr><td class="line">656</td><td class="hits"></td><td class="source">//   &quot;&#233;&#151;&#173;&#229;&#152;&#180;&quot;: &quot;29/bz_thumb.gif&quot;,</td></tr><tr><td class="line">657</td><td class="hits"></td><td class="source">//   &quot;&#233;&#132;&#153;&#232;&#167;&#134;&quot;: &quot;71/bs2_thumb.gif&quot;,</td></tr><tr><td class="line">658</td><td class="hits"></td><td class="source">//   &quot;&#230;&#140;&#150;&#233;&#188;&#187;&#229;&#177;&#142;&quot;: &quot;b6/kbs_thumb.gif&quot;,</td></tr><tr><td class="line">659</td><td class="hits"></td><td class="source">//   &quot;&#232;&#138;&#177;&#229;&#191;&#131;&quot;: &quot;64/hs_thumb.gif&quot;,</td></tr><tr><td class="line">660</td><td class="hits"></td><td class="source">//   &quot;&#233;&#188;&#147;&#230;&#142;&#140;&quot;: &quot;1b/gz_thumb.gif&quot;,</td></tr><tr><td class="line">661</td><td class="hits"></td><td class="source">//   &quot;&#229;&#164;&#177;&#230;&#156;&#155;&quot;: &quot;0c/sw_thumb.gif&quot;,</td></tr><tr><td class="line">662</td><td class="hits"></td><td class="source">//   &quot;&#230;&#128;&#157;&#232;&#128;&#131;&quot;: &quot;e9/sk_thumb.gif&quot;,</td></tr><tr><td class="line">663</td><td class="hits"></td><td class="source">//   &quot;&#231;&#148;&#159;&#231;&#151;&#133;&quot;: &quot;b6/sb_thumb.gif&quot;,</td></tr><tr><td class="line">664</td><td class="hits"></td><td class="source">//   &quot;&#228;&#186;&#178;&#228;&#186;&#178;&quot;: &quot;8f/qq_thumb.gif&quot;,</td></tr><tr><td class="line">665</td><td class="hits"></td><td class="source">//   &quot;&#230;&#128;&#146;&#233;&#170;&#130;&quot;: &quot;89/nm_thumb.gif&quot;,</td></tr><tr><td class="line">666</td><td class="hits"></td><td class="source">//   &quot;&#229;&#164;&#170;&#229;&#188;&#128;&#229;&#191;&#131;&quot;: &quot;58/mb_thumb.gif&quot;,</td></tr><tr><td class="line">667</td><td class="hits"></td><td class="source">//   &quot;&#230;&#135;&#146;&#229;&#190;&#151;&#231;&#144;&#134;&#228;&#189;&#160;&quot;: &quot;17/ldln_thumb.gif&quot;,</td></tr><tr><td class="line">668</td><td class="hits"></td><td class="source">//   &quot;&#229;&#143;&#179;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;98/yhh_thumb.gif&quot;,</td></tr><tr><td class="line">669</td><td class="hits"></td><td class="source">//   &quot;&#229;&#183;&#166;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;6d/zhh_thumb.gif&quot;,</td></tr><tr><td class="line">670</td><td class="hits"></td><td class="source">//   &quot;&#229;&#152;&#152;&quot;: &quot;a6/x_thumb.gif&quot;,</td></tr><tr><td class="line">671</td><td class="hits"></td><td class="source">//   &quot;&#229;&#167;&#148;&#229;&#177;&#136;&quot;: &quot;73/wq_thumb.gif&quot;,</td></tr><tr><td class="line">672</td><td class="hits"></td><td class="source">//   &quot;&#229;&#144;&#144;&quot;: &quot;9e/t_thumb.gif&quot;,</td></tr><tr><td class="line">673</td><td class="hits"></td><td class="source">//   &quot;&#229;&#143;&#175;&#230;&#128;&#156;&quot;: &quot;af/kl_thumb.gif&quot;,</td></tr><tr><td class="line">674</td><td class="hits"></td><td class="source">//   &quot;&#230;&#137;&#147;&#229;&#147;&#136;&#230;&#176;&#148;&quot;: &quot;f3/k_thumb.gif&quot;,</td></tr><tr><td class="line">675</td><td class="hits"></td><td class="source">//   &quot;&#229;&#129;&#154;&#233;&#172;&#188;&#232;&#132;&#184;&quot;: &quot;88/zgl_thumb.gif&quot;,</td></tr><tr><td class="line">676</td><td class="hits"></td><td class="source">//   &quot;&#230;&#143;&#161;&#230;&#137;&#139;&quot;: &quot;0c/ws_thumb.gif&quot;,</td></tr><tr><td class="line">677</td><td class="hits"></td><td class="source">//   &quot;&#232;&#128;&#182;&quot;: &quot;d9/ye_thumb.gif&quot;,</td></tr><tr><td class="line">678</td><td class="hits"></td><td class="source">//   &quot;good&quot;: &quot;d8/good_thumb.gif&quot;,</td></tr><tr><td class="line">679</td><td class="hits"></td><td class="source">//   &quot;&#229;&#188;&#177;&quot;: &quot;d8/sad_thumb.gif&quot;,</td></tr><tr><td class="line">680</td><td class="hits"></td><td class="source">//   &quot;&#228;&#184;&#141;&#232;&#166;&#129;&quot;: &quot;c7/no_thumb.gif&quot;,</td></tr><tr><td class="line">681</td><td class="hits"></td><td class="source">//   &quot;ok&quot;: &quot;d6/ok_thumb.gif&quot;,</td></tr><tr><td class="line">682</td><td class="hits"></td><td class="source">//   &quot;&#232;&#181;&#158;&quot;: &quot;d0/z2_thumb.gif&quot;,</td></tr><tr><td class="line">683</td><td class="hits"></td><td class="source">//   &quot;&#230;&#157;&#165;&quot;: &quot;40/come_thumb.gif&quot;,</td></tr><tr><td class="line">684</td><td class="hits"></td><td class="source">//   &quot;&#232;&#155;&#139;&#231;&#179;&#149;&quot;: &quot;6a/cake.gif&quot;,</td></tr><tr><td class="line">685</td><td class="hits"></td><td class="source">//   &quot;&#229;&#191;&#131;&quot;: &quot;6d/heart.gif&quot;,</td></tr><tr><td class="line">686</td><td class="hits"></td><td class="source">//   &quot;&#228;&#188;&#164;&#229;&#191;&#131;&quot;: &quot;ea/unheart.gif&quot;,</td></tr><tr><td class="line">687</td><td class="hits"></td><td class="source">//   &quot;&#233;&#146;&#159;&quot;: &quot;d3/clock_thumb.gif&quot;,</td></tr><tr><td class="line">688</td><td class="hits"></td><td class="source">//   &quot;&#231;&#140;&#170;&#229;&#164;&#180;&quot;: &quot;58/pig.gif&quot;,</td></tr><tr><td class="line">689</td><td class="hits"></td><td class="source">//   &quot;&#229;&#146;&#150;&#229;&#149;&#161;&quot;: &quot;64/cafe_thumb.gif&quot;,</td></tr><tr><td class="line">690</td><td class="hits"></td><td class="source">//   &quot;&#232;&#175;&#157;&#231;&#173;&#146;&quot;: &quot;1b/m_thumb.gif&quot;,</td></tr><tr><td class="line">691</td><td class="hits"></td><td class="source">//   &quot;&#229;&#185;&#178;&#230;&#157;&#175;&quot;: &quot;bd/cheer.gif&quot;,</td></tr><tr><td class="line">692</td><td class="hits"></td><td class="source">//   &quot;&#231;&#187;&#191;&#228;&#184;&#157;&#229;&#184;&#166;&quot;: &quot;b8/green.gif&quot;,</td></tr><tr><td class="line">693</td><td class="hits"></td><td class="source">//   &quot;&#232;&#156;&#161;&#231;&#131;&#155;&quot;: &quot;cc/candle.gif&quot;,</td></tr><tr><td class="line">694</td><td class="hits"></td><td class="source">//   &quot;&#229;&#190;&#174;&#233;&#163;&#142;&quot;: &quot;a5/wind_thumb.gif&quot;,</td></tr><tr><td class="line">695</td><td class="hits"></td><td class="source">//   &quot;&#230;&#156;&#136;&#228;&#186;&#174;&quot;: &quot;b9/moon.gif&quot;,</td></tr><tr><td class="line">696</td><td class="hits"></td><td class="source">//   &quot;&#230;&#156;&#136;&#233;&#165;&#188;&quot;: &quot;96/mooncake3_thumb.gif&quot;,</td></tr><tr><td class="line">697</td><td class="hits"></td><td class="source">//   &quot;&#230;&#187;&#161;&#230;&#156;&#136;&quot;: &quot;5d/moon1_thumb.gif&quot;,</td></tr><tr><td class="line">698</td><td class="hits"></td><td class="source">//   &quot;&#233;&#133;&#146;&#229;&#163;&#182;&quot;: &quot;64/wine_thumb.gif&quot;,</td></tr><tr><td class="line">699</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#162;&quot;: &quot;11/tuan_thumb.gif&quot;,</td></tr><tr><td class="line">700</td><td class="hits"></td><td class="source">//   &quot;&#229;&#156;&#134;&quot;: &quot;53/yuan_thumb.gif&quot;,</td></tr><tr><td class="line">701</td><td class="hits"></td><td class="source">//   &quot;&#229;&#183;&#166;&#230;&#138;&#177;&#230;&#138;&#177;&quot;: &quot;54/left_thumb.gif&quot;,</td></tr><tr><td class="line">702</td><td class="hits"></td><td class="source">//   &quot;&#229;&#143;&#179;&#230;&#138;&#177;&#230;&#138;&#177;&quot;: &quot;0d/right_thumb.gif&quot;,</td></tr><tr><td class="line">703</td><td class="hits"></td><td class="source">//   &quot;&#228;&#185;&#144;&#228;&#185;&#144;&quot;: &quot;66/guanbuzhao_thumb.gif&quot;,</td></tr><tr><td class="line">704</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#162;&#229;&#156;&#134;&#230;&#156;&#136;&#233;&#165;&#188;&quot;: &quot;e6/tuanyuan_thumb.gif&quot;,</td></tr><tr><td class="line">705</td><td class="hits"></td><td class="source">//   &quot;&#229;&#191;&#171;&#229;&#191;&#171;&quot;: &quot;49/lbq1_thumb.gif&quot;,</td></tr><tr><td class="line">706</td><td class="hits"></td><td class="source">//   &quot;&#231;&#187;&#135;&quot;: &quot;41/zz2_thumb.gif&quot;,</td></tr><tr><td class="line">707</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#180;&#232;&#167;&#130;&quot;: &quot;f2/wg_thumb.gif&quot;,</td></tr><tr><td class="line">708</td><td class="hits"></td><td class="source">//   &quot;&#229;&#168;&#129;&#230;&#173;&#166;&quot;: &quot;70/vw_thumb.gif&quot;,</td></tr><tr><td class="line">709</td><td class="hits"></td><td class="source">//   &quot;&#231;&#136;&#177;&#229;&#191;&#131;&#228;&#184;&#147;&#233;&#128;&#146;&quot;: &quot;c9/axcd_thumb.gif&quot;,</td></tr><tr><td class="line">710</td><td class="hits"></td><td class="source">//   &quot;&#229;&#165;&#165;&#231;&#137;&#185;&#230;&#155;&#188;&quot;: &quot;bc/otm_thumb.gif&quot;,</td></tr><tr><td class="line">711</td><td class="hits"></td><td class="source">//   //&#228;&#186;&#154;&#232;&#191;&#144;</td></tr><tr><td class="line">712</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#189;&#230;&#151;&#151;&quot;: &quot;dc/flag_thumb.gif&quot;,</td></tr><tr><td class="line">713</td><td class="hits"></td><td class="source">//   &quot;&#233;&#135;&#145;&#231;&#137;&#140;&quot;: &quot;f4/jinpai_thumb.gif&quot;,</td></tr><tr><td class="line">714</td><td class="hits"></td><td class="source">//   &quot;&#233;&#147;&#182;&#231;&#137;&#140;&quot;: &quot;1e/yinpai_thumb.gif&quot;,</td></tr><tr><td class="line">715</td><td class="hits"></td><td class="source">//   &quot;&#233;&#147;&#156;&#231;&#137;&#140;&quot;: &quot;26/tongpai_thumb.gif&quot;,</td></tr><tr><td class="line">716</td><td class="hits"></td><td class="source">//   &quot;&#229;&#155;&#180;&#232;&#132;&#150;&quot;: &quot;3f/weijin_thumb.gif&quot;,</td></tr><tr><td class="line">717</td><td class="hits"></td><td class="source">//   &quot;&#230;&#184;&#169;&#230;&#154;&#150;&#229;&#184;&#189;&#229;&#173;&#144;&quot;: &quot;f1/wennuanmaozi_thumb.gif&quot;,</td></tr><tr><td class="line">718</td><td class="hits"></td><td class="source">//   &quot;&#230;&#137;&#139;&#229;&#165;&#151;&quot;: &quot;72/shoutao_thumb.gif&quot;,</td></tr><tr><td class="line">719</td><td class="hits"></td><td class="source">//   &quot;&#232;&#144;&#189;&#229;&#143;&#182;&quot;: &quot;79/yellowMood_thumb.gif&quot;,</td></tr><tr><td class="line">720</td><td class="hits"></td><td class="source">//   &quot;&#231;&#133;&#167;&#231;&#155;&#184;&#230;&#156;&#186;&quot;: &quot;33/camera_thumb.gif&quot;,</td></tr><tr><td class="line">721</td><td class="hits"></td><td class="source">//   &quot;&#231;&#153;&#189;&#228;&#186;&#145;&quot;: &quot;ff/y3_thumb.gif&quot;,</td></tr><tr><td class="line">722</td><td class="hits"></td><td class="source">//   &quot;&#231;&#164;&#188;&#231;&#137;&#169;&quot;: &quot;c4/liwu_thumb.gif&quot;,</td></tr><tr><td class="line">723</td><td class="hits"></td><td class="source">//   &quot;v5&quot;: &quot;c5/v5_org.gif&quot;,</td></tr><tr><td class="line">724</td><td class="hits"></td><td class="source">//   &quot;&#228;&#185;&#166;&#229;&#145;&#134;&#229;&#173;&#144;&quot;: &quot;61/sdz_org.gif&quot;</td></tr><tr><td class="line">725</td><td class="hits"></td><td class="source">// };</td></tr><tr><td class="line">726</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">727</td><td class="hits"></td><td class="source">// // http://api.t.sina.com.cn/emotions.json</td></tr><tr><td class="line">728</td><td class="hits"></td><td class="source">// TSinaAPI.EMOTIONS = {</td></tr><tr><td class="line">729</td><td class="hits"></td><td class="source">//   &quot;&#229;&#145;&#181;&#229;&#145;&#181;&quot;: &quot;eb/smile.gif&quot;, &quot;&#229;&#152;&#187;&#229;&#152;&#187;&quot;: &quot;c2/tooth.gif&quot;, &quot;&#229;&#147;&#136;&#229;&#147;&#136;&quot;: &quot;6a/laugh.gif&quot;, &quot;&#231;&#136;&#177;&#228;&#189;&#160;&quot;: &quot;7e/love.gif&quot;, &quot;&#230;&#153;&#149;&quot;: &quot;a4/dizzy.gif&quot;, &quot;&#230;&#179;&#170;&quot;: &quot;d8/sad.gif&quot;, &quot;&#233;&#166;&#139;&#229;&#152;&#180;&quot;: &quot;b8/cz_org.gif&quot;, &quot;&#230;&#138;&#147;&#231;&#139;&#130;&quot;: &quot;4d/crazy.gif&quot;, &quot;&#229;&#147;&#188;&quot;: &quot;19/hate.gif&quot;, &quot;&#229;&#143;&#175;&#231;&#136;&#177;&quot;: &quot;9c/tz_org.gif&quot;, &quot;&#230;&#128;&#146;&quot;: &quot;57/angry.gif&quot;, &quot;&#230;&#177;&#151;&quot;: &quot;13/sweat.gif&quot;, &quot;&#229;&#155;&#176;&quot;: &quot;8b/sleepy.gif&quot;, &quot;&#229;&#174;&#179;&#231;&#190;&#158;&quot;: &quot;05/shame_org.gif&quot;, &quot;&#231;&#157;&#161;&#232;&#167;&#137;&quot;: &quot;7d/sleep_org.gif&quot;, &quot;&#233;&#146;&#177;&quot;: &quot;90/money_org.gif&quot;, &quot;&#229;&#129;&#183;&#231;&#172;&#145;&quot;: &quot;7e/hei_org.gif&quot;, &quot;&#233;&#133;&#183;&quot;: &quot;40/cool_org.gif&quot;, &quot;&#232;&#161;&#176;&quot;: &quot;af/cry.gif&quot;, &quot;&#229;&#144;&#131;&#230;&#131;&#138;&quot;: &quot;f4/cj_org.gif&quot;, &quot;&#233;&#151;&#173;&#229;&#152;&#180;&quot;: &quot;29/bz_org.gif&quot;, &quot;&#233;&#132;&#153;&#232;&#167;&#134;&quot;: &quot;71/bs2_org.gif&quot;, &quot;&#230;&#140;&#150;&#233;&#188;&#187;&#229;&#177;&#142;&quot;: &quot;b6/kbs_org.gif&quot;, &quot;&#232;&#138;&#177;&#229;&#191;&#131;&quot;: &quot;64/hs_org.gif&quot;, &quot;&#233;&#188;&#147;&#230;&#142;&#140;&quot;: &quot;1b/gz_org.gif&quot;, &quot;&#229;&#164;&#177;&#230;&#156;&#155;&quot;: &quot;0c/sw_org.gif&quot;, &quot;&#230;&#128;&#157;&#232;&#128;&#131;&quot;: &quot;e9/sk_org.gif&quot;, &quot;&#231;&#148;&#159;&#231;&#151;&#133;&quot;: &quot;b6/sb_org.gif&quot;, &quot;&#228;&#186;&#178;&#228;&#186;&#178;&quot;: &quot;8f/qq_org.gif&quot;, &quot;&#230;&#128;&#146;&#233;&#170;&#130;&quot;: &quot;89/nm_org.gif&quot;, &quot;&#229;&#164;&#170;&#229;&#188;&#128;&#229;&#191;&#131;&quot;: &quot;58/mb_org.gif&quot;, &quot;&#230;&#135;&#146;&#229;&#190;&#151;&#231;&#144;&#134;&#228;&#189;&#160;&quot;: &quot;17/ldln_org.gif&quot;, &quot;&#229;&#143;&#179;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;98/yhh_org.gif&quot;, &quot;&#229;&#183;&#166;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;6d/zhh_org.gif&quot;, &quot;&#229;&#152;&#152;&quot;: &quot;a6/x_org.gif&quot;, &quot;&#229;&#167;&#148;&#229;&#177;&#136;&quot;: &quot;73/wq_org.gif&quot;, &quot;&#229;&#144;&#144;&quot;: &quot;9e/t_org.gif&quot;, &quot;&#229;&#143;&#175;&#230;&#128;&#156;&quot;: &quot;af/kl_org.gif&quot;, &quot;&#230;&#137;&#147;&#229;&#147;&#136;&#230;&#176;&#148;&quot;: &quot;f3/k_org.gif&quot;, &quot;&#233;&#161;&#182;&quot;: &quot;91/d_org.gif&quot;, &quot;&#231;&#150;&#145;&#233;&#151;&#174;&quot;: &quot;5c/yw_org.gif&quot;, &quot;&#229;&#129;&#154;&#233;&#172;&#188;&#232;&#132;&#184;&quot;: &quot;88/zgl_org.gif&quot;, &quot;&#230;&#143;&#161;&#230;&#137;&#139;&quot;: &quot;0c/ws_org.gif&quot;, &quot;&#232;&#128;&#182;&quot;: &quot;d9/ye_org.gif&quot;, &quot;good&quot;: &quot;d8/good_org.gif&quot;, &quot;&#229;&#188;&#177;&quot;: &quot;d8/sad_org.gif&quot;, &quot;&#228;&#184;&#141;&#232;&#166;&#129;&quot;: &quot;c7/no_org.gif&quot;, &quot;ok&quot;: &quot;d6/ok_org.gif&quot;, &quot;&#232;&#181;&#158;&quot;: &quot;d0/z2_org.gif&quot;, &quot;&#230;&#157;&#165;&quot;: &quot;40/come_org.gif&quot;, &quot;&#232;&#155;&#139;&#231;&#179;&#149;&quot;: &quot;6a/cake.gif&quot;, &quot;&#229;&#191;&#131;&quot;: &quot;6d/heart.gif&quot;, &quot;&#228;&#188;&#164;&#229;&#191;&#131;&quot;: &quot;ea/unheart.gif&quot;, &quot;&#233;&#146;&#159;&quot;: &quot;d3/clock_org.gif&quot;, &quot;&#231;&#140;&#170;&#229;&#164;&#180;&quot;: &quot;58/pig.gif&quot;, &quot;&#229;&#146;&#150;&#229;&#149;&#161;&quot;: &quot;64/cafe_org.gif&quot;, &quot;&#232;&#175;&#157;&#231;&#173;&#146;&quot;: &quot;1b/m_org.gif&quot;, &quot;&#230;&#156;&#136;&#228;&#186;&#174;&quot;: &quot;b9/moon.gif&quot;, &quot;&#229;&#164;&#170;&#233;&#152;&#179;&quot;: &quot;e5/sun.gif&quot;, &quot;&#229;&#185;&#178;&#230;&#157;&#175;&quot;: &quot;bd/cheer.gif&quot;, &quot;&#229;&#190;&#174;&#233;&#163;&#142;&quot;: &quot;a5/wind_org.gif&quot;, &quot;&#233;&#163;&#158;&#230;&#156;&#186;&quot;: &quot;6d/travel_org.gif&quot;, &quot;&#229;&#133;&#148;&#229;&#173;&#144;&quot;: &quot;81/rabbit_org.gif&quot;, &quot;&#231;&#134;&#138;&#231;&#140;&#171;&quot;: &quot;6e/panda_org.gif&quot;, &quot;&#231;&#187;&#153;&#229;&#138;&#155;&quot;: &quot;c9/geili_org.gif&quot;, &quot;&#231;&#165;&#158;&#233;&#169;&#172;&quot;: &quot;60/horse2_org.gif&quot;, &quot;&#230;&#181;&#174;&#228;&#186;&#145;&quot;: &quot;bc/fuyun_org.gif&quot;, &quot;&#231;&#187;&#135;&quot;: &quot;41/zz2_org.gif&quot;, &quot;&#229;&#155;&#180;&#232;&#167;&#130;&quot;: &quot;f2/wg_org.gif&quot;, &quot;&#229;&#168;&#129;&#230;&#173;&#166;&quot;: &quot;70/vw_org.gif&quot;, &quot;&#229;&#165;&#165;&#231;&#137;&#185;&#230;&#155;&#188;&quot;: &quot;bc/otm_org.gif&quot;, &quot;&#229;&#174;&#158;&#228;&#185;&#160;&quot;: &quot;48/sx_org.gif&quot;, &quot;&#232;&#135;&#170;&#232;&#161;&#140;&#232;&#189;&#166;&quot;: &quot;46/zxc_org.gif&quot;, &quot;&#231;&#133;&#167;&#231;&#155;&#184;&#230;&#156;&#186;&quot;: &quot;33/camera_org.gif&quot;, &quot;&#229;&#143;&#182;&#229;&#173;&#144;&quot;: &quot;b8/green_org.gif&quot;, &quot;&#230;&#152;&#165;&#230;&#154;&#150;&#232;&#138;&#177;&#229;&#188;&#128;&quot;: &quot;ca/chunnuanhuakai_org.gif&quot;, &quot;&#229;&#146;&#134;&#229;&#147;&#174;&quot;: &quot;4b/paoxiao_org.gif&quot;, &quot;&#229;&#189;&#169;&#232;&#153;&#185;&quot;: &quot;03/ch_org.gif&quot;, &quot;&#230;&#178;&#153;&#229;&#176;&#152;&#230;&#154;&#180;&quot;: &quot;69/sc_org.gif&quot;, &quot;&#229;&#156;&#176;&#231;&#144;&#131;&#228;&#184;&#128;&#229;&#176;&#143;&#230;&#151;&#182;&quot;: &quot;4f/diqiuxiuxiyixiaoshi_org.gif&quot;, &quot;&#231;&#136;&#177;&#229;&#191;&#131;&#228;&#188;&#160;&#233;&#128;&#146;&quot;: &quot;c9/axcd_org.gif&quot;, &quot;&#232;&#156;&#161;&#231;&#131;&#155;&quot;: &quot;cc/candle.gif&quot;, &quot;&#231;&#187;&#191;&#228;&#184;&#157;&#229;&#184;&#166;&quot;: &quot;b8/green.gif&quot;, &quot;&#230;&#140;&#164;&#231;&#156;&#188;&quot;: &quot;c3/zy_org.gif&quot;, &quot;&#228;&#186;&#178;&#228;&#186;&#178;&quot;: &quot;8f/qq_org.gif&quot;, &quot;&#230;&#128;&#146;&#233;&#170;&#130;&quot;: &quot;89/nm_org.gif&quot;, &quot;&#229;&#164;&#170;&#229;&#188;&#128;&#229;&#191;&#131;&quot;: &quot;58/mb_org.gif&quot;, &quot;&#230;&#135;&#146;&#229;&#190;&#151;&#231;&#144;&#134;&#228;&#189;&#160;&quot;: &quot;17/ldln_org.gif&quot;, &quot;&#230;&#137;&#147;&#229;&#147;&#136;&#230;&#176;&#148;&quot;: &quot;f3/k_org.gif&quot;, &quot;&#231;&#148;&#159;&#231;&#151;&#133;&quot;: &quot;b6/sb_org.gif&quot;, &quot;&#228;&#185;&#166;&#229;&#145;&#134;&#229;&#173;&#144;&quot;: &quot;61/sdz_org.gif&quot;, &quot;&#229;&#164;&#177;&#230;&#156;&#155;&quot;: &quot;0c/sw_org.gif&quot;, &quot;&#229;&#143;&#175;&#230;&#128;&#156;&quot;: &quot;af/kl_org.gif&quot;, &quot;&#230;&#140;&#150;&#233;&#188;&#187;&#229;&#177;&#142;&quot;: &quot;b6/kbs_org.gif&quot;, &quot;&#233;&#187;&#145;&#231;&#186;&#191;&quot;: &quot;91/h_org.gif&quot;, &quot;&#232;&#138;&#177;&#229;&#191;&#131;&quot;: &quot;64/hs_org.gif&quot;, &quot;&#229;&#143;&#175;&#231;&#136;&#177;&quot;: &quot;9c/tz_org.gif&quot;, &quot;&#229;&#144;&#144;&quot;: &quot;9e/t_org.gif&quot;, &quot;&#229;&#167;&#148;&#229;&#177;&#136;&quot;: &quot;73/wq_org.gif&quot;, &quot;&#230;&#128;&#157;&#232;&#128;&#131;&quot;: &quot;e9/sk_org.gif&quot;, &quot;&#229;&#147;&#136;&#229;&#147;&#136;&quot;: &quot;6a/laugh.gif&quot;, &quot;&#229;&#152;&#152;&quot;: &quot;a6/x_org.gif&quot;, &quot;&#229;&#143;&#179;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;98/yhh_org.gif&quot;, &quot;&#229;&#183;&#166;&#229;&#147;&#188;&#229;&#147;&#188;&quot;: &quot;6d/zhh_org.gif&quot;, &quot;&#231;&#150;&#145;&#233;&#151;&#174;&quot;: &quot;5c/yw_org.gif&quot;, &quot;&#233;&#152;&#180;&#233;&#153;&#169;&quot;: &quot;6d/yx_org.gif&quot;, &quot;&#229;&#129;&#154;&#233;&#172;&#188;&#232;&#132;&#184;&quot;: &quot;88/zgl_org.gif&quot;, &quot;&#231;&#136;&#177;&#228;&#189;&#160;&quot;: &quot;7e/love.gif&quot;, &quot;&#233;&#166;&#139;&#229;&#152;&#180;&quot;: &quot;b8/cz_org.gif&quot;, &quot;&#233;&#161;&#182;&quot;: &quot;91/d_org.gif&quot;, &quot;&#233;&#146;&#177;&quot;: &quot;90/money_org.gif&quot;, &quot;&#229;&#152;&#187;&#229;&#152;&#187;&quot;: &quot;c2/tooth.gif&quot;, &quot;&#230;&#177;&#151;&quot;: &quot;13/sweat.gif&quot;, &quot;&#229;&#145;&#181;&#229;&#145;&#181;&quot;: &quot;eb/smile.gif&quot;, &quot;&#231;&#157;&#161;&#232;&#167;&#137;&quot;: &quot;7d/sleep_org.gif&quot;, &quot;&#229;&#155;&#176;&quot;: &quot;8b/sleepy.gif&quot;, &quot;&#229;&#174;&#179;&#231;&#190;&#158;&quot;: &quot;05/shame_org.gif&quot;, &quot;&#230;&#130;&#178;&#228;&#188;&#164;&quot;: &quot;1a/bs_org.gif&quot;, &quot;&#233;&#132;&#153;&#232;&#167;&#134;&quot;: &quot;71/bs2_org.gif&quot;, &quot;&#230;&#138;&#177;&#230;&#138;&#177;&quot;: &quot;7c/bb_org.gif&quot;, &quot;&#230;&#139;&#156;&#230;&#139;&#156;&quot;: &quot;70/88_org.gif&quot;, &quot;&#230;&#128;&#146;&quot;: &quot;57/angry.gif&quot;, &quot;&#229;&#144;&#131;&#230;&#131;&#138;&quot;: &quot;f4/cj_org.gif&quot;, &quot;&#233;&#151;&#173;&#229;&#152;&#180;&quot;: &quot;29/bz_org.gif&quot;, &quot;&#230;&#179;&#170;&quot;: &quot;d8/sad.gif&quot;, &quot;&#229;&#129;&#183;&#231;&#172;&#145;&quot;: &quot;7e/hei_org.gif&quot;, &quot;&#229;&#147;&#188;&quot;: &quot;19/hate.gif&quot;, &quot;&#230;&#153;&#149;&quot;: &quot;a4/dizzy.gif&quot;, &quot;&#232;&#161;&#176;&quot;: &quot;af/cry.gif&quot;, &quot;&#230;&#138;&#147;&#231;&#139;&#130;&quot;: &quot;4d/crazy.gif&quot;, &quot;&#230;&#132;&#164;&#230;&#128;&#146;&quot;: &quot;bd/fn_org.gif&quot;, &quot;&#230;&#132;&#159;&#229;&#134;&#146;&quot;: &quot;a0/gm_org.gif&quot;, &quot;&#233;&#188;&#147;&#230;&#142;&#140;&quot;: &quot;1b/gz_org.gif&quot;, &quot;&#233;&#133;&#183;&quot;: &quot;40/cool_org.gif&quot;, &quot;&#230;&#157;&#165;&quot;: &quot;40/come_org.gif&quot;, &quot;good&quot;: &quot;d8/good_org.gif&quot;, &quot;haha&quot;: &quot;13/ha_org.gif&quot;, &quot;&#228;&#184;&#141;&#232;&#166;&#129;&quot;: &quot;c7/no_org.gif&quot;, &quot;ok&quot;: &quot;d6/ok_org.gif&quot;, &quot;&#230;&#139;&#179;&#229;&#164;&#180;&quot;: &quot;cc/o_org.gif&quot;, &quot;&#229;&#188;&#177;&quot;: &quot;d8/sad_org.gif&quot;, &quot;&#230;&#143;&#161;&#230;&#137;&#139;&quot;: &quot;0c/ws_org.gif&quot;, &quot;&#232;&#181;&#158;&quot;: &quot;d0/z2_org.gif&quot;, &quot;&#232;&#128;&#182;&quot;: &quot;d9/ye_org.gif&quot;, &quot;&#230;&#156;&#128;&#229;&#183;&#174;&quot;: &quot;3e/bad_org.gif&quot;, &quot;&#229;&#143;&#179;&#230;&#138;&#177;&#230;&#138;&#177;&quot;: &quot;0d/right_org.gif&quot;, &quot;&#229;&#183;&#166;&#230;&#138;&#177;&#230;&#138;&#177;&quot;: &quot;54/left_org.gif&quot;, &quot;&#231;&#178;&#137;&#231;&#186;&#162;&#228;&#184;&#157;&#229;&#184;&#166;&quot;: &quot;77/pink_org.gif&quot;, &quot;&#231;&#136;&#177;&#229;&#191;&#131;&#228;&#188;&#160;&#233;&#128;&#146;&quot;: &quot;c9/axcd_org.gif&quot;, &quot;&#229;&#191;&#131;&quot;: &quot;6d/heart.gif&quot;, &quot;&#231;&#187;&#191;&#228;&#184;&#157;&#229;&#184;&#166;&quot;: &quot;b8/green.gif&quot;, &quot;&#232;&#156;&#161;&#231;&#131;&#155;&quot;: &quot;cc/candle.gif&quot;, &quot;&#229;&#155;&#180;&#232;&#132;&#150;&quot;: &quot;3f/weijin_org.gif&quot;, &quot;&#230;&#184;&#169;&#230;&#154;&#150;&#229;&#184;&#189;&#229;&#173;&#144;&quot;: &quot;f1/wennuanmaozi_org.gif&quot;, &quot;&#230;&#137;&#139;&#229;&#165;&#151;&quot;: &quot;72/shoutao_org.gif&quot;, &quot;&#231;&#186;&#162;&#229;&#140;&#133;&quot;: &quot;71/hongbao_org.gif&quot;, &quot;&#229;&#150;&#156;&quot;: &quot;bf/xi_org.gif&quot;, &quot;&#231;&#164;&#188;&#231;&#137;&#169;&quot;: &quot;c4/liwu_org.gif&quot;, &quot;&#232;&#155;&#139;&#231;&#179;&#149;&quot;: &quot;6a/cake.gif&quot;, &quot;&#233;&#146;&#187;&#230;&#136;&#146;&quot;: &quot;31/r_org.gif&quot;, &quot;&#233;&#146;&#187;&#231;&#159;&#179;&quot;: &quot;9f/diamond_org.gif&quot;, &quot;&#229;&#164;&#167;&#229;&#183;&#180;&quot;: &quot;9c/dynamicbus_org.gif&quot;, &quot;&#233;&#163;&#158;&#230;&#156;&#186;&quot;: &quot;6d/travel_org.gif&quot;, &quot;&#232;&#135;&#170;&#232;&#161;&#140;&#232;&#189;&#166;&quot;: &quot;46/zxc_org.gif&quot;, &quot;&#230;&#177;&#189;&#232;&#189;&#166;&quot;: &quot;a4/jc_org.gif&quot;, &quot;&#230;&#137;&#139;&#230;&#156;&#186;&quot;: &quot;4b/sj2_org.gif&quot;, &quot;&#231;&#133;&#167;&#231;&#155;&#184;&#230;&#156;&#186;&quot;: &quot;33/camera_org.gif&quot;, &quot;&#232;&#141;&#175;&quot;: &quot;5d/y_org.gif&quot;, &quot;&#231;&#148;&#181;&#232;&#132;&#145;&quot;: &quot;df/dn_org.gif&quot;, &quot;&#230;&#137;&#139;&#231;&#186;&#184;&quot;: &quot;55/sz_org.gif&quot;, &quot;&#232;&#144;&#189;&#229;&#143;&#182;&quot;: &quot;79/yellowMood_org.gif&quot;, &quot;&#229;&#156;&#163;&#232;&#175;&#158;&#230;&#160;&#145;&quot;: &quot;a2/christree_org.gif&quot;, &quot;&#229;&#156;&#163;&#232;&#175;&#158;&#229;&#184;&#189;&quot;: &quot;06/chrishat_org.gif&quot;, &quot;&#229;&#156;&#163;&#232;&#175;&#158;&#232;&#128;&#129;&#228;&#186;&#186;&quot;: &quot;c5/chrisfather_org.gif&quot;, &quot;&#229;&#156;&#163;&#232;&#175;&#158;&#233;&#147;&#131;&#233;&#147;&#155;&quot;: &quot;64/chrisbell_org.gif&quot;, &quot;&#229;&#156;&#163;&#232;&#175;&#158;&#232;&#162;&#156;&quot;: &quot;08/chrisocks_org.gif&quot;, &quot;&#229;&#155;&#190;&#231;&#137;&#135;&quot;: &quot;ce/tupianimage_org.gif&quot;, &quot;&#229;&#133;&#173;&#232;&#138;&#146;&#230;&#152;&#159;&quot;: &quot;c2/liumangxing_org.gif&quot;, &quot;&#229;&#156;&#176;&#231;&#144;&#131;&#228;&#184;&#128;&#229;&#176;&#143;&#230;&#151;&#182;&quot;: &quot;4f/diqiuxiuxiyixiaoshi_org.gif&quot;, &quot;&#230;&#164;&#141;&#230;&#160;&#145;&#232;&#138;&#130;&quot;: &quot;56/zhishujie_org.gif&quot;, &quot;&#231;&#178;&#137;&#232;&#155;&#139;&#231;&#179;&#149;&quot;: &quot;bf/nycake_org.gif&quot;, &quot;&#231;&#179;&#150;&#230;&#158;&#156;&quot;: &quot;34/candy_org.gif&quot;, &quot;&#228;&#184;&#135;&#229;&#156;&#163;&#232;&#138;&#130;&quot;: &quot;73/nanguatou2_org.gif&quot;, &quot;&#231;&#129;&#171;&#231;&#130;&#172;&quot;: &quot;3b/hj_org.gif&quot;, &quot;&#233;&#133;&#146;&#229;&#163;&#182;&quot;: &quot;64/wine_org.gif&quot;, &quot;&#230;&#156;&#136;&#233;&#165;&#188;&quot;: &quot;96/mooncake3_org.gif&quot;, &quot;&#230;&#187;&#161;&#230;&#156;&#136;&quot;: &quot;5d/moon1_org.gif&quot;, &quot;&#229;&#183;&#167;&#229;&#133;&#139;&#229;&#138;&#155;&quot;: &quot;b1/qkl_org.gif&quot;, &quot;&#232;&#132;&#154;&#229;&#141;&#176;&quot;: &quot;12/jy_org.gif&quot;, &quot;&#233;&#133;&#146;&quot;: &quot;39/j2_org.gif&quot;, &quot;&#231;&#139;&#151;&quot;: &quot;5d/g_org.gif&quot;, &quot;&#229;&#183;&#165;&#228;&#189;&#156;&quot;: &quot;b2/gz3_org.gif&quot;, &quot;&#230;&#161;&#163;&#230;&#161;&#136;&quot;: &quot;ce/gz2_org.gif&quot;, &quot;&#229;&#143;&#182;&#229;&#173;&#144;&quot;: &quot;b8/green_org.gif&quot;, &quot;&#233;&#146;&#162;&#231;&#144;&#180;&quot;: &quot;b2/gq_org.gif&quot;, &quot;&#229;&#141;&#176;&#232;&#191;&#185;&quot;: &quot;84/foot_org.gif&quot;, &quot;&#233;&#146;&#159;&quot;: &quot;d3/clock_org.gif&quot;, &quot;&#232;&#140;&#182;&quot;: &quot;a8/cha_org.gif&quot;, &quot;&#232;&#165;&#191;&#231;&#147;&#156;&quot;: &quot;6b/watermelon.gif&quot;, &quot;&#233;&#155;&#168;&#228;&#188;&#158;&quot;: &quot;33/umb_org.gif&quot;, &quot;&#231;&#148;&#181;&#232;&#167;&#134;&#230;&#156;&#186;&quot;: &quot;b3/tv_org.gif&quot;, &quot;&#231;&#148;&#181;&#232;&#175;&#157;&quot;: &quot;9d/tel_org.gif&quot;, &quot;&#229;&#164;&#170;&#233;&#152;&#179;&quot;: &quot;e5/sun.gif&quot;, &quot;&#230;&#152;&#159;&quot;: &quot;0b/star_org.gif&quot;, &quot;&#229;&#147;&#168;&#229;&#173;&#144;&quot;: &quot;a0/shao.gif&quot;, &quot;&#232;&#175;&#157;&#231;&#173;&#146;&quot;: &quot;1b/m_org.gif&quot;, &quot;&#233;&#159;&#179;&#228;&#185;&#144;&quot;: &quot;d0/music_org.gif&quot;, &quot;&#231;&#148;&#181;&#229;&#189;&#177;&quot;: &quot;77/movie_org.gif&quot;, &quot;&#230;&#156;&#136;&#228;&#186;&#174;&quot;: &quot;b9/moon.gif&quot;, &quot;&#229;&#148;&#177;&#230;&#173;&#140;&quot;: &quot;79/ktv_org.gif&quot;, &quot;&#229;&#134;&#176;&#230;&#163;&#141;&quot;: &quot;3a/ice.gif&quot;, &quot;&#230;&#136;&#191;&#229;&#173;&#144;&quot;: &quot;d1/house_org.gif&quot;, &quot;&#229;&#184;&#189;&#229;&#173;&#144;&quot;: &quot;25/hat_org.gif&quot;, &quot;&#232;&#182;&#179;&#231;&#144;&#131;&quot;: &quot;c0/football.gif&quot;, &quot;&#233;&#178;&#156;&#232;&#138;&#177;&quot;: &quot;6c/flower_org.gif&quot;, &quot;&#232;&#138;&#177;&quot;: &quot;6c/flower.gif&quot;, &quot;&#233;&#163;&#142;&#230;&#137;&#135;&quot;: &quot;92/fan.gif&quot;, &quot;&#229;&#185;&#178;&#230;&#157;&#175;&quot;: &quot;bd/cheer.gif&quot;, &quot;&#229;&#146;&#150;&#229;&#149;&#161;&quot;: &quot;64/cafe_org.gif&quot;, &quot;&#229;&#133;&#148;&#229;&#173;&#144;&quot;: &quot;81/rabbit_org.gif&quot;, &quot;&#231;&#165;&#158;&#233;&#169;&#172;&quot;: &quot;60/horse2_org.gif&quot;, &quot;&#230;&#181;&#174;&#228;&#186;&#145;&quot;: &quot;bc/fuyun_org.gif&quot;, &quot;&#231;&#187;&#153;&#229;&#138;&#155;&quot;: &quot;c9/geili_org.gif&quot;, &quot;&#232;&#144;&#140;&quot;: &quot;42/kawayi_org.gif&quot;, &quot;&#233;&#184;&#173;&#230;&#162;&#168;&quot;: &quot;bb/pear_org.gif&quot;, &quot;&#231;&#134;&#138;&#231;&#140;&#171;&quot;: &quot;6e/panda_org.gif&quot;, &quot;&#228;&#186;&#146;&#231;&#178;&#137;&quot;: &quot;89/hufen_org.gif&quot;, &quot;&#231;&#187;&#135;&quot;: &quot;41/zz2_org.gif&quot;, &quot;&#229;&#155;&#180;&#232;&#167;&#130;&quot;: &quot;f2/wg_org.gif&quot;, &quot;&#230;&#137;&#148;&#233;&#184;&#161;&#232;&#155;&#139;&quot;: &quot;91/rjd_org.gif&quot;, &quot;&#229;&#165;&#165;&#231;&#137;&#185;&#230;&#155;&#188;&quot;: &quot;bc/otm_org.gif&quot;, &quot;&#229;&#168;&#129;&#230;&#173;&#166;&quot;: &quot;70/vw_org.gif&quot;, &quot;&#228;&#188;&#164;&#229;&#191;&#131;&quot;: &quot;ea/unheart.gif&quot;, &quot;&#231;&#131;&#173;&#229;&#144;&#187;&quot;: &quot;60/rw_org.gif&quot;, &quot;&#229;&#155;&#167;&quot;: &quot;15/j_org.gif&quot;, &quot;orz&quot;: &quot;c0/orz1_org.gif&quot;, &quot;&#229;&#174;&#133;&quot;: &quot;d7/z_org.gif&quot;, &quot;&#229;&#176;&#143;&#228;&#184;&#145;&quot;: &quot;6b/xc_org.gif&quot;, &quot;&#229;&#184;&#133;&quot;: &quot;36/s2_org.gif&quot;, &quot;&#231;&#140;&#170;&#229;&#164;&#180;&quot;: &quot;58/pig.gif&quot;, &quot;&#229;&#174;&#158;&#228;&#185;&#160;&quot;: &quot;48/sx_org.gif&quot;, &quot;&#233;&#170;&#183;&#233;&#171;&#133;&quot;: &quot;bd/kl2_org.gif&quot;, &quot;&#228;&#190;&#191;&#228;&#190;&#191;&quot;: &quot;34/s_org.gif&quot;, &quot;&#233;&#155;&#170;&#228;&#186;&#186;&quot;: &quot;d9/xx2_org.gif&quot;, &quot;&#233;&#187;&#132;&#231;&#137;&#140;&quot;: &quot;a0/yellowcard.gif&quot;, &quot;&#231;&#186;&#162;&#231;&#137;&#140;&quot;: &quot;64/redcard.gif&quot;, &quot;&#232;&#183;&#179;&#232;&#136;&#158;&#232;&#138;&#177;&quot;: &quot;70/twh_org.gif&quot;, &quot;&#231;&#164;&#188;&#232;&#138;&#177;&quot;: &quot;3d/bingo_org.gif&quot;, &quot;&#230;&#137;&#147;&#233;&#146;&#136;&quot;: &quot;b0/zt_org.gif&quot;, &quot;&#229;&#143;&#185;&#229;&#143;&#183;&quot;: &quot;3b/th_org.gif&quot;, &quot;&#233;&#151;&#174;&#229;&#143;&#183;&quot;: &quot;9d/wh_org.gif&quot;, &quot;&#229;&#143;&#165;&#229;&#143;&#183;&quot;: &quot;9b/jh_org.gif&quot;, &quot;&#233;&#128;&#151;&#229;&#143;&#183;&quot;: &quot;cc/dh_org.gif&quot;, &quot;1&quot;: &quot;9b/1_org.gif&quot;, &quot;2&quot;: &quot;2c/2_org.gif&quot;, &quot;3&quot;: &quot;f3/3_org.gif&quot;, &quot;4&quot;: &quot;2c/4_org.gif&quot;, &quot;5&quot;: &quot;d5/5_org.gif&quot;, &quot;6&quot;: &quot;dc/6_org.gif&quot;, &quot;7&quot;: &quot;43/7_org.gif&quot;, &quot;8&quot;: &quot;6d/8_org.gif&quot;, &quot;9&quot;: &quot;26/9_org.gif&quot;, &quot;0&quot;: &quot;d8/ling_org.gif&quot;, &quot;&#233;&#151;&#170;&quot;: &quot;ce/03_org.gif&quot;, &quot;&#229;&#149;&#166;&#229;&#149;&#166;&quot;: &quot;c1/04_org.gif&quot;, &quot;&#229;&#144;&#188;&#229;&#144;&#188;&quot;: &quot;34/05_org.gif&quot;, &quot;&#229;&#186;&#134;&#231;&#165;&#157;&quot;: &quot;67/06_org.gif&quot;, &quot;&#229;&#152;&#191;&quot;: &quot;d3/01_org.gif&quot;, &quot;&#231;&#156;&#129;&#231;&#149;&#165;&#229;&#143;&#183;&quot;: &quot;0d/shengluehao_org.gif&quot;, &quot;kiss&quot;: &quot;59/kiss2_org.gif&quot;, &quot;&#229;&#156;&#134;&quot;: &quot;53/yuan_org.gif&quot;, &quot;&#229;&#155;&#162;&quot;: &quot;11/tuan_org.gif&quot;, &quot;&#229;&#155;&#162;&#229;&#156;&#134;&#230;&#156;&#136;&#233;&#165;&#188;&quot;: &quot;e6/tuanyuan_org.gif&quot;, &quot;&#230;&#172;&#162;&#230;&#172;&#162;&quot;: &quot;c3/liaobuqi_org.gif&quot;, &quot;&#228;&#185;&#144;&#228;&#185;&#144;&quot;: &quot;66/guanbuzhao_org.gif&quot;, &quot;&#231;&#174;&#161;&#228;&#184;&#141;&#231;&#157;&#128;&#231;&#136;&#177;&quot;: &quot;78/2guanbuzhao1_org.gif&quot;, &quot;&#231;&#136;&#177;&quot;: &quot;09/ai_org.gif&quot;, &quot;&#228;&#186;&#134;&#228;&#184;&#141;&#232;&#181;&#183;&#231;&#136;&#177;&quot;: &quot;11/2liaobuqiai_org.gif&quot;, &quot;&#230;&#156;&#137;&#231;&#130;&#185;&#229;&#155;&#176;&quot;: &quot;68/youdiankun_org.gif&quot;, &quot;yes&quot;: &quot;9e/yes_org.gif&quot;, &quot;&#229;&#146;&#189;&#229;&#155;&#158;&#229;&#142;&#187;&#228;&#186;&#134;&quot;: &quot;72/yanhuiqule_org.gif&quot;, &quot;&#233;&#184;&#173;&#230;&#162;&#168;&#229;&#190;&#136;&#229;&#164;&#167;&quot;: &quot;01/yalihenda_org.gif&quot;, &quot;&#231;&#190;&#158;&#231;&#190;&#158;&quot;: &quot;42/xiuxiu_org.gif&quot;, &quot;&#229;&#150;&#156;&#230;&#172;&#162;&#228;&#189;&#160;&quot;: &quot;6b/xihuang_org.gif&quot;, &quot;&#229;&#176;&#143;&#228;&#190;&#191;&#229;&#177;&#129;&quot;: &quot;a0/xiaobianpi_org.gif&quot;, &quot;&#230;&#151;&#160;&#229;&#165;&#136;&quot;: &quot;d6/wunai22_org.gif&quot;, &quot;&#229;&#133;&#148;&#229;&#133;&#148;&quot;: &quot;da/tutu_org.gif&quot;, &quot;&#229;&#144;&#144;&#232;&#136;&#140;&#229;&#164;&#180;&quot;: &quot;98/tushetou_org.gif&quot;, &quot;&#229;&#164;&#180;&#230;&#153;&#149;&quot;: &quot;48/touyun_org.gif&quot;, &quot;&#229;&#144;&#172;&#233;&#159;&#179;&#228;&#185;&#144;&quot;: &quot;d3/tingyinyue_org.gif&quot;, &quot;&#231;&#157;&#161;&#229;&#164;&#167;&#232;&#167;&#137;&quot;: &quot;65/shuijiao_org.gif&quot;, &quot;&#233;&#151;&#170;&#233;&#151;&#170;&#231;&#180;&#171;&quot;: &quot;9e/shanshanzi_org.gif&quot;, &quot;&#233;&#151;&#170;&#233;&#151;&#170;&#231;&#187;&#191;&quot;: &quot;a8/shanshanlu_org.gif&quot;, &quot;&#233;&#151;&#170;&#233;&#151;&#170;&#231;&#129;&#176;&quot;: &quot;1e/shanshanhui_org.gif&quot;, &quot;&#233;&#151;&#170;&#233;&#151;&#170;&#231;&#186;&#162;&quot;: &quot;10/shanshanhong_org.gif&quot;, &quot;&#233;&#151;&#170;&#233;&#151;&#170;&#231;&#178;&#137;&quot;: &quot;9d/shanshanfen_org.gif&quot;, &quot;&#229;&#146;&#134;&#229;&#147;&#174;&quot;: &quot;4b/paoxiao_org.gif&quot;, &quot;&#230;&#145;&#184;&#229;&#164;&#180;&quot;: &quot;2c/motou_org.gif&quot;, &quot;&#231;&#156;&#159;&#231;&#190;&#142;&#229;&#165;&#189;&quot;: &quot;d2/meihao_org.gif&quot;, &quot;&#232;&#132;&#184;&#231;&#186;&#162;&#232;&#135;&#170;&#231;&#136;&#134;&quot;: &quot;d8/lianhongzibao_org.gif&quot;, &quot;&#229;&#147;&#173;&#230;&#179;&#163;&#229;&#165;&#179;&quot;: &quot;1c/kuqinv_org.gif&quot;, &quot;&#229;&#147;&#173;&#230;&#179;&#163;&#231;&#148;&#183;&quot;: &quot;38/kuqinan_org.gif&quot;, &quot;&#231;&#169;&#186;&quot;: &quot;fd/kong_org.gif&quot;, &quot;&#229;&#176;&#189;&#230;&#131;&#133;&#231;&#142;&#169;&quot;: &quot;9f/jinqingwan_org.gif&quot;, &quot;&#230;&#131;&#138;&#229;&#150;&#156;&quot;: &quot;b8/jingxi_org.gif&quot;, &quot;&#230;&#131;&#138;&#229;&#145;&#134;&quot;: &quot;58/jingdai_org.gif&quot;, &quot;&#232;&#131;&#161;&#232;&#144;&#157;&#229;&#141;&#156;&quot;: &quot;e1/huluobo_org.gif&quot;, &quot;&#230;&#172;&#162;&#232;&#133;&#190;&#229;&#142;&#187;&#231;&#136;&#177;&quot;: &quot;63/huangtengquai_org.gif&quot;, &quot;&#230;&#132;&#159;&#229;&#134;&#146;&#228;&#186;&#134;&quot;: &quot;67/ganmao_org.gif&quot;, &quot;&#230;&#128;&#146;&#228;&#186;&#134;&quot;: &quot;ef/fennu_org.gif&quot;, &quot;&#230;&#136;&#145;&#232;&#166;&#129;&#229;&#165;&#139;&#230;&#150;&#151;&quot;: &quot;a6/fendou123_org.gif&quot;, &quot;&#229;&#143;&#145;&#232;&#138;&#189;&quot;: &quot;95/faya_org.gif&quot;, &quot;&#230;&#152;&#165;&#230;&#154;&#150;&#232;&#138;&#177;&#229;&#188;&#128;&quot;: &quot;ca/chunnuanhuakai_org.gif&quot;, &quot;&#230;&#138;&#189;&#231;&#131;&#159;&quot;: &quot;83/chouyan_org.gif&quot;, &quot;&#230;&#152;&#130;&quot;: &quot;31/ang_org.gif&quot;, &quot;&#229;&#149;&#138;&quot;: &quot;12/aa_org.gif&quot;, &quot;&#232;&#135;&#170;&#230;&#143;&#146;&#229;&#143;&#140;&#231;&#155;&#174;&quot;: &quot;d3/zichashuangmu_org.gif&quot;, &quot;&#229;&#146;&#166;&quot;: &quot;9f/yiwen_org.gif&quot;, &quot;&#229;&#152;&#152;&#229;&#152;&#152;&quot;: &quot;cf/xu_org.gif&quot;, &quot;&#230;&#136;&#145;&#229;&#144;&#131;&quot;: &quot;00/wochiwode_org.gif&quot;, &quot;&#229;&#150;&#181;&#229;&#145;&#156;&quot;: &quot;a7/weiqu_org.gif&quot;, &quot;v5&quot;: &quot;c5/v5_org.gif&quot;, &quot;&#232;&#176;&#131;&#230;&#136;&#143;&quot;: &quot;f7/tiaoxi_org.gif&quot;, &quot;&#230;&#137;&#147;&#231;&#137;&#153;&quot;: &quot;d7/taihaoxiaole_org.gif&quot;, &quot;&#230;&#137;&#139;&#232;&#180;&#177;&quot;: &quot;b8/shoujian_org.gif&quot;, &quot;&#232;&#137;&#178;&quot;: &quot;a1/se_org.gif&quot;, &quot;&#229;&#150;&#183;&quot;: &quot;4a/pen_org.gif&quot;, &quot;&#228;&#189;&#160;&#230;&#135;&#130;&#231;&#154;&#132;&quot;: &quot;2e/nidongde_org.gif&quot;, &quot;&#229;&#150;&#181;&quot;: &quot;a0/miaomiao_org.gif&quot;, &quot;&#231;&#190;&#142;&#229;&#145;&#179;&quot;: &quot;c1/meiwei_org.gif&quot;, &quot;&#230;&#131;&#138;&#230;&#129;&#144;&quot;: &quot;46/jingkong_org.gif&quot;, &quot;&#230;&#132;&#159;&#229;&#138;&#168;&quot;: &quot;7c/gandong_org.gif&quot;, &quot;&#230;&#148;&#190;&#229;&#188;&#128;&quot;: &quot;55/fangkai_org.gif&quot;, &quot;&#231;&#151;&#180;&#229;&#145;&#134;&quot;: &quot;e8/chidai_org.gif&quot;, &quot;&#230;&#137;&#175;&#232;&#132;&#184;&quot;: &quot;99/chelian_org.gif&quot;, &quot;&#228;&#184;&#141;&#231;&#159;&#165;&#230;&#137;&#128;&#230;&#142;&#170;&quot;: &quot;ab/buzhisuocuo_org.gif&quot;, &quot;&#231;&#153;&#189;&#231;&#156;&#188;&quot;: &quot;24/baiyan_org.gif&quot;, &quot;&#231;&#140;&#165;&#231;&#144;&#144;&quot;: &quot;e1/weisuo_org.gif&quot;, &quot;&#230;&#140;&#145;&#231;&#156;&#137;&quot;: &quot;c9/tiaomei_org.gif&quot;, &quot;&#230;&#140;&#145;&#233;&#128;&#151;&quot;: &quot;3c/tiaodou_org.gif&quot;, &quot;&#228;&#186;&#178;&#232;&#128;&#179;&#230;&#156;&#181;&quot;: &quot;1c/qinerduo_org.gif&quot;, &quot;&#229;&#170;&#154;&#231;&#156;&#188;&quot;: &quot;32/meiyan_org.gif&quot;, &quot;&#229;&#134;&#146;&#228;&#184;&#170;&#230;&#179;&#161;&quot;: &quot;32/maogepao_org.gif&quot;, &quot;&#229;&#155;&#167;&#232;&#128;&#179;&#230;&#156;&#181;&quot;: &quot;f0/jiongerduo_org.gif&quot;, &quot;&#233;&#172;&#188;&#232;&#132;&#184;&quot;: &quot;14/guilian_org.gif&quot;, &quot;&#230;&#148;&#190;&#231;&#148;&#181;&quot;: &quot;fd/fangdian_org.gif&quot;, &quot;&#230;&#130;&#178;&#229;&#137;&#167;&quot;: &quot;ea/beiju_org.gif&quot;, &quot;&#230;&#138;&#154;&#230;&#145;&#184;&quot;: &quot;78/touch_org.gif&quot;, &quot;&#229;&#164;&#167;&#230;&#177;&#151;&quot;: &quot;13/sweat_org.gif&quot;, &quot;&#229;&#164;&#167;&#230;&#131;&#138;&quot;: &quot;74/suprise_org.gif&quot;, &quot;&#230;&#131;&#138;&#229;&#147;&#173;&quot;: &quot;0c/supcry_org.gif&quot;, &quot;&#230;&#152;&#159;&#230;&#152;&#159;&#231;&#156;&#188;&quot;: &quot;5c/stareyes_org.gif&quot;, &quot;&#229;&#165;&#189;&#229;&#155;&#176;&quot;: &quot;8b/sleepy_org.gif&quot;, &quot;&#229;&#145;&#149;&#229;&#144;&#144;&quot;: &quot;75/sick_org.gif&quot;, &quot;&#229;&#138;&#160;&#230;&#136;&#145;&#228;&#184;&#128;&#228;&#184;&#170;&quot;: &quot;ee/plus1_org.gif&quot;, &quot;&#231;&#151;&#158;&#231;&#151;&#158;&#229;&#133;&#148;&#232;&#128;&#182;&quot;: &quot;19/pipioye_org.gif&quot;, &quot;mua&quot;: &quot;c6/muamua_org.gif&quot;, &quot;&#233;&#157;&#162;&#230;&#138;&#189;&quot;: &quot;fd/mianchou_org.gif&quot;, &quot;&#229;&#164;&#167;&#231;&#172;&#145;&quot;: &quot;6a/laugh_org.gif&quot;, &quot;&#230;&#143;&#137;&quot;: &quot;d6/knead_org.gif&quot;, &quot;&#231;&#151;&#158;&#231;&#151;&#158;&#229;&#133;&#148;&#229;&#155;&#167;&quot;: &quot;38/jiong_org.gif&quot;, &quot;&#229;&#147;&#136;&#229;&#176;&#188;&#229;&#133;&#148;&#232;&#128;&#182;&quot;: &quot;53/honeyoye_org.gif&quot;, &quot;&#229;&#188;&#128;&#229;&#191;&#131;&quot;: &quot;40/happy_org.gif&quot;, &quot;&#229;&#146;&#172;&#230;&#137;&#139;&#229;&#184;&#149;&quot;: &quot;af/handkerchief_org.gif&quot;, &quot;&#229;&#142;&#187;&quot;: &quot;6b/go_org.gif&quot;, &quot;&#230;&#153;&#149;&#230;&#173;&#187;&#228;&#186;&#134;&quot;: &quot;a4/dizzy_org.gif&quot;, &quot;&#229;&#164;&#167;&#229;&#147;&#173;&quot;: &quot;af/cry_org.gif&quot;, &quot;&#230;&#137;&#135;&#229;&#173;&#144;&#233;&#129;&#174;&#233;&#157;&#162;&quot;: &quot;a1/coverface_org.gif&quot;, &quot;&#230;&#128;&#146;&#230;&#176;&#148;&quot;: &quot;ea/angery_org.gif&quot;, &quot;886&quot;: &quot;6f/886_org.gif&quot;, &quot;&#233;&#155;&#190;&quot;: &quot;68/w_org.gif&quot;, &quot;&#229;&#143;&#176;&#233;&#163;&#142;&quot;: &quot;55/tf_org.gif&quot;, &quot;&#230;&#178;&#153;&#229;&#176;&#152;&#230;&#154;&#180;&quot;: &quot;69/sc_org.gif&quot;, &quot;&#230;&#153;&#180;&#232;&#189;&#172;&#229;&#164;&#154;&#228;&#186;&#145;&quot;: &quot;d2/qzdy_org.gif&quot;, &quot;&#230;&#181;&#129;&#230;&#152;&#159;&quot;: &quot;8e/lx_org.gif&quot;, &quot;&#233;&#190;&#153;&#229;&#141;&#183;&#233;&#163;&#142;&quot;: &quot;6a/ljf_org.gif&quot;, &quot;&#230;&#180;&#170;&#230;&#176;&#180;&quot;: &quot;ba/hs2_org.gif&quot;, &quot;&#233;&#163;&#142;&quot;: &quot;74/gf_org.gif&quot;, &quot;&#229;&#164;&#154;&#228;&#186;&#145;&#232;&#189;&#172;&#230;&#153;&#180;&quot;: &quot;f3/dyzq_org.gif&quot;, &quot;&#229;&#189;&#169;&#232;&#153;&#185;&quot;: &quot;03/ch_org.gif&quot;, &quot;&#229;&#134;&#176;&#233;&#155;&#185;&quot;: &quot;05/bb2_org.gif&quot;, &quot;&#229;&#190;&#174;&#233;&#163;&#142;&quot;: &quot;a5/wind_org.gif&quot;, &quot;&#233;&#152;&#179;&#229;&#133;&#137;&quot;: &quot;1a/sunny_org.gif&quot;, &quot;&#233;&#155;&#170;&quot;: &quot;00/snow_org.gif&quot;, &quot;&#233;&#151;&#170;&#231;&#148;&#181;&quot;: &quot;e3/sh_org.gif&quot;, &quot;&#228;&#184;&#139;&#233;&#155;&#168;&quot;: &quot;50/rain.gif&quot;, &quot;&#233;&#152;&#180;&#229;&#164;&#169;&quot;: &quot;37/dark_org.gif&quot;, &quot;&#231;&#153;&#189;&#231;&#190;&#138;&quot;: &quot;07/byz2_org.gif&quot;, &quot;&#229;&#176;&#132;&#230;&#137;&#139;&quot;: &quot;46/ssz2_org.gif&quot;, &quot;&#229;&#143;&#140;&#233;&#177;&#188;&quot;: &quot;e2/syz2_org.gif&quot;, &quot;&#229;&#143;&#140;&#229;&#173;&#144;&quot;: &quot;89/szz2_org.gif&quot;, &quot;&#229;&#164;&#169;&#231;&#167;&#164;&quot;: &quot;6b/tpz2_org.gif&quot;, &quot;&#229;&#164;&#169;&#232;&#157;&#142;&quot;: &quot;1e/txz2_org.gif&quot;, &quot;&#230;&#176;&#180;&#231;&#147;&#182;&quot;: &quot;1b/spz2_org.gif&quot;, &quot;&#229;&#164;&#132;&#229;&#165;&#179;&quot;: &quot;62/cnz2_org.gif&quot;, &quot;&#233;&#135;&#145;&#231;&#137;&#155;&quot;: &quot;3b/jnz2_org.gif&quot;, &quot;&#229;&#183;&#168;&#232;&#159;&#185;&quot;: &quot;d2/jxz2_org.gif&quot;, &quot;&#231;&#139;&#174;&#229;&#173;&#144;&quot;: &quot;4a/leo2_org.gif&quot;, &quot;&#230;&#145;&#169;&#231;&#190;&#175;&quot;: &quot;16/mjz2_org.gif&quot;, &quot;&#229;&#164;&#169;&#232;&#157;&#142;&#229;&#186;&#167;&quot;: &quot;09/txz_org.gif&quot;, &quot;&#229;&#164;&#169;&#231;&#167;&#164;&#229;&#186;&#167;&quot;: &quot;c1/tpz_org.gif&quot;, &quot;&#229;&#143;&#140;&#229;&#173;&#144;&#229;&#186;&#167;&quot;: &quot;d4/szz_org.gif&quot;, &quot;&#229;&#143;&#140;&#233;&#177;&#188;&#229;&#186;&#167;&quot;: &quot;7f/syz_org.gif&quot;, &quot;&#229;&#176;&#132;&#230;&#137;&#139;&#229;&#186;&#167;&quot;: &quot;5d/ssz_org.gif&quot;, &quot;&#230;&#176;&#180;&#231;&#147;&#182;&#229;&#186;&#167;&quot;: &quot;00/spz_org.gif&quot;, &quot;&#230;&#145;&#169;&#231;&#190;&#175;&#229;&#186;&#167;&quot;: &quot;da/mjz_org.gif&quot;, &quot;&#231;&#139;&#174;&#229;&#173;&#144;&#229;&#186;&#167;&quot;: &quot;23/leo_org.gif&quot;, &quot;&#229;&#183;&#168;&#232;&#159;&#185;&#229;&#186;&#167;&quot;: &quot;a3/jxz_org.gif&quot;, &quot;&#233;&#135;&#145;&#231;&#137;&#155;&#229;&#186;&#167;&quot;: &quot;8d/jnz_org.gif&quot;, &quot;&#229;&#164;&#132;&#229;&#165;&#179;&#229;&#186;&#167;&quot;: &quot;09/cnz_org.gif&quot;, &quot;&#231;&#153;&#189;&#231;&#190;&#138;&#229;&#186;&#167;&quot;: &quot;e0/byz_org.gif&quot;, &quot;yeah&quot;: &quot;1a/yeah_org.gif&quot;, &quot;&#229;&#150;&#156;&#230;&#172;&#162;&quot;: &quot;5f/xh_org.gif&quot;, &quot;&#229;&#191;&#131;&#229;&#138;&#168;&quot;: &quot;5f/xd_org.gif&quot;, &quot;&#230;&#151;&#160;&#232;&#129;&#138;&quot;: &quot;53/wl_org.gif&quot;, &quot;&#230;&#137;&#139;&#232;&#136;&#158;&#232;&#182;&#179;&#232;&#185;&#136;&quot;: &quot;b2/gx_org.gif&quot;, &quot;&#230;&#144;&#158;&#231;&#172;&#145;&quot;: &quot;09/gx2_org.gif&quot;, &quot;&#231;&#151;&#155;&#229;&#147;&#173;&quot;: &quot;eb/gd_org.gif&quot;, &quot;&#231;&#136;&#134;&#229;&#143;&#145;&quot;: &quot;38/fn2_org.gif&quot;, &quot;&#229;&#143;&#145;&#229;&#165;&#139;&quot;: &quot;31/d2_org.gif&quot;, &quot;&#228;&#184;&#141;&#229;&#177;&#145;&quot;: &quot;b0/bx_org.gif&quot;, &quot;&#229;&#138;&#160;&#230;&#178;&#185;&quot;: &quot;d4/jiayou_org.gif&quot;, &quot;&#229;&#155;&#189;&#230;&#151;&#151;&quot;: &quot;dc/flag_org.gif&quot;, &quot;&#233;&#135;&#145;&#231;&#137;&#140;&quot;: &quot;f4/jinpai_org.gif&quot;, &quot;&#233;&#147;&#182;&#231;&#137;&#140;&quot;: &quot;1e/yinpai_org.gif&quot;, &quot;&#233;&#147;&#156;&#231;&#137;&#140;&quot;: &quot;26/tongpai_org.gif&quot;, &quot;&#229;&#147;&#168;&#229;&#173;&#144;&quot;: &quot;a0/shao.gif&quot;, &quot;&#233;&#187;&#132;&#231;&#137;&#140;&quot;: &quot;a0/yellowcard.gif&quot;, &quot;&#231;&#186;&#162;&#231;&#137;&#140;&quot;: &quot;64/redcard.gif&quot;, &quot;&#232;&#182;&#179;&#231;&#144;&#131;&quot;: &quot;c0/football.gif&quot;, &quot;&#231;&#175;&#174;&#231;&#144;&#131;&quot;: &quot;2c/bball_org.gif&quot;, &quot;&#233;&#187;&#145;8&quot;: &quot;6b/black8_org.gif&quot;, &quot;&#230;&#142;&#146;&#231;&#144;&#131;&quot;: &quot;cf/volleyball_org.gif&quot;, &quot;&#230;&#184;&#184;&#230;&#179;&#179;&quot;: &quot;b9/swimming_org.gif&quot;, &quot;&#228;&#185;&#146;&#228;&#185;&#147;&#231;&#144;&#131;&quot;: &quot;a5/pingpong_org.gif&quot;, &quot;&#230;&#138;&#149;&#231;&#175;&#174;&quot;: &quot;7a/basketball_org.gif&quot;, &quot;&#231;&#190;&#189;&#230;&#175;&#155;&#231;&#144;&#131;&quot;: &quot;77/badminton_org.gif&quot;, &quot;&#229;&#176;&#132;&#233;&#151;&#168;&quot;: &quot;e0/zuqiu_org.gif&quot;, &quot;&#229;&#176;&#132;&#231;&#174;&#173;&quot;: &quot;40/shejian_org.gif&quot;, &quot;&#228;&#184;&#190;&#233;&#135;&#141;&quot;: &quot;14/juzhong_org.gif&quot;, &quot;&#229;&#135;&#187;&#229;&#137;&#145;&quot;: &quot;38/jijian_org.gif&quot;, &quot;&#231;&#131;&#166;&#232;&#186;&#129;&quot;: &quot;c5/fanzao_org.gif&quot;, &quot;&#229;&#145;&#178;&#231;&#137;&#153;&quot;: &quot;c1/ciya_org.gif&quot;, &quot;&#230;&#156;&#137;&#233;&#146;&#177;&quot;: &quot;e6/youqian_org.gif&quot;, &quot;&#229;&#190;&#174;&#231;&#172;&#145;&quot;: &quot;05/weixiao_org.gif&quot;, &quot;&#229;&#184;&#133;&#231;&#136;&#134;&quot;: &quot;c1/shuaibao_org.gif&quot;, &quot;&#231;&#148;&#159;&#230;&#176;&#148;&quot;: &quot;0a/shengqi_org.gif&quot;, &quot;&#231;&#148;&#159;&#231;&#151;&#133;&#228;&#186;&#134;&quot;: &quot;19/shengbing_org.gif&quot;, &quot;&#232;&#137;&#178;&#231;&#156;&#175;&#231;&#156;&#175;&quot;: &quot;90/semimi_org.gif&quot;, &quot;&#231;&#150;&#178;&#229;&#138;&#179;&quot;: &quot;d1/pilao_org.gif&quot;, &quot;&#231;&#158;&#132;&quot;: &quot;14/miao_org.gif&quot;, &quot;&#229;&#147;&#173;&quot;: &quot;79/ku_org.gif&quot;, &quot;&#229;&#165;&#189;&#229;&#143;&#175;&#230;&#128;&#156;&quot;: &quot;76/kelian_org.gif&quot;, &quot;&#231;&#180;&#167;&#229;&#188;&#160;&quot;: &quot;75/jinzhang_org.gif&quot;, &quot;&#230;&#131;&#138;&#232;&#174;&#182;&quot;: &quot;dc/jingya_org.gif&quot;, &quot;&#230;&#191;&#128;&#229;&#138;&#168;&quot;: &quot;bb/jidong_org.gif&quot;, &quot;&#232;&#167;&#129;&#233;&#146;&#177;&quot;: &quot;2b/jianqian_org.gif&quot;, &quot;&#230;&#177;&#151;&#228;&#186;&#134;&quot;: &quot;7d/han_org.gif&quot;, &quot;&#229;&#165;&#139;&#230;&#150;&#151;&quot;: &quot;4e/fendou_org.gif&quot;, &quot;&#229;&#176;&#143;&#228;&#186;&#186;&#229;&#190;&#151;&#229;&#191;&#151;&quot;: &quot;09/xrdz_org.gif&quot;, &quot;&#229;&#147;&#135;&#229;&#147;&#136;&#229;&#147;&#136;&quot;: &quot;cc/whh_org.gif&quot;, &quot;&#229;&#143;&#185;&#230;&#176;&#148;&quot;: &quot;90/tq_org.gif&quot;, &quot;&#229;&#134;&#187;&#231;&#187;&#147;&quot;: &quot;d3/sjdj_org.gif&quot;, &quot;&#229;&#136;&#135;&quot;: &quot;1d/q_org.gif&quot;, &quot;&#230;&#139;&#141;&#231;&#133;&#167;&quot;: &quot;ec/pz_org.gif&quot;, &quot;&#230;&#128;&#149;&#230;&#128;&#149;&quot;: &quot;7c/pp_org.gif&quot;, &quot;&#230;&#128;&#146;&#229;&#144;&#188;&quot;: &quot;4d/nh_org.gif&quot;, &quot;&#232;&#134;&#156;&#230;&#139;&#156;&quot;: &quot;9f/mb2_org.gif&quot;, &quot;&#232;&#183;&#175;&#232;&#191;&#135;&quot;: &quot;70/lg_org.gif&quot;, &quot;&#230;&#179;&#170;&#229;&#165;&#148;&quot;: &quot;34/lb_org.gif&quot;, &quot;&#232;&#132;&#184;&#229;&#143;&#152;&#232;&#137;&#178;&quot;: &quot;cd/lbs_org.gif&quot;, &quot;&#228;&#186;&#178;&quot;: &quot;05/kiss_org.gif&quot;, &quot;&#230;&#129;&#144;&#230;&#128;&#150;&quot;: &quot;86/kb_org.gif&quot;, &quot;&#228;&#186;&#164;&#231;&#187;&#153;&#230;&#136;&#145;&#229;&#144;&#167;&quot;: &quot;e2/jgwb_org.gif&quot;, &quot;&#230;&#172;&#162;&#230;&#172;&#163;&#233;&#188;&#147;&#232;&#136;&#158;&quot;: &quot;2b/hxgw_org.gif&quot;, &quot;&#233;&#171;&#152;&#229;&#133;&#180;&quot;: &quot;c7/gx3_org.gif&quot;, &quot;&#229;&#176;&#180;&#229;&#176;&#172;&quot;: &quot;43/gg_org.gif&quot;, &quot;&#229;&#143;&#145;&#229;&#151;&#178;&quot;: &quot;4e/fd_org.gif&quot;, &quot;&#231;&#138;&#175;&#233;&#148;&#153;&quot;: &quot;19/fc_org.gif&quot;, &quot;&#229;&#190;&#151;&#230;&#132;&#143;&quot;: &quot;fb/dy_org.gif&quot;, &quot;&#229;&#144;&#181;&#233;&#151;&#185;&quot;: &quot;fa/cn_org.gif&quot;, &quot;&#229;&#134;&#178;&#233;&#148;&#139;&quot;: &quot;2f/cf_org.gif&quot;, &quot;&#230;&#138;&#189;&#232;&#128;&#179;&#229;&#133;&#137;&quot;: &quot;eb/ceg_org.gif&quot;, &quot;&#229;&#183;&#174;&#229;&#190;&#151;&#232;&#191;&#156;&#229;&#145;&#162;&quot;: &quot;ee/cdyn_org.gif&quot;, &quot;&#232;&#162;&#171;&#231;&#160;&#184;&quot;: &quot;5a/bz2_org.gif&quot;, &quot;&#230;&#139;&#156;&#230;&#137;&#152;&quot;: &quot;6e/bt_org.gif&quot;, &quot;&#229;&#191;&#133;&#232;&#131;&#156;&quot;: &quot;cf/bs3_org.gif&quot;, &quot;&#228;&#184;&#141;&#229;&#133;&#179;&#230;&#136;&#145;&#228;&#186;&#139;&quot;: &quot;e8/bgws_org.gif&quot;, &quot;&#228;&#184;&#138;&#231;&#129;&#171;&quot;: &quot;64/bf_org.gif&quot;, &quot;&#228;&#184;&#141;&#229;&#128;&#146;&#231;&#191;&#129;&quot;: &quot;b6/bdw_org.gif&quot;, &quot;&#228;&#184;&#141;&#233;&#148;&#153;&#229;&#147;&#166;&quot;: &quot;79/bco_org.gif&quot;, &quot;&#231;&#156;&#168;&#231;&#156;&#168;&#231;&#156;&#188;&quot;: &quot;3b/zy2_org.gif&quot;, &quot;&#230;&#157;&#130;&#230;&#138;&#128;&quot;: &quot;ec/zs_org.gif&quot;, &quot;&#229;&#164;&#154;&#233;&#151;&#174;&#229;&#143;&#183;&quot;: &quot;17/wh2_org.gif&quot;, &quot;&#232;&#183;&#179;&#231;&#187;&#179;&quot;: &quot;79/ts_org.gif&quot;, &quot;&#229;&#188;&#186;&#229;&#144;&#187;&quot;: &quot;b1/q3_org.gif&quot;, &quot;&#228;&#184;&#141;&#230;&#180;&#187;&#228;&#186;&#134;&quot;: &quot;37/lb2_org.gif&quot;, &quot;&#231;&#163;&#149;&#229;&#164;&#180;&quot;: &quot;6a/kt_org.gif&quot;, &quot;&#229;&#145;&#156;&#229;&#145;&#156;&quot;: &quot;55/bya_org.gif&quot;, &quot;&#228;&#184;&#141;&quot;: &quot;a2/bx2_org.gif&quot;, &quot;&#231;&#139;&#130;&#231;&#172;&#145;&quot;: &quot;d5/zk_org.gif&quot;, &quot;&#229;&#134;&#164;&quot;: &quot;5f/wq2_org.gif&quot;, &quot;&#232;&#156;&#183;&quot;: &quot;87/q2_org.gif&quot;, &quot;&#231;&#190;&#142;&#229;&#165;&#189;&quot;: &quot;ae/mh_org.gif&quot;, &quot;&#228;&#185;&#144;&#229;&#146;&#140;&quot;: &quot;5f/m2_org.gif&quot;, &quot;&#230;&#143;&#170;&#232;&#128;&#179;&#230;&#156;&#181;&quot;: &quot;15/j3_org.gif&quot;, &quot;&#230;&#153;&#131;&quot;: &quot;bf/h2_org.gif&quot;, &quot;high&quot;: &quot;e7/f_org.gif&quot;, &quot;&#232;&#185;&#173;&quot;: &quot;33/c_org.gif&quot;, &quot;&#230;&#138;&#177;&#230;&#158;&#149;&quot;: &quot;f4/bz3_org.gif&quot;, &quot;&#228;&#184;&#141;&#229;&#133;&#172;&#229;&#185;&#179;&quot;: &quot;85/bgp_org.gif&quot;</td></tr><tr><td class="line">730</td><td class="hits"></td><td class="source">// };</td></tr></tbody></table></div><div class="file"><h2 id="tbase.js">tbase.js</h2><div id="stats" class="high"><div class="percentage">90%</div><div class="sloc">424</div><div class="hits">384</div><div class="misses">40</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/tbase.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var querystring = require('querystring');</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var urllib = require('urllib');</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var OAuth = require('./oauth');</td></tr><tr class="hit"> <td class="line">17</td><td class="hits">1</td><td class="source">var emoji = require('emoji');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> * TAPI Base class, support OAuth v1.0</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">22</td><td class="hits">1</td><td class="source">function TBase() {</td></tr><tr class="hit"> <td class="line">23</td><td class="hits">4</td><td class="source">  this.config = {</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    host: 'api start url',</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    result_format: '.json',</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    appkey: '',</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">    secret: '',</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    oauth_host: '',</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    oauth_callback: 'oob or url',</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    oauth_version: '1.0',</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    userinfo_has_counts: true, // &#231;&#148;&#168;&#230;&#136;&#183;&#228;&#191;&#161;&#230;&#129;&#175;&#228;&#184;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#229;&#140;&#133;&#229;&#144;&#171;&#231;&#178;&#137;&#228;&#184;&#157;&#230;&#149;&#176;&#227;&#128;&#129;&#229;&#190;&#174;&#229;&#141;&#154;&#230;&#149;&#176;&#231;&#173;&#137;&#228;&#191;&#161;&#230;&#129;&#175;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    support_counts: true, // &#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#230;&#137;&#185;&#233;&#135;&#143;&#232;&#142;&#183;&#229;&#143;&#150;&#232;&#189;&#172;&#229;&#143;&#145;&#229;&#146;&#140;&#232;&#175;&#132;&#232;&#174;&#186;&#230;&#149;&#176;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    support_comment: true, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#232;&#175;&#132;&#232;&#174;&#186;&#229;&#136;&#151;&#232;&#161;&#168;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    support_do_comment: true, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#229;&#143;&#145;&#233;&#128;&#129;&#232;&#175;&#132;&#232;&#174;&#186;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">    support_repost_comment: true, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#232;&#189;&#172;&#229;&#143;&#145;&#229;&#144;&#140;&#230;&#151;&#182;&#229;&#143;&#145;&#232;&#175;&#132;&#232;&#174;&#186;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    support_repost_comment_to_root: false, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#232;&#189;&#172;&#229;&#143;&#145;&#229;&#144;&#140;&#230;&#151;&#182;&#231;&#187;&#153;&#229;&#142;&#159;&#230;&#150;&#135;&#228;&#189;&#156;&#232;&#128;&#133;&#229;&#143;&#145;&#232;&#175;&#132;&#232;&#174;&#186;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">    support_upload: true, // &#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#228;&#184;&#138;&#228;&#188;&#160;&#229;&#155;&#190;&#231;&#137;&#135;</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    support_repost: true, // &#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#230;&#150;&#176;&#230;&#181;&#170;&#229;&#189;&#162;&#229;&#188;&#143;&#232;&#189;&#172;&#232;&#189;&#189;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    repost_pre: '&#232;&#189;&#172;:', // &#232;&#189;&#172;&#229;&#143;&#145;&#229;&#137;&#141;&#231;&#188;&#128;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    repost_delimiter: '//', //&#232;&#189;&#172;&#229;&#143;&#145;&#231;&#154;&#132;&#229;&#136;&#134;&#233;&#154;&#148;&#231;&#172;&#166;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    image_shorturl_pre: ' [&#229;&#155;&#190;] ', // RT&#229;&#155;&#190;&#231;&#137;&#135;&#231;&#188;&#169;&#229;&#157;&#128;&#229;&#137;&#141;&#231;&#188;&#128;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    support_favorites: true, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#230;&#148;&#182;&#232;&#151;&#143;&#229;&#136;&#151;&#232;&#161;&#168;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    support_do_favorite: true, // &#229;&#136;&#164;&#230;&#150;&#173;&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#230;&#148;&#182;&#232;&#151;&#143;&#229;&#138;&#159;&#232;&#131;&#189;</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    support_geo: true, //&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#229;&#156;&#176;&#231;&#144;&#134;&#228;&#189;&#141;&#231;&#189;&#174;&#228;&#191;&#161;&#230;&#129;&#175;&#228;&#184;&#138;&#228;&#188;&#160;</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    // &#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;max_id &#229;&#136;&#134;&#233;&#161;&#181;</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    support_max_id: true,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    support_destroy_msg: true, //&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#229;&#136;&#160;&#233;&#153;&#164;&#231;&#167;&#129;&#228;&#191;&#161;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    support_direct_messages: true, </td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    support_sent_direct_messages: true, //&#230;&#152;&#175;&#229;&#144;&#166;&#230;&#148;&#175;&#230;&#140;&#129;&#232;&#135;&#170;&#229;&#183;&#177;&#229;&#143;&#145;&#233;&#128;&#129;&#231;&#154;&#132;&#231;&#167;&#129;&#228;&#191;&#161;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    support_mentions: true, </td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    support_friendships_create: true,</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    support_search: true,</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    support_search_max_id: false,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    support_favorites_max_id: false, // &#230;&#148;&#182;&#232;&#151;&#143;&#229;&#136;&#134;&#233;&#161;&#181;&#228;&#189;&#191;&#231;&#148;&#168;max_id</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    need_processMsg: true, //&#230;&#152;&#175;&#229;&#144;&#166;&#233;&#156;&#128;&#232;&#166;&#129;&#229;&#164;&#132;&#231;&#144;&#134;&#230;&#182;&#136;&#230;&#129;&#175;&#231;&#154;&#132;&#229;&#134;&#133;&#229;&#174;&#185;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    comment_need_user_id: false, // &#232;&#175;&#132;&#232;&#174;&#186;&#230;&#152;&#175;&#229;&#144;&#166;&#233;&#156;&#128;&#232;&#166;&#129;&#228;&#189;&#191;&#231;&#148;&#168;&#229;&#136;&#176;&#231;&#148;&#168;&#230;&#136;&#183;id&#239;&#188;&#140;&#233;&#187;&#152;&#232;&#174;&#164;&#228;&#184;&#186;false&#239;&#188;&#140;&#229;&#133;&#188;&#229;&#174;&#185;&#230;&#137;&#128;&#230;&#156;&#137;&#230;&#151;&#167;&#230;&#142;&#165;&#229;&#143;&#163;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">        </td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    // api</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    public_timeline:      '/statuses/public_timeline',</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    home_timeline:        '/statuses/home_timeline',</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    user_timeline:        '/statuses/user_timeline',</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    mentions:             '/statuses/mentions',</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    comments_timeline:    '/comments/timeline',</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    comments_mentions:    '/comments/mentions',</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    comments_to_me:       '/comments/to_me',</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    comments_by_me:       '/comments/by_me',</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    repost_timeline:      '/statuses/repost_timeline',</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">    comments:             '/statuses/comments',</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    show:                 '/statuses/show',</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    count:                '/statuses/count',</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">    update:               '/statuses/update',</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    upload:               '/statuses/upload',</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    repost:               '/statuses/repost',</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">    destroy:              '/statuses/destroy',</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    followers:            '/statuses/followers',</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    friends:              '/statuses/friends',</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    favorites:            '/favorites',</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">    favorites_create:     '/favorites/create',</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">    favorites_destroy:    '/favorites/destroy/{{id}}',</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">    comment_create:       '/statuses/comment',</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    comment_reply:        '/statuses/reply',</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">    comment_destroy:      '/statuses/comment_destroy',</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    destroy_msg:          '/direct_messages/destroy/{{id}}',</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">    direct_messages:      '/direct_messages', </td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">    sent_direct_messages: '/direct_messages/sent', //&#232;&#135;&#170;&#229;&#183;&#177;&#229;&#143;&#145;&#233;&#128;&#129;&#231;&#154;&#132;&#231;&#167;&#129;&#228;&#191;&#161;&#229;&#136;&#151;&#232;&#161;&#168;&#239;&#188;&#140;&#230;&#136;&#145;&#229;&#189;&#147;&#230;&#151;&#182;&#228;&#184;&#186;&#228;&#187;&#128;&#228;&#185;&#136;&#232;&#166;&#129;&#229;&#145;&#189;&#229;&#144;&#141;&#228;&#184;&#186;sent_direct_messages&#230;&#141;&#143;&#239;&#188;&#140;&#230;&#136;&#145;&#230;&#147;&#166;</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">    new_message:          '/direct_messages/new',</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    verify_credentials:   '/account/verify_credentials',</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    user_show:            '/users/show',</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    rate_limit_status:    '/account/rate_limit_status',</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    friendships_create:   '/friendships/create',</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">    friendships_destroy:  '/friendships/destroy',</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">    friendships_show:     '/friendships/show',</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">    reset_count:          '/statuses/reset_count',</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    emotions:             '/emotions',</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">    // &#231;&#148;&#168;&#230;&#136;&#183;&#230;&#160;&#135;&#231;&#173;&#190;</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">    tags:                 '/tags',</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    create_tag:           '/tags/create',</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">    destroy_tag:          '/tags/destroy',</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">    tags_suggestions:     '/tags/suggestions',</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    // &#230;&#144;&#156;&#231;&#180;&#162;</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">    search:               '/statuses/search',</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">    user_search:          '/users/search',</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">    oauth_authorize:      '/oauth/authorize',</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">    oauth_request_token:  '/oauth/request_token',</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">    oauth_access_token:   '/oauth/access_token',</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">    // &#229;&#155;&#190;&#231;&#137;&#135;&#228;&#184;&#138;&#228;&#188;&#160;&#229;&#173;&#151;&#230;&#174;&#181;&#229;&#144;&#141;&#231;&#167;&#176;</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">    pic_field: 'pic',</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">122</td><td class="hits">1</td><td class="source">module.exports = TBase;</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">124</td><td class="hits">1</td><td class="source">TBase.prototype.init = function (config) {</td></tr><tr class="hit"> <td class="line">125</td><td class="hits">4</td><td class="source">  for (var k in config) {</td></tr><tr class="hit"> <td class="line">126</td><td class="hits">99</td><td class="source">    this.config[k] = config[k];</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source"> * Utils methods</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">134</td><td class="hits">1</td><td class="source">TBase.prototype.URL_RE = new RegExp('(?:\\[url\\s*=\\s*|)((?:www\\.|http[s]?://)[\\w\\.\\?%&amp;\\-/#=;:!\\+~]+)(?:\\](.+)\\[/url\\]|)', 'ig');</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">136</td><td class="hits">1</td><td class="source">TBase.prototype.process_text = function (status) {</td></tr><tr class="hit"> <td class="line">137</td><td class="hits">6</td><td class="source">  var text = status.text;</td></tr><tr class="hit"> <td class="line">138</td><td class="hits">6</td><td class="source">  if (!text) {</td></tr><tr class="hit"> <td class="line">139</td><td class="hits">3</td><td class="source">    return '&amp;nbsp;';</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">141</td><td class="hits">3</td><td class="source">  text = utils.escape(text);</td></tr><tr class="hit"> <td class="line">142</td><td class="hits">3</td><td class="source">  text = text.replace(this.URL_RE, this._replace_url);</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">144</td><td class="hits">3</td><td class="source">  text = this.process_at(text, status); //@***</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">146</td><td class="hits">3</td><td class="source">  text = this.process_emotional(text, status); </td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">148</td><td class="hits">3</td><td class="source">  text = this.process_search(text, status); //#xxXX#</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">150</td><td class="hits">3</td><td class="source">  text = emoji.unifiedToHTML(emoji.softbankToUnified(text));</td></tr><tr class="hit"> <td class="line">151</td><td class="hits">3</td><td class="source">  return text || '&amp;nbsp;';</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">154</td><td class="hits">1</td><td class="source">TBase.prototype._replace_url = function (m, g1, g2) {</td></tr><tr class="hit"> <td class="line">155</td><td class="hits">2</td><td class="source">  var url = g1;</td></tr><tr class="hit"> <td class="line">156</td><td class="hits">2</td><td class="source">  if (g1.indexOf('http') !== 0) {</td></tr><tr class="hit"> <td class="line">157</td><td class="hits">1</td><td class="source">    url = 'http://' + g1;</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">159</td><td class="hits">2</td><td class="source">  var tpl = '&lt;a target=&quot;_blank&quot; class=&quot;link&quot; href=&quot;{{url}}&quot;&gt;{{value}}&lt;/a&gt;';</td></tr><tr class="hit"> <td class="line">160</td><td class="hits">2</td><td class="source">  return utils.format(tpl, { url: url, title: g1, value: g2 || g1 });</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">163</td><td class="hits">1</td><td class="source">TBase.prototype.SearchMatchReg = /#([^#]+)#/g;</td></tr><tr class="hit"> <td class="line">164</td><td class="hits">1</td><td class="source">TBase.prototype.process_search = function (text, status) {</td></tr><tr class="hit"> <td class="line">165</td><td class="hits">6</td><td class="source">  var url = this.config.search_url;</td></tr><tr class="hit"> <td class="line">166</td><td class="hits">6</td><td class="source">  return text.replace(this.SearchMatchReg, function (m, g1) {</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    // fixed #xxx@xxx# nesting problem</td></tr><tr class="hit"> <td class="line">168</td><td class="hits">8</td><td class="source">    var search = utils.removeHTML(g1);</td></tr><tr class="hit"> <td class="line">169</td><td class="hits">8</td><td class="source">    var tpl = '&lt;a target=&quot;_blank&quot; href=&quot;{{url}}{{searchEncode}}&quot; title=&quot;Search #{{search}}#&quot;&gt;#{{search}}#&lt;/a&gt;';</td></tr><tr class="hit"> <td class="line">170</td><td class="hits">8</td><td class="source">    return utils.format(tpl, {search: search, searchEncode: encodeURIComponent(search), url: url});</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">// // return [[hash1, hash_value], ..., [#xxx#, xxx]]</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">// TBase.prototype.findSearchText = function (text, status) {</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">//   var matchs = text.match(this.SearchMatchReg);</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">//   var result = [];</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">//   if (matchs) {</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">//     for (var i = 0, len = matchs.length; i &lt; len; i++) {</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">//       var s = matchs[i];</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">//       result.push([s, s.substring(1, s.length - 1)]);</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">//   }</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">//   return result;</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">// };</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">// TBase.prototype.formatSearchText = function (str) { // &#230;&#160;&#188;&#229;&#188;&#143;&#229;&#140;&#150;&#228;&#184;&#187;&#233;&#162;&#152;</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">//     return '#' + str.trim() + '#';</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">// };</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">191</td><td class="hits">1</td><td class="source">TBase.prototype._at_match_rex = /@([&#226;&#151;&#143;\w\-\_\u2E80-\u3000\u303F-\u9FFF]+)/g;</td></tr><tr class="hit"> <td class="line">192</td><td class="hits">1</td><td class="source">TBase.prototype.process_at = function (text, status) { </td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">  // Handle no-ascii</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">  //@*** u4e00-\u9fa5:&#228;&#184;&#173;&#230;&#150;&#135;&#229;&#173;&#151;&#231;&#172;&#166; \u2E80-\u9FFF:&#228;&#184;&#173;&#230;&#151;&#165;&#233;&#159;&#169;&#229;&#173;&#151;&#231;&#172;&#166;</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  //&#227;&#128;&#144;&#232;&#167;&#130;&#231;&#130;&#185;&#194;&#183;@&#228;&#187;&#187;&#229;&#191;&#151;&#229;&#188;&#186;&#227;&#128;&#145;&#228;&#187;&#138;&#229;&#185;&#180;&#230;&#143;&#144;&#229;&#135;&#186;&#231;&#154;&#132;1000&#228;&#184;&#135;&#229;&#165;&#151;&#231;&#154;&#132;&#228;&#191;&#157;&#233;&#154;&#156;&#230;&#136;&#191;&#228;&#187;&#187;&#229;&#138;&#161;&#229;&#143;&#175;&#232;&#131;&#189;&#230;&#160;&#185;&#230;&#156;&#172;&#229;&#174;&#140;&#228;&#184;&#141;&#230;&#136;&#144;</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">  // http://blog.oasisfeng.com/2006/10/19/full-cjk-unicode-range/</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">  // CJK&#230;&#160;&#135;&#231;&#130;&#185;&#231;&#172;&#166;&#229;&#143;&#183;&#239;&#188;&#154;3000-303F</td></tr><tr class="hit"> <td class="line">198</td><td class="hits">5</td><td class="source">  var homeurl = this.config.user_home_url;</td></tr><tr class="hit"> <td class="line">199</td><td class="hits">5</td><td class="source">  return text.replace(this._at_match_rex, function (m, g1) {</td></tr><tr class="hit"> <td class="line">200</td><td class="hits">4</td><td class="source">    var url = homeurl + encodeURIComponent(g1);</td></tr><tr class="hit"> <td class="line">201</td><td class="hits">4</td><td class="source">    return '&lt;a class=&quot;at-user-link&quot; href=&quot;' + url + '&quot;&gt;@' + g1 + '&lt;/a&gt;';</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">// // &#232;&#142;&#183;&#229;&#143;&#150;str&#233;&#135;&#140;&#233;&#157;&#162;&#230;&#137;&#128;&#230;&#156;&#137;@&#231;&#148;&#168;&#230;&#136;&#183;&#231;&#154;&#132;&#229;&#144;&#141;&#231;&#167;&#176;&#229;&#136;&#151;&#232;&#161;&#168;&#239;&#188;&#140;&#228;&#184;&#141;&#229;&#140;&#133;&#229;&#144;&#171;@&#231;&#172;&#166;&#229;&#144;&#136;</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">// find_at_users: function (str) {</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">//     if (!str) {</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">//         return null;</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">//     var matchs = str.match(this._at_match_rex);</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source">//     if (matchs) {</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">//         var users = [];</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">//         for(var i = 0, l = matchs.length; i &lt; l; i++) {</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">//             var name = matchs[i].substring(1);</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">//             if(users.indexOf(name) &lt; 0) {</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">//                 users.push(name);</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">//             }</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">//         return users;</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">//     }</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">//     return null;</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">// },</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">224</td><td class="hits">1</td><td class="source">TBase.prototype.process_emotional = function (text, status) {</td></tr><tr class="hit"> <td class="line">225</td><td class="hits">3</td><td class="source">  return text.replace(/\[([\u4e00-\u9fff,\uff1f,\w]{1,6})\]/g, this._replace_emotional.bind(this));</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">228</td><td class="hits">1</td><td class="source">TBase.prototype.EMOTION_TPL = '&lt;img title=&quot;{{title}}&quot; src=&quot;{{src}}&quot; /&gt;';</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">230</td><td class="hits">1</td><td class="source">TBase.prototype._replace_emotional = function (m, g1) {</td></tr><tr class="miss"> <td class="line">231</td><td class="hits">0</td><td class="source">  if (!g1) {</td></tr><tr class="miss"> <td class="line">232</td><td class="hits">0</td><td class="source">    return m;</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">  // if (!this.bgEmotions &amp;&amp; typeof getBackgroundView !== 'undefined') {</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">  //   this.bgEmotions = getBackgroundView().Emotions;</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">  //   if (this.bgEmotions) {</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">  //     this.bgEmotions = this.bgEmotions.weibo;</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">  //   }</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">  // }</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">  // var face = this.bgEmotions &amp;&amp; this.bgEmotions[g1];</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">  // if (!face) {</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">  //     face = TSINA_API_EMOTIONS[g1];</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">  //     if (face) {</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">  //         face = TSINA_FACE_URL_PRE + face;</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">  //     }</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">  // }</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">  // if (face) {</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">  //     return this.EMOTION_TPL.format({ title: m, src: face });</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">  // }</td></tr><tr class="miss"> <td class="line">250</td><td class="hits">0</td><td class="source">  return m;</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">253</td><td class="hits">1</td><td class="source">TBase.prototype.url_encode = function (text) {</td></tr><tr class="hit"> <td class="line">254</td><td class="hits">8</td><td class="source">  return encodeURIComponent(text);</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">257</td><td class="hits">1</td><td class="source">TBase.prototype._timeline = function (request_method, user, cursor, callback, playload) {</td></tr><tr class="hit"> <td class="line">258</td><td class="hits">32</td><td class="source">  cursor = this.convert_cursor(cursor);</td></tr><tr class="hit"> <td class="line">259</td><td class="hits">32</td><td class="source">  var params = {</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">    playload: playload || 'status[]',</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">    data: cursor,</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">    request_method: request_method</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">266</td><td class="hits">32</td><td class="source">  var url = this.config[request_method];</td></tr><tr class="hit"> <td class="line">267</td><td class="hits">32</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">268</td><td class="hits">32</td><td class="source">  return this;</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">271</td><td class="hits">1</td><td class="source">TBase.prototype.errorname = function (name) {</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">  // get_access_token =&gt; GetAccessTokenError</td></tr><tr class="hit"> <td class="line">273</td><td class="hits">21</td><td class="source">  name = name.replace(/(?:^\w|\_\w)/g, function (m) {</td></tr><tr class="hit"> <td class="line">274</td><td class="hits">35</td><td class="source">    if (m.length === 2) {</td></tr><tr class="hit"> <td class="line">275</td><td class="hits">14</td><td class="source">      m = m.substring(1);</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">277</td><td class="hits">35</td><td class="source">    return m.toUpperCase();</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">279</td><td class="hits">21</td><td class="source">  return name + 'Error';</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">282</td><td class="hits">1</td><td class="source">TBase.prototype.detect_error = function (method, res, playload, data) {</td></tr><tr class="hit"> <td class="line">283</td><td class="hits">79</td><td class="source">  if (res.statusCode === 200) {</td></tr><tr class="hit"> <td class="line">284</td><td class="hits">69</td><td class="source">    return null;</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">286</td><td class="hits">10</td><td class="source">  var errMessage = null;</td></tr><tr class="hit"> <td class="line">287</td><td class="hits">10</td><td class="source">  if (method === 'get_request_token' || method === 'get_access_token') {</td></tr><tr class="hit"> <td class="line">288</td><td class="hits">1</td><td class="source">    var token = querystring.parse(data);</td></tr><tr class="hit"> <td class="line">289</td><td class="hits">1</td><td class="source">    if (token) {</td></tr><tr class="hit"> <td class="line">290</td><td class="hits">1</td><td class="source">      errMessage = 'Get request token error, ' + (token.error_CN || token.error || data);</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"> <td class="line">292</td><td class="hits">0</td><td class="source">      errMessage = 'Get request token error, empty token string';</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"> <td class="line">295</td><td class="hits">9</td><td class="source">    errMessage = data.error_CN || data.error || data.message || data;</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">297</td><td class="hits">10</td><td class="source">  var err = new Error(errMessage);</td></tr><tr class="hit"> <td class="line">298</td><td class="hits">10</td><td class="source">  err.data = data;</td></tr><tr class="hit"> <td class="line">299</td><td class="hits">10</td><td class="source">  err.name = this.errorname(method);</td></tr><tr class="hit"> <td class="line">300</td><td class="hits">10</td><td class="source">  return err;</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">303</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source"> * &#229;&#176;&#129;&#232;&#163;&#133;&#230;&#137;&#128;&#230;&#156;&#137;http&#232;&#175;&#183;&#230;&#177;&#130;&#239;&#188;&#140;&#232;&#135;&#170;&#229;&#138;&#168;&#229;&#140;&#186;&#229;&#136;&#134;&#229;&#164;&#132;&#231;&#144;&#134;http&#229;&#146;&#140;https</td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source"> * args: {</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source"> *  data, </td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source"> *  type: 'GET | POST | DELETE', </td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source"> *  headers</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source"> * }</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source"> * callback.call(context, data, error, res || xhr)</td></tr><tr><td class="line">311</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">312</td><td class="hits">1</td><td class="source">TBase.prototype.request = function (url, args, callback) {</td></tr><tr class="hit"> <td class="line">313</td><td class="hits">89</td><td class="source">  var playload = args.playload;</td></tr><tr class="hit"> <td class="line">314</td><td class="hits">89</td><td class="source">  if (playload !== 'string') {</td></tr><tr class="hit"> <td class="line">315</td><td class="hits">84</td><td class="source">    args.dataType = 'json';</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">317</td><td class="hits">89</td><td class="source">  var self = this;</td></tr><tr class="hit"> <td class="line">318</td><td class="hits">89</td><td class="source">  urllib.request(url, args, function (err, data, res) {</td></tr><tr class="hit"> <td class="line">319</td><td class="hits">89</td><td class="source">    if (err) {</td></tr><tr class="miss"> <td class="line">320</td><td class="hits">0</td><td class="source">      return callback(err);</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">322</td><td class="hits">89</td><td class="source">    if (playload === 'string') {</td></tr><tr class="hit"> <td class="line">323</td><td class="hits">5</td><td class="source">      data = data.toString();</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">    // console.log(url, args, res.headers, res.statusCode, data)</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">    // console.log(data.data)</td></tr><tr class="hit"> <td class="line">327</td><td class="hits">89</td><td class="source">    err = self.detect_error(args.request_method, res, playload, data);</td></tr><tr class="hit"> <td class="line">328</td><td class="hits">89</td><td class="source">    if (err) {</td></tr><tr class="hit"> <td class="line">329</td><td class="hits">20</td><td class="source">      return callback(err);</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">331</td><td class="hits">69</td><td class="source">    if (playload === 'string') {</td></tr><tr class="hit"> <td class="line">332</td><td class="hits">3</td><td class="source">      return callback(null, data);</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">334</td><td class="hits">66</td><td class="source">    callback(null, this.format_result(data, playload, args));</td></tr><tr><td class="line">335</td><td class="hits"></td><td class="source">  }, this);</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">338</td><td class="hits">1</td><td class="source">TBase.prototype.send_request = function (url, params, callback) {</td></tr><tr class="hit"> <td class="line">339</td><td class="hits">83</td><td class="source">  var args = {</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">    type: 'GET', </td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">    playload: 'status', </td></tr><tr><td class="line">342</td><td class="hits"></td><td class="source">    headers: {}</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">344</td><td class="hits">83</td><td class="source">  for (var k in params) {</td></tr><tr class="hit"> <td class="line">345</td><td class="hits">418</td><td class="source">    args[k] = params[k];</td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">347</td><td class="hits">83</td><td class="source">  args.type = (args.type || 'GET').toUpperCase();</td></tr><tr class="hit"> <td class="line">348</td><td class="hits">83</td><td class="source">  args.data = args.data || {};</td></tr><tr><td class="line">349</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">350</td><td class="hits">83</td><td class="source">  var user = args.user || args.data.user || {};</td></tr><tr class="hit"> <td class="line">351</td><td class="hits">83</td><td class="source">  args.user = user;</td></tr><tr class="hit"> <td class="line">352</td><td class="hits">83</td><td class="source">  if (args.data &amp;&amp; args.data.user) {</td></tr><tr class="miss"> <td class="line">353</td><td class="hits">0</td><td class="source">    delete args.data.user;</td></tr><tr><td class="line">354</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">355</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">356</td><td class="hits">83</td><td class="source">  var api = args.api_host || this.config.host;</td></tr><tr class="hit"> <td class="line">357</td><td class="hits">83</td><td class="source">  if (args.api_host) {</td></tr><tr class="hit"> <td class="line">358</td><td class="hits">5</td><td class="source">    delete args.api_host;</td></tr><tr><td class="line">359</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">361</td><td class="hits">83</td><td class="source">  url = api + url.format(args.data);</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">  // delete the url params</td></tr><tr class="hit"> <td class="line">363</td><td class="hits">83</td><td class="source">  url.replace(utils.STRING_FORMAT_REGEX, function (match, key) {</td></tr><tr class="miss"> <td class="line">364</td><td class="hits">0</td><td class="source">    delete args.data[key];</td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">367</td><td class="hits">83</td><td class="source">  if (args.playload !== 'string' &amp;&amp; this.config.result_format) {</td></tr><tr class="hit"> <td class="line">368</td><td class="hits">42</td><td class="source">    url += this.config.result_format;</td></tr><tr><td class="line">369</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">371</td><td class="hits">83</td><td class="source">  this.apply_auth(url, args, user);</td></tr><tr class="hit"> <td class="line">372</td><td class="hits">83</td><td class="source">  if (args.type === 'POST') {</td></tr><tr class="hit"> <td class="line">373</td><td class="hits">34</td><td class="source">    args.headers['Content-Type'] = args.content_type || 'application/x-www-form-urlencoded;charset=UTF-8;';</td></tr><tr><td class="line">374</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">375</td><td class="hits">83</td><td class="source">  this.request(url, args, callback);</td></tr><tr><td class="line">376</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">378</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">379</td><td class="hits"></td><td class="source"> * OAuth</td></tr><tr><td class="line">380</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">381</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">382</td><td class="hits">1</td><td class="source">TBase.prototype.format_authorization_url = function (params) {</td></tr><tr class="hit"> <td class="line">383</td><td class="hits">6</td><td class="source">  var login_url = (this.config.oauth_host || this.config.host) + this.config.oauth_authorize;</td></tr><tr class="hit"> <td class="line">384</td><td class="hits">6</td><td class="source">  return OAuth.addToURL(login_url, params);</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">386</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">387</td><td class="hits">1</td><td class="source">TBase.prototype.get_authorization_url = function (user, callback) {</td></tr><tr class="hit"> <td class="line">388</td><td class="hits">2</td><td class="source">  var self = this;</td></tr><tr class="hit"> <td class="line">389</td><td class="hits">2</td><td class="source">  self.get_request_token(user, function (err, token) {</td></tr><tr class="hit"> <td class="line">390</td><td class="hits">2</td><td class="source">    var info = null;</td></tr><tr class="hit"> <td class="line">391</td><td class="hits">2</td><td class="source">    if (err) {</td></tr><tr class="miss"> <td class="line">392</td><td class="hits">0</td><td class="source">      return callback(err);</td></tr><tr><td class="line">393</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">394</td><td class="hits">2</td><td class="source">    if (token) {</td></tr><tr class="hit"> <td class="line">395</td><td class="hits">2</td><td class="source">      var params = {</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source">        oauth_token: token.oauth_token,</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source">        oauth_callback: user.oauth_callback || self.config.oauth_callback</td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source">      };</td></tr><tr class="hit"> <td class="line">399</td><td class="hits">2</td><td class="source">      info = token;</td></tr><tr class="hit"> <td class="line">400</td><td class="hits">2</td><td class="source">      info.blogtype = user.blogtype;</td></tr><tr class="hit"> <td class="line">401</td><td class="hits">2</td><td class="source">      info.auth_url = self.format_authorization_url(params);</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">403</td><td class="hits">2</td><td class="source">    callback(err, info);</td></tr><tr><td class="line">404</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">405</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">406</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">407</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">408</td><td class="hits">1</td><td class="source">TBase.prototype.get_request_token = function (user, callback) {</td></tr><tr class="hit"> <td class="line">409</td><td class="hits">2</td><td class="source">  var self = this;</td></tr><tr class="hit"> <td class="line">410</td><td class="hits">2</td><td class="source">  var url = self.config.oauth_request_token;</td></tr><tr class="hit"> <td class="line">411</td><td class="hits">2</td><td class="source">  var params = {</td></tr><tr><td class="line">412</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">413</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source">    playload: 'string',</td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source">    data: {</td></tr><tr><td class="line">416</td><td class="hits"></td><td class="source">      oauth_callback: user.oauth_callback || self.config.oauth_callback</td></tr><tr><td class="line">417</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">    api_host: self.config.oauth_host,</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source">    request_method: 'get_request_token'</td></tr><tr><td class="line">420</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">421</td><td class="hits">2</td><td class="source">  if (self.config.oauth_request_params) {</td></tr><tr class="miss"> <td class="line">422</td><td class="hits">0</td><td class="source">    utils.extend(params.data, self.config.oauth_request_params);</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">424</td><td class="hits">2</td><td class="source">  self.send_request(url, params, function (err, token) {</td></tr><tr class="hit"> <td class="line">425</td><td class="hits">2</td><td class="source">    if (err) {</td></tr><tr class="miss"> <td class="line">426</td><td class="hits">0</td><td class="source">      return callback(err);</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">428</td><td class="hits">2</td><td class="source">    token = self.format_access_token(token);</td></tr><tr class="hit"> <td class="line">429</td><td class="hits">2</td><td class="source">    token.blogtype = user.blogtype;</td></tr><tr class="hit"> <td class="line">430</td><td class="hits">2</td><td class="source">    callback(null, token);</td></tr><tr><td class="line">431</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">432</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source">},</td></tr><tr><td class="line">434</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">// user must contain oauth_pin or oauth_verifier</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source">TBase.prototype.get_access_token = function (user, callback) {</td></tr><tr class="hit"> <td class="line">437</td><td class="hits">1</td><td class="source">  if (!user.authtype) {</td></tr><tr class="hit"> <td class="line">438</td><td class="hits">1</td><td class="source">    user.authtype = 'oauth';</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">440</td><td class="hits">1</td><td class="source">  var url = this.config.oauth_access_token;</td></tr><tr class="hit"> <td class="line">441</td><td class="hits">1</td><td class="source">  var data = {};</td></tr><tr class="hit"> <td class="line">442</td><td class="hits">1</td><td class="source">  var params = {</td></tr><tr><td class="line">443</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">444</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">445</td><td class="hits"></td><td class="source">    playload: 'string',</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">    data: data,</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source">    api_host: this.config.oauth_host,</td></tr><tr><td class="line">448</td><td class="hits"></td><td class="source">    request_method: 'get_access_token'</td></tr><tr><td class="line">449</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">450</td><td class="hits">1</td><td class="source">  var oauth_verifier = user.oauth_pin || user.oauth_verifier || 'no_verifier';</td></tr><tr class="hit"> <td class="line">451</td><td class="hits">1</td><td class="source">  if (oauth_verifier) {</td></tr><tr class="hit"> <td class="line">452</td><td class="hits">1</td><td class="source">    data.oauth_verifier = oauth_verifier;</td></tr><tr class="hit"> <td class="line">453</td><td class="hits">1</td><td class="source">    delete user.oauth_pin;</td></tr><tr class="hit"> <td class="line">454</td><td class="hits">1</td><td class="source">    delete user.oauth_verifier;</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">456</td><td class="hits">1</td><td class="source">  if (user.authtype === 'xauth') {</td></tr><tr class="miss"> <td class="line">457</td><td class="hits">0</td><td class="source">    data.x_auth_username = user.username;</td></tr><tr class="miss"> <td class="line">458</td><td class="hits">0</td><td class="source">    data.x_auth_password = user.password;</td></tr><tr class="miss"> <td class="line">459</td><td class="hits">0</td><td class="source">    data.x_auth_mode = &quot;client_auth&quot;;</td></tr><tr><td class="line">460</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">461</td><td class="hits">1</td><td class="source">  this.send_request(url, params, function (err, token) {</td></tr><tr class="hit"> <td class="line">462</td><td class="hits">1</td><td class="source">    if (err) {</td></tr><tr class="hit"> <td class="line">463</td><td class="hits">1</td><td class="source">      return callback(err);</td></tr><tr><td class="line">464</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">465</td><td class="hits">0</td><td class="source">    token = querystring.parse(token);</td></tr><tr class="miss"> <td class="line">466</td><td class="hits">0</td><td class="source">    token.blogtype = user.blogtype;</td></tr><tr class="miss"> <td class="line">467</td><td class="hits">0</td><td class="source">    callback(null, token);</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">469</td><td class="hits">1</td><td class="source">  return this;</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">471</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">472</td><td class="hits">1</td><td class="source">TBase.prototype.apply_auth = function (url, args, user) {</td></tr><tr class="hit"> <td class="line">473</td><td class="hits">40</td><td class="source">  user.authtype = user.authtype || 'oauth';</td></tr><tr class="hit"> <td class="line">474</td><td class="hits">40</td><td class="source">  args.headers = args.headers || {};</td></tr><tr class="hit"> <td class="line">475</td><td class="hits">40</td><td class="source">  if (user.authtype === 'baseauth') {</td></tr><tr class="miss"> <td class="line">476</td><td class="hits">0</td><td class="source">    if (user.username &amp;&amp; user.password) {</td></tr><tr class="miss"> <td class="line">477</td><td class="hits">0</td><td class="source">      args.headers.Authorization = urllib.make_base_auth_header(user.username, user.password);</td></tr><tr><td class="line">478</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">479</td><td class="hits">40</td><td class="source">  } else if (user.authtype === 'oauth' || user.authtype === 'xauth') {</td></tr><tr class="hit"> <td class="line">480</td><td class="hits">40</td><td class="source">    var accessor = {</td></tr><tr><td class="line">481</td><td class="hits"></td><td class="source">      consumerSecret: this.config.secret</td></tr><tr><td class="line">482</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source">    // &#229;&#183;&#178;&#233;&#128;&#154;&#232;&#191;&#135;oauth&#232;&#174;&#164;&#232;&#175;&#129;</td></tr><tr class="hit"> <td class="line">484</td><td class="hits">40</td><td class="source">    if (user.oauth_token_secret) {</td></tr><tr class="hit"> <td class="line">485</td><td class="hits">38</td><td class="source">      accessor.tokenSecret = user.oauth_token_secret;</td></tr><tr><td class="line">486</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">487</td><td class="hits">40</td><td class="source">    var parameters = {};</td></tr><tr><td class="line">488</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">489</td><td class="hits">40</td><td class="source">    for (var k in args.data) {</td></tr><tr class="hit"> <td class="line">490</td><td class="hits">134</td><td class="source">      parameters[k] = args.data[k];</td></tr><tr class="hit"> <td class="line">491</td><td class="hits">134</td><td class="source">      if (k.substring(0, 6) === 'oauth_') { // &#229;&#136;&#160;&#233;&#153;&#164;oauth_verifier&#231;&#155;&#184;&#229;&#133;&#179;&#229;&#143;&#130;&#230;&#149;&#176;</td></tr><tr class="hit"> <td class="line">492</td><td class="hits">3</td><td class="source">        delete args.data[k];</td></tr><tr><td class="line">493</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">    } </td></tr><tr><td class="line">495</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">496</td><td class="hits">40</td><td class="source">    var message = {</td></tr><tr><td class="line">497</td><td class="hits"></td><td class="source">      action: url,</td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source">      method: args.type, </td></tr><tr><td class="line">499</td><td class="hits"></td><td class="source">      parameters: parameters</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"> <td class="line">501</td><td class="hits">40</td><td class="source">    message.parameters.oauth_consumer_key = this.config.appkey;</td></tr><tr class="hit"> <td class="line">502</td><td class="hits">40</td><td class="source">    message.parameters.oauth_version = '1.0';</td></tr><tr><td class="line">503</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source">    // &#229;&#183;&#178;&#233;&#128;&#154;&#232;&#191;&#135;oauth&#232;&#174;&#164;&#232;&#175;&#129;</td></tr><tr class="hit"> <td class="line">505</td><td class="hits">40</td><td class="source">    if (user.oauth_token) {</td></tr><tr class="hit"> <td class="line">506</td><td class="hits">38</td><td class="source">      message.parameters.oauth_token = user.oauth_token;</td></tr><tr><td class="line">507</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">508</td><td class="hits"></td><td class="source">    // &#232;&#174;&#190;&#231;&#189;&#174;&#230;&#151;&#182;&#233;&#151;&#180;&#230;&#136;&#179;</td></tr><tr class="hit"> <td class="line">509</td><td class="hits">40</td><td class="source">    OAuth.setTimestampAndNonce(message);</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source">    // &#231;&#173;&#190;&#229;&#144;&#141;&#229;&#143;&#130;&#230;&#149;&#176;</td></tr><tr><td class="line">511</td><td class="hits"></td><td class="source">    // console.log(message.parameters);</td></tr><tr class="hit"> <td class="line">512</td><td class="hits">40</td><td class="source">    OAuth.SignatureMethod.sign(message, accessor);</td></tr><tr><td class="line">513</td><td class="hits"></td><td class="source">    // oauth&#229;&#143;&#130;&#230;&#149;&#176;&#233;&#128;&#154;&#232;&#191;&#135;get&#230;&#150;&#185;&#229;&#188;&#143;&#228;&#188;&#160;&#233;&#128;&#146;</td></tr><tr class="hit"> <td class="line">514</td><td class="hits">40</td><td class="source">    if (this.config.oauth_params_by_get) {</td></tr><tr class="hit"> <td class="line">515</td><td class="hits">40</td><td class="source">      args.data = message.parameters;</td></tr><tr><td class="line">516</td><td class="hits"></td><td class="source">      //console.log(args.data);</td></tr><tr><td class="line">517</td><td class="hits"></td><td class="source">    } else {</td></tr><tr><td class="line">518</td><td class="hits"></td><td class="source">      // &#232;&#142;&#183;&#229;&#143;&#150;&#232;&#174;&#164;&#232;&#175;&#129;&#229;&#164;&#180;&#233;&#131;&#168;</td></tr><tr class="miss"> <td class="line">519</td><td class="hits">0</td><td class="source">      args.headers.Authorization = OAuth.getAuthorizationHeader(this.config.oauth_realm, message.parameters);</td></tr><tr><td class="line">520</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">521</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">522</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">523</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">524</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source"> * Result getters</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">527</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">528</td><td class="hits">1</td><td class="source">TBase.prototype.get_result_items = function (data, playload, args) {</td></tr><tr class="miss"> <td class="line">529</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method');</td></tr><tr><td class="line">530</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">531</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">532</td><td class="hits">1</td><td class="source">TBase.prototype.get_result_item = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">533</td><td class="hits">31</td><td class="source">  return data;</td></tr><tr><td class="line">534</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">536</td><td class="hits">1</td><td class="source">TBase.prototype.get_pagging_cursor = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">537</td><td class="hits">35</td><td class="source">  return {};</td></tr><tr><td class="line">538</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source"> * Result formaters</td></tr><tr><td class="line">542</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">544</td><td class="hits">1</td><td class="source">TBase.prototype.format_result = function (data, playload, args) {</td></tr><tr><td class="line">545</td><td class="hits"></td><td class="source">  // status[]: need Array and item type is `status`</td></tr><tr><td class="line">546</td><td class="hits"></td><td class="source">  // status: need item, type is `status`</td></tr><tr class="hit"> <td class="line">547</td><td class="hits">66</td><td class="source">  var index = playload.indexOf('[]');</td></tr><tr class="hit"> <td class="line">548</td><td class="hits">66</td><td class="source">  var isList = index &gt; 0;</td></tr><tr class="hit"> <td class="line">549</td><td class="hits">66</td><td class="source">  if (isList) {</td></tr><tr class="hit"> <td class="line">550</td><td class="hits">35</td><td class="source">    var itemPlayload = playload.substring(0, index);</td></tr><tr class="hit"> <td class="line">551</td><td class="hits">35</td><td class="source">    var items = this.get_result_items(data, itemPlayload, args) || [];</td></tr><tr class="hit"> <td class="line">552</td><td class="hits">35</td><td class="source">    for (var i = 0; i &lt; items.length; i++) {</td></tr><tr class="hit"> <td class="line">553</td><td class="hits">343</td><td class="source">      items[i] = this.format_result_item(items[i], itemPlayload, args);</td></tr><tr><td class="line">554</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">555</td><td class="hits">35</td><td class="source">    var result = {};</td></tr><tr class="hit"> <td class="line">556</td><td class="hits">35</td><td class="source">    result.items = items;</td></tr><tr><td class="line">557</td><td class="hits"></td><td class="source">    // try to get pagging cursor.</td></tr><tr class="hit"> <td class="line">558</td><td class="hits">35</td><td class="source">    result.cursor = this.get_pagging_cursor(data, itemPlayload, args);</td></tr><tr class="hit"> <td class="line">559</td><td class="hits">35</td><td class="source">    return result;</td></tr><tr><td class="line">560</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">561</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">562</td><td class="hits">31</td><td class="source">  var item = this.get_result_item(data, playload, args);</td></tr><tr class="hit"> <td class="line">563</td><td class="hits">31</td><td class="source">  return this.format_result_item(item, playload, args);</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">565</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">566</td><td class="hits">1</td><td class="source">TBase.prototype.format_result_item = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">567</td><td class="hits">374</td><td class="source">  var method = 'format_' + playload;</td></tr><tr class="hit"> <td class="line">568</td><td class="hits">374</td><td class="source">  return this[method](data, args);</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">570</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">571</td><td class="hits">1</td><td class="source">TBase.prototype.format_search_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">572</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">573</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">574</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">575</td><td class="hits">1</td><td class="source">TBase.prototype.format_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">576</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">577</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">578</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">579</td><td class="hits">1</td><td class="source">TBase.prototype.format_user = function (user, args) {</td></tr><tr class="miss"> <td class="line">580</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">581</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">582</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">583</td><td class="hits">1</td><td class="source">TBase.prototype.format_comment = function (comment, args) {</td></tr><tr class="miss"> <td class="line">584</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">585</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">586</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">587</td><td class="hits">1</td><td class="source">TBase.prototype.format_message = function (message, args) {</td></tr><tr class="miss"> <td class="line">588</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">589</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">590</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">591</td><td class="hits">1</td><td class="source">TBase.prototype.format_emotion = function (emotion, args) {</td></tr><tr class="miss"> <td class="line">592</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">593</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">594</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">595</td><td class="hits">1</td><td class="source">TBase.prototype.format_access_token = function (token) {</td></tr><tr class="hit"> <td class="line">596</td><td class="hits">2</td><td class="source">  return querystring.parse(token);</td></tr><tr><td class="line">597</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">598</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">599</td><td class="hits">1</td><td class="source">TBase.prototype.format_count = function (count, args) {</td></tr><tr class="miss"> <td class="line">600</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">601</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">602</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">603</td><td class="hits">1</td><td class="source">TBase.prototype.format_favorite = function (favorite, args) {</td></tr><tr class="miss"> <td class="line">604</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">605</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">606</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">607</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">608</td><td class="hits"></td><td class="source"> * Params converters</td></tr><tr><td class="line">609</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">610</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">611</td><td class="hits">1</td><td class="source">TBase.prototype.convert_cursor = function (cursor) {</td></tr><tr class="hit"> <td class="line">612</td><td class="hits">19</td><td class="source">  return cursor;</td></tr><tr><td class="line">613</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">614</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">615</td><td class="hits">1</td><td class="source">TBase.prototype.convert_status = function (status) {</td></tr><tr class="hit"> <td class="line">616</td><td class="hits">9</td><td class="source">  return status;</td></tr><tr><td class="line">617</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">618</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">619</td><td class="hits">1</td><td class="source">TBase.prototype.convert_comment = function (comment) {</td></tr><tr class="hit"> <td class="line">620</td><td class="hits">8</td><td class="source">  return comment;</td></tr><tr><td class="line">621</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">622</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">623</td><td class="hits">1</td><td class="source">TBase.prototype.convert_user = function (data) {</td></tr><tr class="hit"> <td class="line">624</td><td class="hits">4</td><td class="source">  return data;</td></tr><tr><td class="line">625</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">626</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">627</td><td class="hits">1</td><td class="source">TBase.prototype.convert_ids = function (ids) {</td></tr><tr class="hit"> <td class="line">628</td><td class="hits">2</td><td class="source">  return {ids: ids};</td></tr><tr><td class="line">629</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">630</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">631</td><td class="hits">1</td><td class="source">TBase.prototype.convert_favorite = function (id) {</td></tr><tr class="miss"> <td class="line">632</td><td class="hits">0</td><td class="source">  return {id: id};</td></tr><tr><td class="line">633</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">634</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">635</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">636</td><td class="hits"></td><td class="source"> * User</td></tr><tr><td class="line">637</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">638</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">639</td><td class="hits">1</td><td class="source">TBase.prototype.verify_credentials = function (user, callback) {</td></tr><tr class="hit"> <td class="line">640</td><td class="hits">2</td><td class="source">  var params = {</td></tr><tr><td class="line">641</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">642</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">643</td><td class="hits"></td><td class="source">    playload: 'user',</td></tr><tr><td class="line">644</td><td class="hits"></td><td class="source">    request_method: 'verify_credentials'</td></tr><tr><td class="line">645</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">646</td><td class="hits">2</td><td class="source">  var url = this.config.verify_credentials;</td></tr><tr class="hit"> <td class="line">647</td><td class="hits">2</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">648</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">649</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">650</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">651</td><td class="hits">1</td><td class="source">TBase.prototype.user_show = function (user, uid, screen_name, callback) {</td></tr><tr class="hit"> <td class="line">652</td><td class="hits">5</td><td class="source">  var data = {};</td></tr><tr class="hit"> <td class="line">653</td><td class="hits">5</td><td class="source">  if (uid) {</td></tr><tr class="hit"> <td class="line">654</td><td class="hits">5</td><td class="source">    data.uid = uid;</td></tr><tr><td class="line">655</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">656</td><td class="hits">5</td><td class="source">  if (screen_name) {</td></tr><tr class="hit"> <td class="line">657</td><td class="hits">1</td><td class="source">    data.screen_name = screen_name;</td></tr><tr class="hit"> <td class="line">658</td><td class="hits">1</td><td class="source">    delete data.uid; // only support one</td></tr><tr><td class="line">659</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">660</td><td class="hits">5</td><td class="source">  data = this.convert_user(data);</td></tr><tr class="hit"> <td class="line">661</td><td class="hits">5</td><td class="source">  var params = {</td></tr><tr><td class="line">662</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">663</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">664</td><td class="hits"></td><td class="source">    data: data,</td></tr><tr><td class="line">665</td><td class="hits"></td><td class="source">    playload: 'user',</td></tr><tr><td class="line">666</td><td class="hits"></td><td class="source">    request_method: 'user_show'</td></tr><tr><td class="line">667</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">668</td><td class="hits">5</td><td class="source">  var url = this.config.user_show;</td></tr><tr class="hit"> <td class="line">669</td><td class="hits">5</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">670</td><td class="hits">5</td><td class="source">  return this;</td></tr><tr><td class="line">671</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">672</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">673</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">674</td><td class="hits"></td><td class="source"> * Status APIs</td></tr><tr><td class="line">675</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">676</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">677</td><td class="hits">1</td><td class="source">TBase.prototype.update = function (user, status, callback) {</td></tr><tr class="hit"> <td class="line">678</td><td class="hits">8</td><td class="source">  status = this.convert_status(status);</td></tr><tr class="hit"> <td class="line">679</td><td class="hits">8</td><td class="source">  var params = {</td></tr><tr><td class="line">680</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">681</td><td class="hits"></td><td class="source">    playload: 'status',</td></tr><tr><td class="line">682</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">683</td><td class="hits"></td><td class="source">    data: status,</td></tr><tr><td class="line">684</td><td class="hits"></td><td class="source">    request_method: 'update'</td></tr><tr><td class="line">685</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">686</td><td class="hits">8</td><td class="source">  var url = this.config.update;</td></tr><tr class="hit"> <td class="line">687</td><td class="hits">8</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">688</td><td class="hits">8</td><td class="source">  return this;</td></tr><tr><td class="line">689</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">690</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">691</td><td class="hits">1</td><td class="source">TBase.prototype.upload = function (user, status, pic, callback) {</td></tr><tr class="hit"> <td class="line">692</td><td class="hits">6</td><td class="source">  status = this.convert_status(status);</td></tr><tr class="hit"> <td class="line">693</td><td class="hits">6</td><td class="source">  pic.name = pic.name || 'node-weibo-upload-image.jpg';</td></tr><tr class="hit"> <td class="line">694</td><td class="hits">6</td><td class="source">  if (!pic.content_type) {</td></tr><tr class="hit"> <td class="line">695</td><td class="hits">6</td><td class="source">    pic.content_type = utils.mimeLookup(pic.name);</td></tr><tr><td class="line">696</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">697</td><td class="hits">6</td><td class="source">  if (Buffer.isBuffer(pic.data)) {</td></tr><tr class="miss"> <td class="line">698</td><td class="hits">0</td><td class="source">    this._upload(user, status, pic, callback);</td></tr><tr class="miss"> <td class="line">699</td><td class="hits">0</td><td class="source">    return this;</td></tr><tr><td class="line">700</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">701</td><td class="hits">6</td><td class="source">  var buffers = [];</td></tr><tr class="hit"> <td class="line">702</td><td class="hits">6</td><td class="source">  var size = 0;</td></tr><tr class="hit"> <td class="line">703</td><td class="hits">6</td><td class="source">  var self = this;</td></tr><tr class="hit"> <td class="line">704</td><td class="hits">6</td><td class="source">  pic.data.on('data', function (chunk) {</td></tr><tr class="hit"> <td class="line">705</td><td class="hits">6</td><td class="source">    size += chunk.length;</td></tr><tr class="hit"> <td class="line">706</td><td class="hits">6</td><td class="source">    buffers.push(chunk);</td></tr><tr><td class="line">707</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">708</td><td class="hits">6</td><td class="source">  pic.data.once('end', function () {</td></tr><tr class="hit"> <td class="line">709</td><td class="hits">6</td><td class="source">    pic.data = Buffer.concat(buffers, size);</td></tr><tr class="hit"> <td class="line">710</td><td class="hits">6</td><td class="source">    self._upload(user, status, pic, callback);</td></tr><tr><td class="line">711</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">712</td><td class="hits">6</td><td class="source">  pic.data.once('error', function (err) {</td></tr><tr class="miss"> <td class="line">713</td><td class="hits">0</td><td class="source">    callback(err);</td></tr><tr><td class="line">714</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">715</td><td class="hits">6</td><td class="source">  return this;</td></tr><tr><td class="line">716</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">717</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">718</td><td class="hits">1</td><td class="source">TBase.prototype._upload = function (user, data, pic, callback) {</td></tr><tr class="hit"> <td class="line">719</td><td class="hits">6</td><td class="source">  var auth_args = {</td></tr><tr><td class="line">720</td><td class="hits"></td><td class="source">    type: 'post',</td></tr><tr><td class="line">721</td><td class="hits"></td><td class="source">    data: {},</td></tr><tr><td class="line">722</td><td class="hits"></td><td class="source">    headers: {}</td></tr><tr><td class="line">723</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">724</td><td class="hits">6</td><td class="source">  var pic_field = this.config.pic_field || 'pic';  </td></tr><tr class="hit"> <td class="line">725</td><td class="hits">6</td><td class="source">  var boundary = 'boundary' + Date.now();</td></tr><tr><td class="line">726</td><td class="hits"></td><td class="source">  // this.format_upload_params(user, data, pic , boundary);</td></tr><tr class="hit"> <td class="line">727</td><td class="hits">6</td><td class="source">  var dashdash = '--';</td></tr><tr class="hit"> <td class="line">728</td><td class="hits">6</td><td class="source">  var crlf = '\r\n';</td></tr><tr><td class="line">729</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">730</td><td class="hits"></td><td class="source">  /* RFC2388 */</td></tr><tr class="hit"> <td class="line">731</td><td class="hits">6</td><td class="source">  var builder = '';</td></tr><tr><td class="line">732</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">733</td><td class="hits">6</td><td class="source">  builder += dashdash;</td></tr><tr class="hit"> <td class="line">734</td><td class="hits">6</td><td class="source">  builder += boundary;</td></tr><tr class="hit"> <td class="line">735</td><td class="hits">6</td><td class="source">  builder += crlf;</td></tr><tr><td class="line">736</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">737</td><td class="hits">6</td><td class="source">  var key;</td></tr><tr class="hit"> <td class="line">738</td><td class="hits">6</td><td class="source">  for (key in data) {</td></tr><tr class="hit"> <td class="line">739</td><td class="hits">10</td><td class="source">    var value = this.url_encode(data[key]);</td></tr><tr class="hit"> <td class="line">740</td><td class="hits">10</td><td class="source">    auth_args.data[key] = value;</td></tr><tr><td class="line">741</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">742</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">743</td><td class="hits">6</td><td class="source">  var api = this.config.host;</td></tr><tr class="hit"> <td class="line">744</td><td class="hits">6</td><td class="source">  var url = api + this.config.upload + this.config.result_format;</td></tr><tr><td class="line">745</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">746</td><td class="hits"></td><td class="source">  // &#232;&#174;&#190;&#231;&#189;&#174;&#232;&#174;&#164;&#232;&#175;&#129;&#229;&#164;&#180;&#233;&#131;&#168;</td></tr><tr class="hit"> <td class="line">747</td><td class="hits">6</td><td class="source">  this.apply_auth(url, auth_args, user); </td></tr><tr><td class="line">748</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">749</td><td class="hits">6</td><td class="source">  for (key in auth_args.data) {</td></tr><tr><td class="line">750</td><td class="hits"></td><td class="source">    /* Generate headers. key */            </td></tr><tr class="hit"> <td class="line">751</td><td class="hits">34</td><td class="source">    builder += 'Content-Disposition: form-data; name=&quot;' + key + '&quot;';</td></tr><tr class="hit"> <td class="line">752</td><td class="hits">34</td><td class="source">    builder += crlf;</td></tr><tr class="hit"> <td class="line">753</td><td class="hits">34</td><td class="source">    builder += crlf; </td></tr><tr><td class="line">754</td><td class="hits"></td><td class="source">     /* Append form data. */</td></tr><tr class="hit"> <td class="line">755</td><td class="hits">34</td><td class="source">    builder += auth_args.data[key];</td></tr><tr class="hit"> <td class="line">756</td><td class="hits">34</td><td class="source">    builder += crlf;</td></tr><tr><td class="line">757</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">758</td><td class="hits"></td><td class="source">    /* Write boundary. */</td></tr><tr class="hit"> <td class="line">759</td><td class="hits">34</td><td class="source">    builder += dashdash;</td></tr><tr class="hit"> <td class="line">760</td><td class="hits">34</td><td class="source">    builder += boundary;</td></tr><tr class="hit"> <td class="line">761</td><td class="hits">34</td><td class="source">    builder += crlf;</td></tr><tr><td class="line">762</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">763</td><td class="hits"></td><td class="source">  /* Generate headers. [PIC] */            </td></tr><tr class="hit"> <td class="line">764</td><td class="hits">6</td><td class="source">  builder += 'Content-Disposition: form-data; name=&quot;' + pic_field + '&quot;';</td></tr><tr><td class="line">765</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">766</td><td class="hits">6</td><td class="source">  builder += '; filename=&quot;' + this.url_encode(pic.name) + '&quot;';</td></tr><tr class="hit"> <td class="line">767</td><td class="hits">6</td><td class="source">  builder += crlf;</td></tr><tr><td class="line">768</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">769</td><td class="hits">6</td><td class="source">  builder += 'Content-Type: ' + pic.content_type + ';'; </td></tr><tr class="hit"> <td class="line">770</td><td class="hits">6</td><td class="source">  builder += crlf;</td></tr><tr class="hit"> <td class="line">771</td><td class="hits">6</td><td class="source">  builder += crlf;</td></tr><tr><td class="line">772</td><td class="hits"></td><td class="source">  </td></tr><tr class="hit"> <td class="line">773</td><td class="hits">6</td><td class="source">  var endstr = crlf + dashdash + boundary + dashdash +  crlf;</td></tr><tr class="hit"> <td class="line">774</td><td class="hits">6</td><td class="source">  var builderLength = Buffer.byteLength(builder);</td></tr><tr class="hit"> <td class="line">775</td><td class="hits">6</td><td class="source">  var size = builderLength + pic.data.length + endstr.length;</td></tr><tr class="hit"> <td class="line">776</td><td class="hits">6</td><td class="source">  var buffer = new Buffer(size);</td></tr><tr class="hit"> <td class="line">777</td><td class="hits">6</td><td class="source">  var offset = 0;</td></tr><tr class="hit"> <td class="line">778</td><td class="hits">6</td><td class="source">  buffer.write(builder);</td></tr><tr class="hit"> <td class="line">779</td><td class="hits">6</td><td class="source">  offset += builderLength ;</td></tr><tr class="hit"> <td class="line">780</td><td class="hits">6</td><td class="source">  pic.data.copy(buffer, offset);</td></tr><tr class="hit"> <td class="line">781</td><td class="hits">6</td><td class="source">  offset += pic.data.length;</td></tr><tr class="hit"> <td class="line">782</td><td class="hits">6</td><td class="source">  buffer.write(endstr, offset);</td></tr><tr><td class="line">783</td><td class="hits"></td><td class="source">  // if (typeof BlobBuilder === 'undefined') {</td></tr><tr><td class="line">784</td><td class="hits"></td><td class="source">  // } </td></tr><tr><td class="line">785</td><td class="hits"></td><td class="source">  // else {</td></tr><tr><td class="line">786</td><td class="hits"></td><td class="source">  //   buffer = new BlobBuilder(); //NOTE WebKitBlogBuilder</td></tr><tr><td class="line">787</td><td class="hits"></td><td class="source">  //   buffer.append(builder);</td></tr><tr><td class="line">788</td><td class="hits"></td><td class="source">  //   buffer.append(pic);</td></tr><tr><td class="line">789</td><td class="hits"></td><td class="source">  //   buffer.append(endstr);</td></tr><tr><td class="line">790</td><td class="hits"></td><td class="source">  //   buffer = buffer.getBlob();</td></tr><tr><td class="line">791</td><td class="hits"></td><td class="source">  // }</td></tr><tr class="hit"> <td class="line">792</td><td class="hits">6</td><td class="source">  auth_args.headers['Content-Type'] = 'multipart/form-data;boundary=' + boundary;</td></tr><tr class="hit"> <td class="line">793</td><td class="hits">6</td><td class="source">  var params = {</td></tr><tr><td class="line">794</td><td class="hits"></td><td class="source">    type: 'POST', </td></tr><tr><td class="line">795</td><td class="hits"></td><td class="source">    playload: 'status', </td></tr><tr><td class="line">796</td><td class="hits"></td><td class="source">    content: buffer, </td></tr><tr><td class="line">797</td><td class="hits"></td><td class="source">    headers: auth_args.headers,</td></tr><tr><td class="line">798</td><td class="hits"></td><td class="source">    request_method: 'upload'</td></tr><tr><td class="line">799</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">800</td><td class="hits">6</td><td class="source">  this.request(url, params, callback);</td></tr><tr class="hit"> <td class="line">801</td><td class="hits">6</td><td class="source">  return this;</td></tr><tr><td class="line">802</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">803</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">804</td><td class="hits">1</td><td class="source">TBase.prototype.repost = function (user, id, status, callback) {</td></tr><tr class="hit"> <td class="line">805</td><td class="hits">4</td><td class="source">  status.id = id;</td></tr><tr class="hit"> <td class="line">806</td><td class="hits">4</td><td class="source">  status = this.convert_status(status);</td></tr><tr class="hit"> <td class="line">807</td><td class="hits">4</td><td class="source">  var params = {</td></tr><tr><td class="line">808</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">809</td><td class="hits"></td><td class="source">    playload: 'status',</td></tr><tr><td class="line">810</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">811</td><td class="hits"></td><td class="source">    data: status,</td></tr><tr><td class="line">812</td><td class="hits"></td><td class="source">    request_method: 'repost'</td></tr><tr><td class="line">813</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">814</td><td class="hits">4</td><td class="source">  var url = this.config.repost;</td></tr><tr class="hit"> <td class="line">815</td><td class="hits">4</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">816</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">817</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">818</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">819</td><td class="hits">1</td><td class="source">TBase.prototype.destroy = function (user, id, callback) {</td></tr><tr class="hit"> <td class="line">820</td><td class="hits">6</td><td class="source">  var params = {</td></tr><tr><td class="line">821</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">822</td><td class="hits"></td><td class="source">    playload: 'status',</td></tr><tr><td class="line">823</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">824</td><td class="hits"></td><td class="source">    data: {id: id},</td></tr><tr><td class="line">825</td><td class="hits"></td><td class="source">    request_method: 'destroy'</td></tr><tr><td class="line">826</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">827</td><td class="hits">6</td><td class="source">  var url = this.config.destroy;</td></tr><tr class="hit"> <td class="line">828</td><td class="hits">6</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">829</td><td class="hits">6</td><td class="source">  return this;</td></tr><tr><td class="line">830</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">831</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">832</td><td class="hits">1</td><td class="source">TBase.prototype.show = function (user, id, callback) {</td></tr><tr class="hit"> <td class="line">833</td><td class="hits">2</td><td class="source">  var params = {</td></tr><tr><td class="line">834</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">835</td><td class="hits"></td><td class="source">    playload: 'status',</td></tr><tr><td class="line">836</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">837</td><td class="hits"></td><td class="source">    data: {</td></tr><tr><td class="line">838</td><td class="hits"></td><td class="source">      id: id</td></tr><tr><td class="line">839</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">840</td><td class="hits"></td><td class="source">    request_method: 'show'</td></tr><tr><td class="line">841</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">842</td><td class="hits">2</td><td class="source">  var url = this.config.show;</td></tr><tr class="hit"> <td class="line">843</td><td class="hits">2</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">844</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">845</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">846</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">847</td><td class="hits">1</td><td class="source">TBase.prototype.count = function (user, ids, callback) {</td></tr><tr class="hit"> <td class="line">848</td><td class="hits">4</td><td class="source">  var data = this.convert_ids(ids);</td></tr><tr class="hit"> <td class="line">849</td><td class="hits">4</td><td class="source">  var params = {</td></tr><tr><td class="line">850</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">851</td><td class="hits"></td><td class="source">    playload: 'count[]',</td></tr><tr><td class="line">852</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">853</td><td class="hits"></td><td class="source">    data: data,</td></tr><tr><td class="line">854</td><td class="hits"></td><td class="source">    request_method: 'count'</td></tr><tr><td class="line">855</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">856</td><td class="hits">4</td><td class="source">  var url = this.config.count;</td></tr><tr class="hit"> <td class="line">857</td><td class="hits">4</td><td class="source">  this.send_request(url, params, function (err, result) {</td></tr><tr class="hit"> <td class="line">858</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="hit"> <td class="line">859</td><td class="hits">2</td><td class="source">      return callback(err);</td></tr><tr><td class="line">860</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">861</td><td class="hits">2</td><td class="source">    callback(null, result.items);</td></tr><tr><td class="line">862</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">863</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">864</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">865</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">866</td><td class="hits">1</td><td class="source">TBase.prototype.home_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">867</td><td class="hits">4</td><td class="source">  return this._timeline('home_timeline', user, cursor, callback);</td></tr><tr><td class="line">868</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">869</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">870</td><td class="hits">1</td><td class="source">TBase.prototype.user_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">871</td><td class="hits">4</td><td class="source">  return this._timeline('user_timeline', user, cursor, callback);</td></tr><tr><td class="line">872</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">873</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">874</td><td class="hits">1</td><td class="source">TBase.prototype.public_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">875</td><td class="hits">4</td><td class="source">  return this._timeline('public_timeline', user, cursor, callback);</td></tr><tr><td class="line">876</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">877</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">878</td><td class="hits">1</td><td class="source">TBase.prototype.mentions = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">879</td><td class="hits">4</td><td class="source">  return this._timeline('mentions', user, cursor, callback);</td></tr><tr><td class="line">880</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">881</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">882</td><td class="hits">1</td><td class="source">TBase.prototype.repost_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">883</td><td class="hits">2</td><td class="source">  return this._timeline('repost_timeline', user, cursor, callback);</td></tr><tr><td class="line">884</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">885</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">886</td><td class="hits">1</td><td class="source">TBase.prototype.search = function (user, query, cursor, callback) {</td></tr><tr class="hit"> <td class="line">887</td><td class="hits">1</td><td class="source">  cursor = cursor || {};</td></tr><tr class="hit"> <td class="line">888</td><td class="hits">1</td><td class="source">  cursor.count = cursor.count || 20;</td></tr><tr class="hit"> <td class="line">889</td><td class="hits">1</td><td class="source">  cursor = this.convert_cursor(cursor);</td></tr><tr class="hit"> <td class="line">890</td><td class="hits">1</td><td class="source">  query = utils.extend(query, cursor);</td></tr><tr class="hit"> <td class="line">891</td><td class="hits">1</td><td class="source">  var params = {</td></tr><tr><td class="line">892</td><td class="hits"></td><td class="source">    type: 'GET',</td></tr><tr><td class="line">893</td><td class="hits"></td><td class="source">    playload: 'status[]',</td></tr><tr><td class="line">894</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">895</td><td class="hits"></td><td class="source">    data: query,</td></tr><tr><td class="line">896</td><td class="hits"></td><td class="source">    request_method: 'search'</td></tr><tr><td class="line">897</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">898</td><td class="hits">1</td><td class="source">  var url = this.config.search;</td></tr><tr class="hit"> <td class="line">899</td><td class="hits">1</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">900</td><td class="hits">1</td><td class="source">  return this;</td></tr><tr><td class="line">901</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">902</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">903</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">904</td><td class="hits"></td><td class="source"> * Favorite</td></tr><tr><td class="line">905</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">906</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">907</td><td class="hits">1</td><td class="source">TBase.prototype.favorites = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">908</td><td class="hits">2</td><td class="source">  return this._timeline('favorites', user, cursor, callback, 'favorite[]');</td></tr><tr><td class="line">909</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">910</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">911</td><td class="hits">1</td><td class="source">TBase.prototype.favorite_request = function (type, name, user, id, callback) {</td></tr><tr class="miss"> <td class="line">912</td><td class="hits">0</td><td class="source">  var data = this.convert_favorite(id);</td></tr><tr class="miss"> <td class="line">913</td><td class="hits">0</td><td class="source">  var params = {</td></tr><tr><td class="line">914</td><td class="hits"></td><td class="source">    type: type,</td></tr><tr><td class="line">915</td><td class="hits"></td><td class="source">    playload: 'favorite',</td></tr><tr><td class="line">916</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">917</td><td class="hits"></td><td class="source">    data: data,</td></tr><tr><td class="line">918</td><td class="hits"></td><td class="source">    request_method: name</td></tr><tr><td class="line">919</td><td class="hits"></td><td class="source">  };</td></tr><tr class="miss"> <td class="line">920</td><td class="hits">0</td><td class="source">  var url = this.config[name];</td></tr><tr class="miss"> <td class="line">921</td><td class="hits">0</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="miss"> <td class="line">922</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">923</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">924</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">925</td><td class="hits">1</td><td class="source">TBase.prototype.favorite_show = function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">926</td><td class="hits">0</td><td class="source">  return this.favorite_request('GET', 'favorite_show', user, id, callback);</td></tr><tr><td class="line">927</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">928</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">929</td><td class="hits">1</td><td class="source">TBase.prototype.favorite_create = function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">930</td><td class="hits">0</td><td class="source">  return this.favorite_request('POST', 'favorite_create', user, id, callback);</td></tr><tr><td class="line">931</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">932</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">933</td><td class="hits">1</td><td class="source">TBase.prototype.favorite_destroy = function (user, id, callback) {</td></tr><tr class="miss"> <td class="line">934</td><td class="hits">0</td><td class="source">  return this.favorite_request('POST', 'favorite_destroy', user, id, callback);</td></tr><tr><td class="line">935</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">936</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">937</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">938</td><td class="hits"></td><td class="source"> * Comment</td></tr><tr><td class="line">939</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">940</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">941</td><td class="hits">1</td><td class="source">TBase.prototype.comments = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">942</td><td class="hits">2</td><td class="source">  return this._timeline('comments', user, cursor, callback, 'comment[]');</td></tr><tr><td class="line">943</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">944</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">945</td><td class="hits">1</td><td class="source">TBase.prototype.comments_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">946</td><td class="hits">4</td><td class="source">  return this._timeline('comments_timeline', user, cursor, callback, 'comment[]');</td></tr><tr><td class="line">947</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">948</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">949</td><td class="hits">1</td><td class="source">TBase.prototype.comments_mentions = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">950</td><td class="hits">2</td><td class="source">  return this._timeline('comments_mentions', user, cursor, callback, 'comment[]');</td></tr><tr><td class="line">951</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">952</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">953</td><td class="hits">1</td><td class="source">TBase.prototype.comments_to_me = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">954</td><td class="hits">2</td><td class="source">  return this._timeline('comments_to_me', user, cursor, callback, 'comment[]');</td></tr><tr><td class="line">955</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">956</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">957</td><td class="hits">1</td><td class="source">TBase.prototype.comments_by_me = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">958</td><td class="hits">2</td><td class="source">  return this._timeline('comments_by_me', user, cursor, callback, 'comment[]');</td></tr><tr><td class="line">959</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">960</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">961</td><td class="hits">1</td><td class="source">TBase.prototype.comment_create = function (user, id, comment, callback) {</td></tr><tr class="hit"> <td class="line">962</td><td class="hits">7</td><td class="source">  comment.id = id;</td></tr><tr class="hit"> <td class="line">963</td><td class="hits">7</td><td class="source">  comment = this.convert_comment(comment);</td></tr><tr class="hit"> <td class="line">964</td><td class="hits">7</td><td class="source">  var params = {</td></tr><tr><td class="line">965</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">966</td><td class="hits"></td><td class="source">    playload: 'comment',</td></tr><tr><td class="line">967</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">968</td><td class="hits"></td><td class="source">    data: comment,</td></tr><tr><td class="line">969</td><td class="hits"></td><td class="source">    request_method: 'comment_create'</td></tr><tr><td class="line">970</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">971</td><td class="hits">7</td><td class="source">  var url = this.config.comment_create;</td></tr><tr class="hit"> <td class="line">972</td><td class="hits">7</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">973</td><td class="hits">7</td><td class="source">  return this;</td></tr><tr><td class="line">974</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">975</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">976</td><td class="hits">1</td><td class="source">TBase.prototype.comment_reply = function (user, cid, id, comment, callback) {</td></tr><tr class="hit"> <td class="line">977</td><td class="hits">6</td><td class="source">  comment.id = id;</td></tr><tr class="hit"> <td class="line">978</td><td class="hits">6</td><td class="source">  comment.cid = cid;</td></tr><tr class="hit"> <td class="line">979</td><td class="hits">6</td><td class="source">  comment = this.convert_comment(comment);</td></tr><tr class="hit"> <td class="line">980</td><td class="hits">6</td><td class="source">  var params = {</td></tr><tr><td class="line">981</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">982</td><td class="hits"></td><td class="source">    playload: 'comment',</td></tr><tr><td class="line">983</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">984</td><td class="hits"></td><td class="source">    data: comment,</td></tr><tr><td class="line">985</td><td class="hits"></td><td class="source">    request_method: 'comment_reply'</td></tr><tr><td class="line">986</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">987</td><td class="hits">6</td><td class="source">  var url = this.config.comment_reply;</td></tr><tr class="hit"> <td class="line">988</td><td class="hits">6</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">989</td><td class="hits">6</td><td class="source">  return this;</td></tr><tr><td class="line">990</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">991</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">992</td><td class="hits">1</td><td class="source">TBase.prototype.comment_destroy = function (user, cid, callback) {</td></tr><tr class="hit"> <td class="line">993</td><td class="hits">1</td><td class="source">  var comment = {cid: cid};</td></tr><tr class="hit"> <td class="line">994</td><td class="hits">1</td><td class="source">  comment = this.convert_comment(comment);</td></tr><tr class="hit"> <td class="line">995</td><td class="hits">1</td><td class="source">  var params = {</td></tr><tr><td class="line">996</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">997</td><td class="hits"></td><td class="source">    playload: 'comment',</td></tr><tr><td class="line">998</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">999</td><td class="hits"></td><td class="source">    data: comment,</td></tr><tr><td class="line">1000</td><td class="hits"></td><td class="source">    request_method: 'comment_destroy'</td></tr><tr><td class="line">1001</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">1002</td><td class="hits">1</td><td class="source">  var url = this.config.comment_destroy;</td></tr><tr class="hit"> <td class="line">1003</td><td class="hits">1</td><td class="source">  this.send_request(url, params, callback);</td></tr><tr class="hit"> <td class="line">1004</td><td class="hits">1</td><td class="source">  return this;</td></tr><tr><td class="line">1005</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">1006</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="oauth.js">oauth.js</h2><div id="stats" class="medium"><div class="percentage">63%</div><div class="sloc">221</div><div class="hits">140</div><div class="misses">81</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * Copyright 2008 Netflix, Inc.</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> * you may not use this file except in compliance with the License.</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> * You may obtain a copy of the License at</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> *     http://www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Unless required by applicable law or agreed to in writing, software</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source"> * See the License for the specific language governing permissions and</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source"> * limitations under the License.</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">// Here's some JavaScript software that's useful for implementing OAuth.</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">// The HMAC-SHA1 signature method calls b64_hmac_sha1, defined by</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">// http://pajhome.org.uk/crypt/md5/sha1.js</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">/* An OAuth message is represented as an object like this:</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">   {method: &quot;GET&quot;, action: &quot;http://server.com/path&quot;, parameters: ...}</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">   The parameters may be either a map {name: value, name2: value2}</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">   or an Array of name-value pairs [[name, value], [name2, value2]].</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">   The latter representation is more powerful: it supports parameters</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">   in a specific sequence, or several parameters with the same name;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">   for example [[&quot;a&quot;, 1], [&quot;b&quot;, 2], [&quot;a&quot;, 3]].</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">   Parameter names and values are NOT percent-encoded in an object.</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">   They must be encoded before transmission and decoded after reception.</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">   For example, this message object:</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">   {method: &quot;GET&quot;, action: &quot;http://server/path&quot;, parameters: {p: &quot;x y&quot;}}</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">   ... can be transmitted as an HTTP request that begins:</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">   GET /path?p=x%20y HTTP/1.0</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">   (This isn't a valid OAuth request, since it lacks a signature etc.)</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">   Note that the object &quot;x y&quot; is transmitted as x%20y.  To encode</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">   parameters, you can call OAuth.addToURL, OAuth.formEncode or</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">   OAuth.getAuthorization.</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">   This message object model harmonizes with the browser object model for</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">   input elements of an form, whose value property isn't percent encoded.</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">   The browser encodes each value before transmitting it. For example,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">   see consumer.setInputs in example/consumer.js.</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">42</td><td class="hits">1</td><td class="source">(function () {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">44</td><td class="hits">1</td><td class="source">var utils;</td></tr><tr class="hit"> <td class="line">45</td><td class="hits">1</td><td class="source">if (typeof require !== 'undefined') {</td></tr><tr class="hit"> <td class="line">46</td><td class="hits">1</td><td class="source">  utils = require('./utils');</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="miss"> <td class="line">48</td><td class="hits">0</td><td class="source">  utils = weibo.utils;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">51</td><td class="hits">1</td><td class="source">var OAuth = {};</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">53</td><td class="hits">1</td><td class="source">OAuth.setProperties = function setProperties(into, from) {</td></tr><tr class="hit"> <td class="line">54</td><td class="hits">3</td><td class="source">  if (into &amp;&amp; from) {</td></tr><tr class="hit"> <td class="line">55</td><td class="hits">3</td><td class="source">    for (var key in from) {</td></tr><tr class="hit"> <td class="line">56</td><td class="hits">24</td><td class="source">      into[key] = from[key];</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">59</td><td class="hits">3</td><td class="source">  return into;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">// utility functions</td></tr><tr class="hit"> <td class="line">63</td><td class="hits">1</td><td class="source">OAuth.setProperties(OAuth, {</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  percentEncode: function percentEncode(s) {</td></tr><tr class="hit"> <td class="line">65</td><td class="hits">980</td><td class="source">    if (!s) {</td></tr><tr class="hit"> <td class="line">66</td><td class="hits">6</td><td class="source">      return &quot;&quot;;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">68</td><td class="hits">974</td><td class="source">    if (s instanceof Array) {</td></tr><tr class="miss"> <td class="line">69</td><td class="hits">0</td><td class="source">      var e = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">70</td><td class="hits">0</td><td class="source">      for (var i = 0; i &lt; s.length; ++s) {</td></tr><tr class="miss"> <td class="line">71</td><td class="hits">0</td><td class="source">        if (e) {</td></tr><tr class="miss"> <td class="line">72</td><td class="hits">0</td><td class="source">          e += '&amp;';</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">        }</td></tr><tr class="miss"> <td class="line">74</td><td class="hits">0</td><td class="source">        e += percentEncode(s[i]);</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">76</td><td class="hits">0</td><td class="source">      return e;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">78</td><td class="hits">974</td><td class="source">    s = encodeURIComponent(s);</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">    // Now replace the values which encodeURIComponent doesn't do</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    // encodeURIComponent ignores: - _ . ! ~ * ' ( )</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    // OAuth dictates the only ones you can ignore are: - _ . ~</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    // Source: http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Functions:encodeURIComponent</td></tr><tr class="hit"> <td class="line">83</td><td class="hits">974</td><td class="source">    s = s.replace(/\!/g, &quot;%21&quot;);</td></tr><tr class="hit"> <td class="line">84</td><td class="hits">974</td><td class="source">    s = s.replace(/\*/g, &quot;%2A&quot;);</td></tr><tr class="hit"> <td class="line">85</td><td class="hits">974</td><td class="source">    s = s.replace(/\'/g, &quot;%27&quot;);</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">    // s = s.replace(&quot;(&quot;, &quot;%28&quot;, &quot;g&quot;);</td></tr><tr class="hit"> <td class="line">87</td><td class="hits">974</td><td class="source">    s = s.replace(/\(/g, &quot;%28&quot;);</td></tr><tr class="hit"> <td class="line">88</td><td class="hits">974</td><td class="source">    s = s.replace(/\)/g, &quot;%29&quot;);</td></tr><tr class="hit"> <td class="line">89</td><td class="hits">974</td><td class="source">    return s;</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">  decodePercent: decodeURIComponent,</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  /** Convert the given parameters to an Array of name-value pairs. */</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  getParameterList: function getParameterList(parameters) {</td></tr><tr class="hit"> <td class="line">94</td><td class="hits">86</td><td class="source">    if (!parameters) {</td></tr><tr class="miss"> <td class="line">95</td><td class="hits">0</td><td class="source">      return [];</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">97</td><td class="hits">86</td><td class="source">    if (typeof parameters !== &quot;object&quot;) {</td></tr><tr class="miss"> <td class="line">98</td><td class="hits">0</td><td class="source">      return this.decodeForm(parameters + &quot;&quot;);</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">86</td><td class="source">    if (parameters instanceof Array) {</td></tr><tr class="hit"> <td class="line">101</td><td class="hits">40</td><td class="source">      return parameters;</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">103</td><td class="hits">46</td><td class="source">    var list = [];</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">46</td><td class="source">    for (var p in parameters) {</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">390</td><td class="source">      list.push([ p, parameters[p] ]);</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">107</td><td class="hits">46</td><td class="source">    return list;</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  /** Convert the given parameters to a map from name to value. */</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  getParameterMap: function getParameterMap(parameters) {</td></tr><tr class="hit"> <td class="line">111</td><td class="hits">200</td><td class="source">    if (!parameters) {</td></tr><tr class="miss"> <td class="line">112</td><td class="hits">0</td><td class="source">      return {};</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">114</td><td class="hits">200</td><td class="source">    if (typeof parameters !== &quot;object&quot;) {</td></tr><tr class="miss"> <td class="line">115</td><td class="hits">0</td><td class="source">      return this.getParameterMap(this.decodeForm(parameters + &quot;&quot;));</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">117</td><td class="hits">200</td><td class="source">    if (parameters instanceof Array) {</td></tr><tr class="miss"> <td class="line">118</td><td class="hits">0</td><td class="source">      var map = {};</td></tr><tr class="miss"> <td class="line">119</td><td class="hits">0</td><td class="source">      for (var p = 0; p &lt; parameters.length; ++p) {</td></tr><tr class="miss"> <td class="line">120</td><td class="hits">0</td><td class="source">        var key = parameters[p][0];</td></tr><tr class="miss"> <td class="line">121</td><td class="hits">0</td><td class="source">        if (map[key] === undefined) { // first value wins</td></tr><tr class="miss"> <td class="line">122</td><td class="hits">0</td><td class="source">          map[key] = parameters[p][1];</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">125</td><td class="hits">0</td><td class="source">      return map;</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">127</td><td class="hits">200</td><td class="source">    return parameters;</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">  formEncode: function formEncode(parameters) {</td></tr><tr class="hit"> <td class="line">130</td><td class="hits">46</td><td class="source">    var form = &quot;&quot;;</td></tr><tr class="hit"> <td class="line">131</td><td class="hits">46</td><td class="source">    var list = OAuth.getParameterList(parameters);</td></tr><tr class="hit"> <td class="line">132</td><td class="hits">46</td><td class="source">    for (var p = 0, l = list.length; p &lt; l; p++) {</td></tr><tr class="hit"> <td class="line">133</td><td class="hits">390</td><td class="source">      var pair = list[p];</td></tr><tr class="hit"> <td class="line">134</td><td class="hits">390</td><td class="source">      var value = pair[1];</td></tr><tr class="hit"> <td class="line">135</td><td class="hits">390</td><td class="source">      if (!value) {</td></tr><tr class="hit"> <td class="line">136</td><td class="hits">4</td><td class="source">        value = &quot;&quot;;</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">138</td><td class="hits">390</td><td class="source">      if (form) {</td></tr><tr class="hit"> <td class="line">139</td><td class="hits">344</td><td class="source">        form += '&amp;';</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">141</td><td class="hits">390</td><td class="source">      form += OAuth.percentEncode(pair[0]) + '=' + OAuth.percentEncode(value);</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">143</td><td class="hits">46</td><td class="source">    return form;</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">  decodeForm: function decodeForm(form) {</td></tr><tr class="miss"> <td class="line">146</td><td class="hits">0</td><td class="source">    var list = [];</td></tr><tr class="miss"> <td class="line">147</td><td class="hits">0</td><td class="source">    var nvps = form.split('&amp;');</td></tr><tr class="miss"> <td class="line">148</td><td class="hits">0</td><td class="source">    for (var n = 0; n &lt; nvps.length; ++n) {</td></tr><tr class="miss"> <td class="line">149</td><td class="hits">0</td><td class="source">      var nvp = nvps[n];</td></tr><tr class="miss"> <td class="line">150</td><td class="hits">0</td><td class="source">      if (!nvp) {</td></tr><tr class="miss"> <td class="line">151</td><td class="hits">0</td><td class="source">        continue;</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">153</td><td class="hits">0</td><td class="source">      var equals = nvp.indexOf('=');</td></tr><tr class="miss"> <td class="line">154</td><td class="hits">0</td><td class="source">      var name;</td></tr><tr class="miss"> <td class="line">155</td><td class="hits">0</td><td class="source">      var value;</td></tr><tr class="miss"> <td class="line">156</td><td class="hits">0</td><td class="source">      if (equals &lt; 0) {</td></tr><tr class="miss"> <td class="line">157</td><td class="hits">0</td><td class="source">        name = OAuth.decodePercent(nvp);</td></tr><tr class="miss"> <td class="line">158</td><td class="hits">0</td><td class="source">        value = null;</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="miss"> <td class="line">160</td><td class="hits">0</td><td class="source">        name = OAuth.decodePercent(nvp.substring(0, equals));</td></tr><tr class="miss"> <td class="line">161</td><td class="hits">0</td><td class="source">        value = OAuth.decodePercent(nvp.substring(equals + 1));</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">163</td><td class="hits">0</td><td class="source">      list.push([name, value]);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">165</td><td class="hits">0</td><td class="source">    return list;</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">  setParameter: function setParameter(message, name, value) {</td></tr><tr class="hit"> <td class="line">168</td><td class="hits">160</td><td class="source">    var parameters = message.parameters;</td></tr><tr class="hit"> <td class="line">169</td><td class="hits">160</td><td class="source">    if (parameters instanceof Array) {</td></tr><tr class="miss"> <td class="line">170</td><td class="hits">0</td><td class="source">      for (var p = 0; p &lt; parameters.length; ++p) {</td></tr><tr class="miss"> <td class="line">171</td><td class="hits">0</td><td class="source">        if (parameters[p][0] === name) {</td></tr><tr class="miss"> <td class="line">172</td><td class="hits">0</td><td class="source">          if (value === undefined) {</td></tr><tr class="miss"> <td class="line">173</td><td class="hits">0</td><td class="source">            parameters.splice(p, 1);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">          } else {</td></tr><tr class="miss"> <td class="line">175</td><td class="hits">0</td><td class="source">            parameters[p][1] = value;</td></tr><tr class="miss"> <td class="line">176</td><td class="hits">0</td><td class="source">            value = undefined;</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">180</td><td class="hits">0</td><td class="source">      if (value !== undefined) {</td></tr><tr class="miss"> <td class="line">181</td><td class="hits">0</td><td class="source">        parameters.push([name, value]);</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"> <td class="line">184</td><td class="hits">160</td><td class="source">      parameters = OAuth.getParameterMap(parameters);</td></tr><tr class="hit"> <td class="line">185</td><td class="hits">160</td><td class="source">      parameters[name] = value;</td></tr><tr class="hit"> <td class="line">186</td><td class="hits">160</td><td class="source">      message.parameters = parameters;</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">  setParameters: function setParameters(message, parameters) {</td></tr><tr class="miss"> <td class="line">190</td><td class="hits">0</td><td class="source">    var list = OAuth.getParameterList(parameters);</td></tr><tr class="miss"> <td class="line">191</td><td class="hits">0</td><td class="source">    for (var i = 0; i &lt; list.length; ++i) {</td></tr><tr class="miss"> <td class="line">192</td><td class="hits">0</td><td class="source">      OAuth.setParameter(message, list[i][0], list[i][1]);</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  setTimestampAndNonce: function setTimestampAndNonce(message) {</td></tr><tr class="hit"> <td class="line">196</td><td class="hits">40</td><td class="source">    OAuth.setParameter(message, &quot;oauth_timestamp&quot;, OAuth.timestamp());</td></tr><tr class="hit"> <td class="line">197</td><td class="hits">40</td><td class="source">    OAuth.setParameter(message, &quot;oauth_nonce&quot;, OAuth.nonce(32));</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source">  addToURL: function addToURL(url, parameters) {</td></tr><tr class="hit"> <td class="line">200</td><td class="hits">6</td><td class="source">      if (parameters) {</td></tr><tr class="hit"> <td class="line">201</td><td class="hits">6</td><td class="source">        var toAdd = OAuth.formEncode(parameters);</td></tr><tr class="hit"> <td class="line">202</td><td class="hits">6</td><td class="source">        if (toAdd) {</td></tr><tr class="hit"> <td class="line">203</td><td class="hits">6</td><td class="source">          if (url.indexOf('?') &lt; 0) {</td></tr><tr class="hit"> <td class="line">204</td><td class="hits">6</td><td class="source">            url += '?';</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">          } else {</td></tr><tr class="miss"> <td class="line">206</td><td class="hits">0</td><td class="source">            url += '&amp;';</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">          }</td></tr><tr class="hit"> <td class="line">208</td><td class="hits">6</td><td class="source">          url += toAdd;</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">        }</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">211</td><td class="hits">6</td><td class="source">      return url;</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">  /** Construct the value of the Authorization header for an HTTP request. */</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">  getAuthorizationHeader: function getAuthorizationHeader(realm, parameters) {</td></tr><tr class="miss"> <td class="line">215</td><td class="hits">0</td><td class="source">    var header = '';</td></tr><tr class="miss"> <td class="line">216</td><td class="hits">0</td><td class="source">    if (realm) {</td></tr><tr class="miss"> <td class="line">217</td><td class="hits">0</td><td class="source">      header += ', realm=&quot;' + OAuth.percentEncode(realm) + '&quot;';</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">219</td><td class="hits">0</td><td class="source">    var list = OAuth.getParameterList(parameters);</td></tr><tr class="miss"> <td class="line">220</td><td class="hits">0</td><td class="source">    for (var p = 0; p &lt; list.length; ++p) {</td></tr><tr class="miss"> <td class="line">221</td><td class="hits">0</td><td class="source">      var parameter = list[p];</td></tr><tr class="miss"> <td class="line">222</td><td class="hits">0</td><td class="source">      var name = parameter[0];</td></tr><tr class="miss"> <td class="line">223</td><td class="hits">0</td><td class="source">      if (name.indexOf(&quot;oauth_&quot;) === 0) {</td></tr><tr class="miss"> <td class="line">224</td><td class="hits">0</td><td class="source">        header += ', ' + OAuth.percentEncode(name) + '=&quot;' + OAuth.percentEncode(parameter[1]) + '&quot;';</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">227</td><td class="hits">0</td><td class="source">    return 'OAuth ' + header.substring(2);</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">  timestamp: function timestamp() {</td></tr><tr class="hit"> <td class="line">231</td><td class="hits">41</td><td class="source">    return Math.floor(new Date().getTime() / 1000);</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">  nonce: function nonce(length) {</td></tr><tr class="hit"> <td class="line">235</td><td class="hits">141</td><td class="source">    if (!length) {</td></tr><tr class="hit"> <td class="line">236</td><td class="hits">2</td><td class="source">      return '';</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">238</td><td class="hits">139</td><td class="source">    var chars = OAuth.nonce.CHARS;</td></tr><tr class="hit"> <td class="line">239</td><td class="hits">139</td><td class="source">    var result = &quot;&quot;;</td></tr><tr class="hit"> <td class="line">240</td><td class="hits">139</td><td class="source">    for (var i = 0; i &lt; length; ++i) {</td></tr><tr class="hit"> <td class="line">241</td><td class="hits">6230</td><td class="source">      var rnum = Math.floor(Math.random() * chars.length);</td></tr><tr class="hit"> <td class="line">242</td><td class="hits">6230</td><td class="source">      result += chars.substring(rnum, rnum + 1);</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">244</td><td class="hits">139</td><td class="source">    return result;</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">248</td><td class="hits">1</td><td class="source">OAuth.nonce.CHARS = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz&quot;;</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">/** Define a constructor function,</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">    without causing trouble to anyone who was using it as a namespace.</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">    That is, if parent[name] already existed and had properties,</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">    copy those properties into the new constructor.</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">254</td><td class="hits">1</td><td class="source">OAuth.declareClass = function declareClass(parent, name, newConstructor) {</td></tr><tr class="hit"> <td class="line">255</td><td class="hits">1</td><td class="source">  var previous = parent[name];</td></tr><tr class="hit"> <td class="line">256</td><td class="hits">1</td><td class="source">  parent[name] = newConstructor;</td></tr><tr class="hit"> <td class="line">257</td><td class="hits">1</td><td class="source">  if (newConstructor &amp;&amp; previous) {</td></tr><tr class="miss"> <td class="line">258</td><td class="hits">0</td><td class="source">    for (var key in previous) {</td></tr><tr class="miss"> <td class="line">259</td><td class="hits">0</td><td class="source">      if (key !== &quot;prototype&quot;) {</td></tr><tr class="miss"> <td class="line">260</td><td class="hits">0</td><td class="source">        newConstructor[key] = previous[key];</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">264</td><td class="hits">1</td><td class="source">  return newConstructor;</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">/** An abstract algorithm for signing messages. */</td></tr><tr class="hit"> <td class="line">268</td><td class="hits">1</td><td class="source">OAuth.declareClass(OAuth, &quot;SignatureMethod&quot;, function OAuthSignatureMethod() {});</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">// instance members</td></tr><tr class="hit"> <td class="line">271</td><td class="hits">1</td><td class="source">OAuth.setProperties(OAuth.SignatureMethod.prototype, {</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">  /** Add a signature to the message. */</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source">  sign: function sign(message) {</td></tr><tr class="hit"> <td class="line">274</td><td class="hits">40</td><td class="source">    var baseString = OAuth.SignatureMethod.getBaseString(message);</td></tr><tr class="hit"> <td class="line">275</td><td class="hits">40</td><td class="source">    var signature = this.getSignature(baseString);</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">    // console.log(baseString, this.key, signature)</td></tr><tr class="hit"> <td class="line">277</td><td class="hits">40</td><td class="source">    OAuth.setParameter(message, &quot;oauth_signature&quot;, signature);</td></tr><tr class="hit"> <td class="line">278</td><td class="hits">40</td><td class="source">    return signature; // just in case someone's interested</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">  /** Set the key string for signing. */</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source">  initialize: function initialize(name, accessor) {</td></tr><tr class="hit"> <td class="line">282</td><td class="hits">40</td><td class="source">    var consumerSecret;</td></tr><tr class="hit"> <td class="line">283</td><td class="hits">40</td><td class="source">    if (accessor.accessorSecret &amp;&amp; name.length &gt; 9 &amp;&amp; name.substring(name.length-9) === &quot;-Accessor&quot;) {</td></tr><tr class="miss"> <td class="line">284</td><td class="hits">0</td><td class="source">        consumerSecret = accessor.accessorSecret;</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"> <td class="line">286</td><td class="hits">40</td><td class="source">        consumerSecret = accessor.consumerSecret;</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">288</td><td class="hits">40</td><td class="source">    this.key = OAuth.percentEncode(consumerSecret) + &quot;&amp;&quot; + OAuth.percentEncode(accessor.tokenSecret);</td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">/* SignatureMethod expects an accessor object to be like this:</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">   {tokenSecret: &quot;lakjsdflkj...&quot;, consumerSecret: &quot;QOUEWRI..&quot;, accessorSecret: &quot;xcmvzc...&quot;}</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">   The accessorSecret property is optional.</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">// Class members:</td></tr><tr class="hit"> <td class="line">297</td><td class="hits">1</td><td class="source">OAuth.setProperties(OAuth.SignatureMethod, {</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">  sign: function sign(message, accessor) {</td></tr><tr class="hit"> <td class="line">299</td><td class="hits">40</td><td class="source">    var name = OAuth.getParameterMap(message.parameters).oauth_signature_method;</td></tr><tr class="hit"> <td class="line">300</td><td class="hits">40</td><td class="source">    if (!name) {</td></tr><tr class="hit"> <td class="line">301</td><td class="hits">40</td><td class="source">      name = 'HMAC-SHA1';</td></tr><tr class="hit"> <td class="line">302</td><td class="hits">40</td><td class="source">      OAuth.setParameter(message, 'oauth_signature_method', name);</td></tr><tr><td class="line">303</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">304</td><td class="hits">40</td><td class="source">    OAuth.SignatureMethod.newMethod(name, accessor).sign(message);</td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source">  /** Instantiate a SignatureMethod for the given method name. */</td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source">  newMethod: function newMethod(name, accessor) {</td></tr><tr class="hit"> <td class="line">309</td><td class="hits">40</td><td class="source">    var Impl = OAuth.SignatureMethod.REGISTERED[name];</td></tr><tr class="hit"> <td class="line">310</td><td class="hits">40</td><td class="source">    if (typeof Impl === 'function') {</td></tr><tr class="hit"> <td class="line">311</td><td class="hits">40</td><td class="source">      var method = new Impl();</td></tr><tr class="hit"> <td class="line">312</td><td class="hits">40</td><td class="source">      method.initialize(name, accessor);</td></tr><tr class="hit"> <td class="line">313</td><td class="hits">40</td><td class="source">      return method;</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">315</td><td class="hits">0</td><td class="source">    var err = new Error(&quot;signature_method_rejected&quot;);</td></tr><tr class="miss"> <td class="line">316</td><td class="hits">0</td><td class="source">    var acceptable = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">317</td><td class="hits">0</td><td class="source">    for (var r in OAuth.SignatureMethod.REGISTERED) {</td></tr><tr class="miss"> <td class="line">318</td><td class="hits">0</td><td class="source">      if (acceptable) {</td></tr><tr class="miss"> <td class="line">319</td><td class="hits">0</td><td class="source">        acceptable += '&amp;';</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">321</td><td class="hits">0</td><td class="source">      acceptable += OAuth.percentEncode(r);</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">323</td><td class="hits">0</td><td class="source">    err.oauth_acceptable_signature_methods = acceptable;</td></tr><tr class="miss"> <td class="line">324</td><td class="hits">0</td><td class="source">    throw err;</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">  /** A map from signature method name to constructor. */</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source">  REGISTERED: {},</td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">  /** Subsequently, the given constructor will be used for the named methods.</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source">      The constructor will be called with no parameters.</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">      The resulting object should usually implement getSignature(baseString).</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">      You can easily define such a constructor by calling makeSubclass, below.</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source">  registerMethodClass: function registerMethodClass(names, classConstructor) {</td></tr><tr class="hit"> <td class="line">334</td><td class="hits">2</td><td class="source">    for (var n = 0, l = names.length; n &lt; l; ++n) {</td></tr><tr class="hit"> <td class="line">335</td><td class="hits">4</td><td class="source">      OAuth.SignatureMethod.REGISTERED[names[n]] = classConstructor;</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source">  /** Create a subclass of OAuth.SignatureMethod, with the given getSignature function. */</td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">  makeSubclass: function makeSubclass(getSignatureFunction) {</td></tr><tr class="hit"> <td class="line">340</td><td class="hits">2</td><td class="source">    var SuperClass = OAuth.SignatureMethod;</td></tr><tr class="hit"> <td class="line">341</td><td class="hits">2</td><td class="source">    var subClass = function() {</td></tr><tr class="hit"> <td class="line">342</td><td class="hits">40</td><td class="source">      SuperClass.call(this);</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">    }; </td></tr><tr class="hit"> <td class="line">344</td><td class="hits">2</td><td class="source">    subClass.prototype = new SuperClass();</td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source">    // Delete instance variables from prototype:</td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source">    // delete subclass.prototype... There aren't any.</td></tr><tr class="hit"> <td class="line">347</td><td class="hits">2</td><td class="source">    subClass.prototype.getSignature = getSignatureFunction;</td></tr><tr class="hit"> <td class="line">348</td><td class="hits">2</td><td class="source">    subClass.prototype.constructor = subClass;</td></tr><tr class="hit"> <td class="line">349</td><td class="hits">2</td><td class="source">    return subClass;</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source">  getBaseString: function getBaseString(message) {</td></tr><tr class="hit"> <td class="line">352</td><td class="hits">40</td><td class="source">      var URL = message.action;</td></tr><tr class="hit"> <td class="line">353</td><td class="hits">40</td><td class="source">      var q = URL.indexOf('?');</td></tr><tr class="hit"> <td class="line">354</td><td class="hits">40</td><td class="source">      var parameters;</td></tr><tr class="hit"> <td class="line">355</td><td class="hits">40</td><td class="source">      if (q &lt; 0) {</td></tr><tr class="hit"> <td class="line">356</td><td class="hits">40</td><td class="source">          parameters = message.parameters;</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">      } else {</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">          // Combine the URL query string with the other parameters:</td></tr><tr class="miss"> <td class="line">359</td><td class="hits">0</td><td class="source">          parameters = OAuth.decodeForm(URL.substring(q + 1));</td></tr><tr class="miss"> <td class="line">360</td><td class="hits">0</td><td class="source">          var toAdd = OAuth.getParameterList(message.parameters);</td></tr><tr class="miss"> <td class="line">361</td><td class="hits">0</td><td class="source">          for (var a = 0, l = toAdd.length; a &lt; l; ++a) {</td></tr><tr class="miss"> <td class="line">362</td><td class="hits">0</td><td class="source">              parameters.push(toAdd[a]);</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">          }</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">365</td><td class="hits">40</td><td class="source">      return OAuth.percentEncode(message.method.toUpperCase()) + '&amp;' +</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source">        OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(URL)) + '&amp;' +</td></tr><tr><td class="line">367</td><td class="hits"></td><td class="source">        OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(parameters));</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">369</td><td class="hits"></td><td class="source">  normalizeUrl: function normalizeUrl(url) {</td></tr><tr class="hit"> <td class="line">370</td><td class="hits">40</td><td class="source">    var uri = OAuth.SignatureMethod.parseUri(url);</td></tr><tr class="hit"> <td class="line">371</td><td class="hits">40</td><td class="source">    var scheme = uri.protocol.toLowerCase();</td></tr><tr class="hit"> <td class="line">372</td><td class="hits">40</td><td class="source">    var authority = uri.authority.toLowerCase();</td></tr><tr class="hit"> <td class="line">373</td><td class="hits">40</td><td class="source">    var dropPort = (scheme === &quot;http&quot; &amp;&amp; uri.port === 80) || (scheme === &quot;https&quot; &amp;&amp; uri.port === 443);</td></tr><tr class="hit"> <td class="line">374</td><td class="hits">40</td><td class="source">    if (dropPort) {</td></tr><tr><td class="line">375</td><td class="hits"></td><td class="source">      // find the last : in the authority</td></tr><tr class="miss"> <td class="line">376</td><td class="hits">0</td><td class="source">      var index = authority.lastIndexOf(&quot;:&quot;);</td></tr><tr class="miss"> <td class="line">377</td><td class="hits">0</td><td class="source">      if (index &gt;= 0) {</td></tr><tr class="miss"> <td class="line">378</td><td class="hits">0</td><td class="source">        authority = authority.substring(0, index);</td></tr><tr><td class="line">379</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">380</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">381</td><td class="hits">40</td><td class="source">    var path = uri.path;</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source">//        if (!path) {</td></tr><tr><td class="line">383</td><td class="hits"></td><td class="source">//            path = &quot;/&quot;; // conforms to RFC 2616 section 3.2.2</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source">//        }</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">    // we know that there is no query and no fragment here.</td></tr><tr class="hit"> <td class="line">386</td><td class="hits">40</td><td class="source">    return scheme + &quot;://&quot; + authority + path;</td></tr><tr><td class="line">387</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source">  parseUri: function parseUri(str) {</td></tr><tr><td class="line">389</td><td class="hits"></td><td class="source">    /* This function was adapted from parseUri 1.2.1</td></tr><tr><td class="line">390</td><td class="hits"></td><td class="source">       http://stevenlevithan.com/demo/parseuri/js/assets/parseuri.js</td></tr><tr><td class="line">391</td><td class="hits"></td><td class="source">     */</td></tr><tr class="hit"> <td class="line">392</td><td class="hits">40</td><td class="source">    var o = {</td></tr><tr><td class="line">393</td><td class="hits"></td><td class="source">      key: [ &quot;source&quot;,&quot;protocol&quot;,&quot;authority&quot;,&quot;userInfo&quot;,&quot;user&quot;,&quot;password&quot;,&quot;host&quot;,&quot;port&quot;,&quot;relative&quot;,&quot;path&quot;,&quot;directory&quot;,&quot;file&quot;,&quot;query&quot;,&quot;anchor&quot;],</td></tr><tr><td class="line">394</td><td class="hits"></td><td class="source">      parser: { strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/ }};</td></tr><tr class="hit"> <td class="line">395</td><td class="hits">40</td><td class="source">    var m = o.parser.strict.exec(str);</td></tr><tr class="hit"> <td class="line">396</td><td class="hits">40</td><td class="source">    var uri = {};</td></tr><tr class="hit"> <td class="line">397</td><td class="hits">40</td><td class="source">    var i = 14;</td></tr><tr class="hit"> <td class="line">398</td><td class="hits">40</td><td class="source">    while (i--) {</td></tr><tr class="hit"> <td class="line">399</td><td class="hits">560</td><td class="source">      uri[o.key[i]] = m[i] || &quot;&quot;;</td></tr><tr><td class="line">400</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">401</td><td class="hits">40</td><td class="source">    return uri;</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source">  normalizeParameters: function normalizeParameters(parameters) {</td></tr><tr class="hit"> <td class="line">404</td><td class="hits">40</td><td class="source">    if (!parameters) {</td></tr><tr class="miss"> <td class="line">405</td><td class="hits">0</td><td class="source">      return &quot;&quot;;</td></tr><tr><td class="line">406</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">407</td><td class="hits">40</td><td class="source">    var norm = [];</td></tr><tr class="hit"> <td class="line">408</td><td class="hits">40</td><td class="source">    var list = OAuth.getParameterList(parameters);</td></tr><tr class="hit"> <td class="line">409</td><td class="hits">40</td><td class="source">    for (var p = 0; p &lt; list.length; ++p) {</td></tr><tr class="hit"> <td class="line">410</td><td class="hits">372</td><td class="source">      var nvp = list[p];</td></tr><tr class="hit"> <td class="line">411</td><td class="hits">372</td><td class="source">      if (nvp[0] !== &quot;oauth_signature&quot;) {</td></tr><tr class="hit"> <td class="line">412</td><td class="hits">372</td><td class="source">        norm.push(nvp);</td></tr><tr><td class="line">413</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">415</td><td class="hits">40</td><td class="source">    norm.sort(function (a, b) {</td></tr><tr class="hit"> <td class="line">416</td><td class="hits">1225</td><td class="source">      if (a[0] &lt; b[0]) { return -1; }</td></tr><tr class="hit"> <td class="line">417</td><td class="hits">1274</td><td class="source">      if (a[0] &gt; b[0]) { return 1; }</td></tr><tr class="miss"> <td class="line">418</td><td class="hits">0</td><td class="source">      if (a[1] &lt; b[1]) { return  -1; }</td></tr><tr class="miss"> <td class="line">419</td><td class="hits">0</td><td class="source">      if (a[1] &gt; b[1]) { return 1; }</td></tr><tr class="miss"> <td class="line">420</td><td class="hits">0</td><td class="source">      return 0;</td></tr><tr><td class="line">421</td><td class="hits"></td><td class="source">    });</td></tr><tr class="hit"> <td class="line">422</td><td class="hits">40</td><td class="source">    return OAuth.formEncode(norm);</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">424</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">426</td><td class="hits">1</td><td class="source">OAuth.SignatureMethod.registerMethodClass([&quot;PLAINTEXT&quot;, &quot;PLAINTEXT-Accessor&quot;],</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source">OAuth.SignatureMethod.makeSubclass(</td></tr><tr><td class="line">428</td><td class="hits"></td><td class="source">  function getSignature(baseString) {</td></tr><tr class="miss"> <td class="line">429</td><td class="hits">0</td><td class="source">    return this.key;</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">431</td><td class="hits"></td><td class="source">));</td></tr><tr><td class="line">432</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">433</td><td class="hits">1</td><td class="source">OAuth.SignatureMethod.registerMethodClass([&quot;HMAC-SHA1&quot;, &quot;HMAC-SHA1-Accessor&quot;],</td></tr><tr><td class="line">434</td><td class="hits"></td><td class="source">OAuth.SignatureMethod.makeSubclass(</td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">  function getSignature(baseString) {</td></tr><tr class="hit"> <td class="line">436</td><td class="hits">40</td><td class="source">    return utils.base64HmacSha1(baseString, this.key);</td></tr><tr><td class="line">437</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source">));</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">440</td><td class="hits">1</td><td class="source">var root = this; // window on browser</td></tr><tr class="hit"> <td class="line">441</td><td class="hits">1</td><td class="source">if (typeof module === 'undefined') {</td></tr><tr class="miss"> <td class="line">442</td><td class="hits">0</td><td class="source">  root.weibo = root.weibo || {};</td></tr><tr class="miss"> <td class="line">443</td><td class="hits">0</td><td class="source">  root.weibo.OAuth = OAuth;</td></tr><tr><td class="line">444</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="hit"> <td class="line">445</td><td class="hits">1</td><td class="source">  module.exports = OAuth;</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">448</td><td class="hits"></td><td class="source">})();</td></tr></tbody></table></div><div class="file"><h2 id="weibo_util.js">weibo_util.js</h2><div id="stats" class="medium"><div class="percentage">56%</div><div class="sloc">41</div><div class="hits">23</div><div class="misses">18</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * &#230;&#150;&#176;&#230;&#181;&#170;&#229;&#190;&#174;&#229;&#141;&#154;mid&#228;&#184;&#142;url&#228;&#186;&#146;&#232;&#189;&#172;&#229;&#174;&#158;&#231;&#148;&#168;&#229;&#183;&#165;&#229;&#133;&#183;</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * &#228;&#189;&#156;&#232;&#128;&#133;: XiNGRZ (http://weibo.com/xingrz)</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">6</td><td class="hits">1</td><td class="source">var WeiboUtil = module.exports = {</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">    // 62&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#173;&#151;&#229;&#133;&#184;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">    str62keys: [</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">        &quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">        &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;, &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;,</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">        &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;, &quot;L&quot;, &quot;M&quot;, &quot;N&quot;, &quot;O&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;R&quot;, &quot;S&quot;, &quot;T&quot;, &quot;U&quot;, &quot;V&quot;, &quot;W&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">    ],</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> * 62&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;&#232;&#189;&#172;&#230;&#141;&#162;&#228;&#184;&#186;10&#232;&#191;&#155;&#229;&#136;&#182;</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> * @param {String} str62 62&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> * @return {String} 10&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">20</td><td class="hits">1</td><td class="source">WeiboUtil.str62to10 = function (str62) {</td></tr><tr class="miss"> <td class="line">21</td><td class="hits">0</td><td class="source">  var i10 = 0;</td></tr><tr class="miss"> <td class="line">22</td><td class="hits">0</td><td class="source">  for (var i = 0; i &lt; str62.length; i++) {</td></tr><tr class="miss"> <td class="line">23</td><td class="hits">0</td><td class="source">    var n = str62.length - i - 1;</td></tr><tr class="miss"> <td class="line">24</td><td class="hits">0</td><td class="source">    var s = str62[i];</td></tr><tr class="miss"> <td class="line">25</td><td class="hits">0</td><td class="source">    i10 += this.str62keys.indexOf(s) * Math.pow(62, n);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"> <td class="line">27</td><td class="hits">0</td><td class="source">  return i10;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> * 10&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;&#232;&#189;&#172;&#230;&#141;&#162;&#228;&#184;&#186;62&#232;&#191;&#155;&#229;&#136;&#182;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> * @param {String} int10 10&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> * @return {String} 62&#232;&#191;&#155;&#229;&#136;&#182;&#229;&#128;&#188;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">35</td><td class="hits">1</td><td class="source">WeiboUtil.int10to62 = function (int10) {</td></tr><tr class="hit"> <td class="line">36</td><td class="hits">735</td><td class="source">  var s62 = '';</td></tr><tr class="hit"> <td class="line">37</td><td class="hits">735</td><td class="source">  var r = 0;</td></tr><tr class="hit"> <td class="line">38</td><td class="hits">735</td><td class="source">  while (int10 !== 0 &amp;&amp; s62.length &lt; 100) {</td></tr><tr class="hit"> <td class="line">39</td><td class="hits">2319</td><td class="source">    r = int10 % 62;</td></tr><tr class="hit"> <td class="line">40</td><td class="hits">2319</td><td class="source">    s62 = this.str62keys[r] + s62;</td></tr><tr class="hit"> <td class="line">41</td><td class="hits">2319</td><td class="source">    int10 = Math.floor(int10 / 62);</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">43</td><td class="hits">735</td><td class="source">  return s62;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> * URL&#229;&#173;&#151;&#231;&#172;&#166;&#232;&#189;&#172;&#230;&#141;&#162;&#228;&#184;&#186;mid</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> * @param {String} url &#229;&#190;&#174;&#229;&#141;&#154;URL&#229;&#173;&#151;&#231;&#172;&#166;&#239;&#188;&#140;&#229;&#166;&#130; &quot;wr4mOFqpbO&quot;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> * @return {String} &#229;&#190;&#174;&#229;&#141;&#154;mid&#239;&#188;&#140;&#229;&#166;&#130; &quot;201110410216293360&quot;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">51</td><td class="hits">1</td><td class="source">WeiboUtil.url2mid = function (url) {</td></tr><tr class="miss"> <td class="line">52</td><td class="hits">0</td><td class="source">  var mid = '';</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  //&#228;&#187;&#142;&#230;&#156;&#128;&#229;&#144;&#142;&#229;&#190;&#128;&#229;&#137;&#141;&#228;&#187;&#165;4&#229;&#173;&#151;&#232;&#138;&#130;&#228;&#184;&#186;&#228;&#184;&#128;&#231;&#187;&#132;&#232;&#175;&#187;&#229;&#143;&#150;URL&#229;&#173;&#151;&#231;&#172;&#166;</td></tr><tr class="miss"> <td class="line">54</td><td class="hits">0</td><td class="source">  for (var i = url.length - 4; i &gt; -4; i = i - 4) {</td></tr><tr class="miss"> <td class="line">55</td><td class="hits">0</td><td class="source">    var offset1 = i &lt; 0 ? 0 : i;</td></tr><tr class="miss"> <td class="line">56</td><td class="hits">0</td><td class="source">    var offset2 = i + 4;</td></tr><tr class="miss"> <td class="line">57</td><td class="hits">0</td><td class="source">    var str = url.substring(offset1, offset2);</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    </td></tr><tr class="miss"> <td class="line">59</td><td class="hits">0</td><td class="source">    str = this.str62to10(str);</td></tr><tr class="miss"> <td class="line">60</td><td class="hits">0</td><td class="source">    if (offset1 &gt; 0) {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">      //&#232;&#139;&#165;&#228;&#184;&#141;&#230;&#152;&#175;&#231;&#172;&#172;&#228;&#184;&#128;&#231;&#187;&#132;&#239;&#188;&#140;&#229;&#136;&#153;&#228;&#184;&#141;&#232;&#182;&#179;7&#228;&#189;&#141;&#232;&#161;&#165;0</td></tr><tr class="miss"> <td class="line">62</td><td class="hits">0</td><td class="source">      while (str.length &lt; 7) {</td></tr><tr class="miss"> <td class="line">63</td><td class="hits">0</td><td class="source">        str = '0' + str;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    </td></tr><tr class="miss"> <td class="line">67</td><td class="hits">0</td><td class="source">    mid = str + mid;</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  </td></tr><tr class="miss"> <td class="line">70</td><td class="hits">0</td><td class="source">  return mid;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source"> * mid&#232;&#189;&#172;&#230;&#141;&#162;&#228;&#184;&#186;URL&#229;&#173;&#151;&#231;&#172;&#166;</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source"> * @param {String} mid &#229;&#190;&#174;&#229;&#141;&#154;mid&#239;&#188;&#140;&#229;&#166;&#130; &quot;201110410216293360&quot;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source"> * @return {String} &#229;&#190;&#174;&#229;&#141;&#154;URL&#229;&#173;&#151;&#231;&#172;&#166;&#239;&#188;&#140;&#229;&#166;&#130; &quot;wr4mOFqpbO&quot;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">78</td><td class="hits">1</td><td class="source">WeiboUtil.mid2url = function (mid) {</td></tr><tr class="hit"> <td class="line">79</td><td class="hits">264</td><td class="source">  if (!mid) {</td></tr><tr class="miss"> <td class="line">80</td><td class="hits">0</td><td class="source">      return mid;</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">82</td><td class="hits">264</td><td class="source">  mid = String(mid); //mid&#230;&#149;&#176;&#229;&#128;&#188;&#232;&#190;&#131;&#229;&#164;&#167;&#239;&#188;&#140;&#229;&#191;&#133;&#233;&#161;&#187;&#228;&#184;&#186;&#229;&#173;&#151;&#231;&#172;&#166;&#228;&#184;&#178;&#239;&#188;&#129;</td></tr><tr class="hit"> <td class="line">83</td><td class="hits">264</td><td class="source">  if (!/^\d+$/.test(mid)) { return mid; }</td></tr><tr class="hit"> <td class="line">84</td><td class="hits">264</td><td class="source">  var url = '';</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">  // &#228;&#187;&#142;&#230;&#156;&#128;&#229;&#144;&#142;&#229;&#190;&#128;&#229;&#137;&#141;&#228;&#187;&#165;7&#229;&#173;&#151;&#232;&#138;&#130;&#228;&#184;&#186;&#228;&#184;&#128;&#231;&#187;&#132;&#232;&#175;&#187;&#229;&#143;&#150;mid</td></tr><tr class="hit"> <td class="line">86</td><td class="hits">264</td><td class="source">  for (var i = mid.length - 7; i &gt; -7; i = i - 7) {</td></tr><tr class="hit"> <td class="line">87</td><td class="hits">735</td><td class="source">    var offset1 = i &lt; 0 ? 0 : i;</td></tr><tr class="hit"> <td class="line">88</td><td class="hits">735</td><td class="source">    var offset2 = i + 7;</td></tr><tr class="hit"> <td class="line">89</td><td class="hits">735</td><td class="source">    var num = mid.substring(offset1, offset2);</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    </td></tr><tr class="hit"> <td class="line">91</td><td class="hits">735</td><td class="source">    num = this.int10to62(num);</td></tr><tr class="hit"> <td class="line">92</td><td class="hits">735</td><td class="source">    url = num + url;</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">94</td><td class="hits">264</td><td class="source">  return url;</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="tqq.js">tqq.js</h2><div id="stats" class="high"><div class="percentage">93%</div><div class="sloc">189</div><div class="hits">176</div><div class="misses">13</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/tqq.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var inherits = require('util').inherits;</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var TBase = require('./tbase');</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">17</td><td class="hits">1</td><td class="source">function TQQAPI(options) {</td></tr><tr class="hit"> <td class="line">18</td><td class="hits">1</td><td class="source">  TQQAPI.super_.call(this);</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">20</td><td class="hits">1</td><td class="source">  var config = utils.extend({}, options, {</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">    host: 'http://open.t.qq.com/api',</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">    result_format: '',</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    oauth_host: 'https://open.t.qq.com',</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    oauth_authorize:      '/cgi-bin/authorize',</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    oauth_request_token:  '/cgi-bin/request_token',</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    oauth_access_token:   '/cgi-bin/access_token',</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    // &#231;&#171;&#159;&#231;&#132;&#182;&#230;&#152;&#175;&#233;&#128;&#154;&#232;&#191;&#135;get&#228;&#188;&#160;&#233;&#128;&#146;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    oauth_params_by_get: true,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    support_comment: false, // &#228;&#184;&#141;&#230;&#148;&#175;&#230;&#140;&#129;comment_timeline</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    support_do_comment: true,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    support_repost_timeline: true, // &#230;&#148;&#175;&#230;&#140;&#129;&#230;&#159;&#165;&#231;&#156;&#139;&#232;&#189;&#172;&#229;&#143;&#145;&#229;&#136;&#151;&#232;&#161;&#168;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    support_favorites_max_id: true,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    reply_dont_need_at_screen_name: true, // @&#229;&#155;&#158;&#229;&#164;&#141;&#230;&#159;&#144;&#230;&#157;&#161;&#229;&#190;&#174;&#229;&#141;&#154; &#230;&#151;&#160;&#233;&#156;&#128;&#229;&#161;&#171;&#229;&#133;&#133;@screen_name </td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    rt_at_name: true, // RT&#231;&#154;&#132;@name&#232;&#128;&#140;&#228;&#184;&#141;&#230;&#152;&#175;@screen_name</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">    repost_delimiter: ' || ', //&#232;&#189;&#172;&#229;&#143;&#145;&#230;&#151;&#182;&#231;&#154;&#132;&#229;&#136;&#134;&#233;&#154;&#148;&#231;&#172;&#166;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    support_counts: false, // &#229;&#143;&#170;&#230;&#156;&#137;rt_count&#232;&#191;&#153;&#228;&#184;&#170;&#239;&#188;&#140;&#228;&#184;&#141;&#232;&#191;&#135;&#232;&#178;&#140;&#228;&#188;&#188;&#230;&#156;&#137;&#233;&#151;&#174;&#233;&#162;&#152;&#239;&#188;&#140;&#230;&#128;&#187;&#230;&#152;&#175;404&#227;&#128;&#130;&#230;&#154;&#130;&#230;&#151;&#182;&#233;&#154;&#144;&#232;&#151;&#143;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    home_timeline:        '/statuses/home_timeline',</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    mentions:             '/statuses/mentions_timeline',</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    comments_timeline:    '/statuses/mentions_timeline',</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    comments_mentions:    '/statuses/mentions_timeline',</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    repost_timeline:      '/t/re_list',</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    followers:            '/friends/user_fanslist',</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    friends:              '/friends/user_idollist',</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    favorites:            '/fav/list_t',</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    favorites_create:     '/fav/addt',</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    favorites_destroy:    '/fav/delt',</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    count:                '/t/re_count', //&#228;&#187;&#133;&#228;&#187;&#133;&#230;&#152;&#175;&#232;&#189;&#172;&#230;&#146;&#173;&#230;&#149;&#176;</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    show:                 '/t/show',</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    update:               '/t/add',</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    upload:               '/t/add_pic',</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    repost:               '/t/re_add',</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    comment_create:       '/t/comment',</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    comment_reply:        '/t/comment',</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    comments:             '/t/re_list',</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    destroy:              '/t/del',</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    destroy_msg:          '/private/del',</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    direct_messages:      '/private/recv',</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    sent_direct_messages: '/private/send',</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    new_message:          '/private/add',</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    rate_limit_status:    '/account/rate_limit_status',</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    friendships_create:   '/friends/add',</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    friendships_destroy:  '/friends/del',</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    friendships_show:     '/friends/check',</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    reset_count:          '/statuses/reset_count',</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    user_show:            '/user/other_info',</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">    // &#231;&#148;&#168;&#230;&#136;&#183;&#230;&#160;&#135;&#231;&#173;&#190;</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    tags:                 '/tags',</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    create_tag:           '/tags/create',</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    destroy_tag:          '/tags/destroy',</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">    tags_suggestions:     '/tags/suggestions',</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    // &#230;&#144;&#156;&#231;&#180;&#162;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">    search:               '/search/t',</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">    user_search:          '/search/user',</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    verify_credentials:   '/user/info',</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    </td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    gender_map: {0: 'n', 1: 'm', 2: 'f'},</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">    // support apis</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    support_comment_destroy: false,</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">    support_comments_mentions: false,</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    support_comments_to_me: false,</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">    support_comments_by_me: false,</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">91</td><td class="hits">1</td><td class="source">  this.init(config);</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">94</td><td class="hits">1</td><td class="source">inherits(TQQAPI, TBase);</td></tr><tr class="hit"> <td class="line">95</td><td class="hits">1</td><td class="source">module.exports = TQQAPI;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> * Utils methods</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">101</td><td class="hits">1</td><td class="source">TQQAPI.prototype.detect_error = function (method, res, playload, data) {</td></tr><tr class="hit"> <td class="line">102</td><td class="hits">40</td><td class="source">  var headers = res.headers;</td></tr><tr class="hit"> <td class="line">103</td><td class="hits">40</td><td class="source">  var err;</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">40</td><td class="source">  if (res.statusCode === 200 &amp;&amp; headers.status) {</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">1</td><td class="source">    err = new Error(headers.status);</td></tr><tr class="hit"> <td class="line">106</td><td class="hits">39</td><td class="source">  } else if (data.errcode &amp;&amp; data.msg) {</td></tr><tr class="hit"> <td class="line">107</td><td class="hits">9</td><td class="source">    err = new Error(data.msg);</td></tr><tr class="hit"> <td class="line">108</td><td class="hits">30</td><td class="source">  } else if (!data.data &amp;&amp; data.msg &amp;&amp; data.msg !== 'ok') {</td></tr><tr class="miss"> <td class="line">109</td><td class="hits">0</td><td class="source">    err = new Error(data.msg);</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">111</td><td class="hits">40</td><td class="source">  if (err) {</td></tr><tr class="hit"> <td class="line">112</td><td class="hits">10</td><td class="source">    err.name = this.errorname(method);</td></tr><tr class="hit"> <td class="line">113</td><td class="hits">10</td><td class="source">    err.data = data;</td></tr><tr class="hit"> <td class="line">114</td><td class="hits">10</td><td class="source">    return err;</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">116</td><td class="hits">30</td><td class="source">  return TQQAPI.super_.prototype.detect_error.call(this, method, res, playload, data);</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">119</td><td class="hits">1</td><td class="source">TQQAPI.prototype.url_encode = function (text) {</td></tr><tr class="hit"> <td class="line">120</td><td class="hits">8</td><td class="source">  return text;</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source"> * Result getters</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">127</td><td class="hits">1</td><td class="source">TQQAPI.prototype.get_result_items = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">128</td><td class="hits">15</td><td class="source">  if (playload === 'count') {</td></tr><tr class="hit"> <td class="line">129</td><td class="hits">1</td><td class="source">    var counts = [];</td></tr><tr class="hit"> <td class="line">130</td><td class="hits">1</td><td class="source">    for (var id in data) {</td></tr><tr class="hit"> <td class="line">131</td><td class="hits">2</td><td class="source">      var item = data[id];</td></tr><tr class="hit"> <td class="line">132</td><td class="hits">2</td><td class="source">      counts.push({id: id, reposts: item.count, comments: item.mcount});</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">134</td><td class="hits">1</td><td class="source">    return counts;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">136</td><td class="hits">14</td><td class="source">  return data.info;</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source"> * { hasnext: 0,</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">     info: </td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">      [ [Object],</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">        [Object],</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">        [Object] ],</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">     timestamp: 1348753615,</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">     user: { GreenMango: '&#233;&#157;&#146;&#232;&#138;&#146;', 'node-weibo': 'node-weibo' } },</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">// TQQAPI.prototype.get_pagging_cursor = function (data, playload, args) {</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">//   return {};</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">// };</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source"> * Result formatters</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">162</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_result = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">163</td><td class="hits">28</td><td class="source">  data = data.data;</td></tr><tr class="hit"> <td class="line">164</td><td class="hits">28</td><td class="source">  var result = TQQAPI.super_.prototype.format_result.call(this, data, playload, args);</td></tr><tr class="hit"> <td class="line">165</td><td class="hits">28</td><td class="source">  if (data.user) {</td></tr><tr class="hit"> <td class="line">166</td><td class="hits">15</td><td class="source">    result.users = data.user;</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">168</td><td class="hits">28</td><td class="source">  return result;</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">171</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_search_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">172</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">{ city_code: '1',</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">  count: 0,</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">  country_code: '1',</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">  emotiontype: 0,</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">  emotionurl: '',</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">  from: '&#229;&#190;&#174;&#229;&#141;&#154;&#229;&#188;&#128;&#230;&#148;&#190;&#229;&#185;&#179;&#229;&#143;&#176;',</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">  fromurl: 'http://wiki.open.t.qq.com/index.php/%E4%BA%A7%E5%93%81%E7%B1%BBFAQ#.E6.8F.90.E4.BA.A4.E5.BA.94.E7.94.A8.E6.9D.A5.E6.BA.90.E5.AD.97.E6.AE.B5.E5.AE.A1.E6.A0.B8.E8.83.BD.E5.BE.97.E5.88.B0.E4.BB.80.E4.B9.88.E5.A5.BD.E5.A4.84.EF.BC.9F\n',</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">  geo: '&#229;&#185;&#191;&#228;&#184;&#156;&#231;&#156;&#129;&#228;&#184;&#173;&#229;&#177;&#177;&#229;&#184;&#130;&#229;&#186;&#183;&#228;&#185;&#144;&#232;&#183;&#175;&#239;&#188;&#145;&#239;&#188;&#144;&#229;&#143;&#183;',</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">  head: 'http://app.qlogo.cn/mbloghead/cb1c4eb21aa2b52a233a',</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">  id: '102460077174373',</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">  image: null,</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">  isrealname: 2,</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">  isvip: 0,</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">  jing: '113.421234',</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">  latitude: '22.354231',</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">  location: '&#228;&#184;&#173;&#229;&#155;&#189; &#230;&#181;&#153;&#230;&#177;&#159; &#230;&#157;&#173;&#229;&#183;&#158;',</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">  longitude: '113.421234',</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">  mcount: 0,</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  music: null,</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">  name: 'node-weibo',</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">  nick: 'node-weibo',</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">  openid: 'EA68676D5E9DA465822CD0CEB2DC6EF5',</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source">  origtext: '&#232;&#191;&#153;&#230;&#152;&#175;update(user, status, callback) &#231;&#154;&#132;&#229;&#141;&#149;&#229;&#133;&#131;&#230;&#181;&#139;&#232;&#175;&#149;&#239;&#188;&#140;&#229;&#189;&#147;&#229;&#137;&#141;&#230;&#151;&#182;&#233;&#151;&#180; Thu Sep 27 2012 17:04:25 GMT+0800 (CST)',</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">  province_code: '33',</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">  self: 1,</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">  source: null,</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">  status: 0,</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">  text: '&#232;&#191;&#153;&#230;&#152;&#175;update(user, status, callback) &#231;&#154;&#132;&#229;&#141;&#149;&#229;&#133;&#131;&#230;&#181;&#139;&#232;&#175;&#149;&#239;&#188;&#140;&#229;&#189;&#147;&#229;&#137;&#141;&#230;&#151;&#182;&#233;&#151;&#180; Thu Sep 27 2012 17:04:25 GMT+0800 (CST)',</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">  timestamp: 1348736665,</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">  type: 1,</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">  user: { 'node-weibo': 'node-weibo' },</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">  video: null,</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">  wei: '22.354231' }</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source"> * @param {[type]} status [description]</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source"> * @param {[type]} args [description]</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source"> * @return {[type]} [description]</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">215</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_status = function (data, args) {</td></tr><tr class="hit"> <td class="line">216</td><td class="hits">187</td><td class="source">  var status = {};</td></tr><tr class="hit"> <td class="line">217</td><td class="hits">187</td><td class="source">  status.id = String(data.id);</td></tr><tr class="hit"> <td class="line">218</td><td class="hits">187</td><td class="source">  status.t_url = 'http://t.qq.com/p/t/' + data.id;</td></tr><tr class="hit"> <td class="line">219</td><td class="hits">187</td><td class="source">  status.created_at = new Date(data.timestamp * 1000);</td></tr><tr class="hit"> <td class="line">220</td><td class="hits">187</td><td class="source">  status.text = data.origtext;</td></tr><tr class="hit"> <td class="line">221</td><td class="hits">187</td><td class="source">  status.source = '&lt;a href=&quot;' + data.fromurl + '&quot;&gt;' + data.from + '&lt;/a&gt;';</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">  // status.favorited = </td></tr><tr class="hit"> <td class="line">223</td><td class="hits">187</td><td class="source">  if (data.image &amp;&amp; data.image[0]) {</td></tr><tr class="hit"> <td class="line">224</td><td class="hits">82</td><td class="source">    var image = data.image[0];</td></tr><tr class="hit"> <td class="line">225</td><td class="hits">82</td><td class="source">    status.thumbnail_pic = image + '/160';</td></tr><tr class="hit"> <td class="line">226</td><td class="hits">82</td><td class="source">    status.bmiddle_pic = image + '/460';</td></tr><tr class="hit"> <td class="line">227</td><td class="hits">82</td><td class="source">    status.original_pic = image + '/2000';</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">229</td><td class="hits">187</td><td class="source">  if (data.latitude &amp;&amp; String(data.latitude) !== '0') {</td></tr><tr class="hit"> <td class="line">230</td><td class="hits">17</td><td class="source">    status.geo = this.format_geo(data, args);</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">232</td><td class="hits">187</td><td class="source">  if (data.name) {</td></tr><tr class="hit"> <td class="line">233</td><td class="hits">175</td><td class="source">    status.user = this.format_user(data, args);</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">235</td><td class="hits">187</td><td class="source">  status.reposts_count = data.count || 0;</td></tr><tr class="hit"> <td class="line">236</td><td class="hits">187</td><td class="source">  status.comments_count = data.mcount || 0;</td></tr><tr class="hit"> <td class="line">237</td><td class="hits">187</td><td class="source">  if (data.source) {</td></tr><tr class="hit"> <td class="line">238</td><td class="hits">33</td><td class="source">    status.retweeted_status = this.format_status(data.source, args);</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">240</td><td class="hits">187</td><td class="source">  return status;</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">  // type:&#229;&#190;&#174;&#229;&#141;&#154;&#231;&#177;&#187;&#229;&#158;&#139; 1-&#229;&#142;&#159;&#229;&#136;&#155;&#229;&#143;&#145;&#232;&#161;&#168;&#227;&#128;&#129;2-&#232;&#189;&#172;&#232;&#189;&#189;&#227;&#128;&#129;3-&#231;&#167;&#129;&#228;&#191;&#161; 4-&#229;&#155;&#158;&#229;&#164;&#141; 5-&#231;&#169;&#186;&#229;&#155;&#158; 6-&#230;&#143;&#144;&#229;&#143;&#138; 7: &#231;&#130;&#185;&#232;&#175;&#132;</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">//      status.status_type = data.type;</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">//       if(data.type == 7) {</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">//         // &#232;&#133;&#190;&#232;&#174;&#175;&#231;&#154;&#132;&#231;&#130;&#185;&#232;&#175;&#132;&#228;&#188;&#154;&#228;&#187;&#138;&#230;&#151;&#165;hometimeline&#239;&#188;&#140;&#229;&#190;&#136;&#228;&#184;&#141;&#231;&#187;&#153;&#229;&#138;&#155;</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">//         status.status_type = 'comments_timeline';</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">      </td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">//             status.created_at = new Date(data.timestamp * 1000);</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">//             status.timestamp = data.timestamp;</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">//             if(data.image){</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">//                 status.thumbnail_pic = data.image[0] + '/160';</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">//                 status.bmiddle_pic = data.image[0] + '/460';</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source">//                 status.original_pic = data.image[0] + '/2000';</td></tr><tr><td class="line">254</td><td class="hits"></td><td class="source">//             }</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">//       if (data.source) {</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">//         if(data.type == 4) { </td></tr><tr><td class="line">257</td><td class="hits"></td><td class="source">//           // &#229;&#155;&#158;&#229;&#164;&#141;</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">//           status.text = '@' + data.source.name + ' ' + status.text;</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source">//           status.related_dialogue_url = 'http://t.qq.com/p/r/' + status.id;</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">//           status.in_reply_to_status_id = data.source.id;</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">//           status.in_reply_to_screen_name = data.source.nick;</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">//         } else {</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">//           status.retweeted_status = </td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">//             this.format_result_item(data.source, 'status', args, users);</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">//           // &#232;&#175;&#132;&#232;&#174;&#186;</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">//           if(play_load == 'comment') {</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">//             status.status = status.retweeted_status;</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source">//             delete status.retweeted_status;</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">//           }</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">//       status.repost_count = data.count || 0;</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source">//       status.comments_count = data.mcount || 0; // &#232;&#175;&#132;&#232;&#174;&#186;&#230;&#149;&#176;</td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">//       status.source = data.from;</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">//       status.user = this.format_result_item(data, 'user', args, users);</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">//       // &#230;&#148;&#182;&#228;&#187;&#182;&#228;&#186;&#186;</td></tr><tr><td class="line">277</td><td class="hits"></td><td class="source">// //      tohead: &quot;&quot;</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">// //      toisvip: 0</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">// //      toname: &quot;macgirl&quot;</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">// //      tonick: &quot;&#231;&#190;&#142;&#228;&#187;&#170;&quot;</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source">//       if(data.toname) {</td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">//         status.recipient = {</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source">//           name: data.toname,</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">//           nick: data.tonick,</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">//           isvip: data.toisvip,</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">//           head: data.tohead</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">//         };</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source">//         status.recipient = this.format_result_item(status.recipient, 'user', args, users);</td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source">//       }</td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">      </td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">//       // &#229;&#166;&#130;&#230;&#158;&#156;&#230;&#156;&#137;text&#229;&#177;&#158;&#230;&#128;&#167;&#239;&#188;&#140;&#229;&#136;&#153;&#230;&#155;&#191;&#230;&#141;&#162;&#229;&#133;&#182;&#228;&#184;&#173;&#231;&#154;&#132;@xxx &#228;&#184;&#186; &#228;&#184;&#173;&#230;&#150;&#135;&#229;&#144;&#141;(@xxx)</td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">//         if(status &amp;&amp; status.text) {</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">//           var matchs = status.text.match(this.ONLY_AT_USER_RE);</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">//           if(matchs) {</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">//             status.users = {};</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source">//             for(var j=0; j&lt;matchs.length; j++) {</td></tr><tr><td class="line">297</td><td class="hits"></td><td class="source">//               var name = matchs[j].trim().substring(1);</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">//               status.users[name] = users[name];</td></tr><tr><td class="line">299</td><td class="hits"></td><td class="source">//             }</td></tr><tr><td class="line">300</td><td class="hits"></td><td class="source">//           }</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">//         }</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source">//         data = status;</td></tr><tr><td class="line">303</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source">{ birth_day: 1,</td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source">  birth_month: 1,</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">  birth_year: 2010,</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source">  city_code: '1',</td></tr><tr><td class="line">311</td><td class="hits"></td><td class="source">  comp: null,</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">  country_code: '1',</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">  edu: null,</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">  email: '',</td></tr><tr><td class="line">315</td><td class="hits"></td><td class="source">  exp: 56,</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">  fansnum: 3,</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source">  favnum: 0,</td></tr><tr><td class="line">318</td><td class="hits"></td><td class="source">  head: 'http://app.qlogo.cn/mbloghead/2045de7c75623f2c2b06',</td></tr><tr><td class="line">319</td><td class="hits"></td><td class="source">  homecity_code: '',</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">  homecountry_code: '',</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source">  homepage: '',</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">  homeprovince_code: '',</td></tr><tr><td class="line">323</td><td class="hits"></td><td class="source">  hometown_code: '',</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">  idolnum: 46,</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">  industry_code: 0,</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">  introduction: '',</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source">  isent: 0,</td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">  ismyblack: 0,</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source">  ismyfans: 0,</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">  ismyidol: 0,</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">  isrealname: 2,</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">  isvip: 0,</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source">  level: 1,</td></tr><tr><td class="line">334</td><td class="hits"></td><td class="source">  location: '&#228;&#184;&#173;&#229;&#155;&#189; &#230;&#157;&#173;&#229;&#183;&#158;',</td></tr><tr><td class="line">335</td><td class="hits"></td><td class="source">  mutual_fans_num: 0,</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source">  name: 'node-weibo',</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">  nick: 'node-weibo',</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source">  openid: 'EA68676D5E9DA465822CD0CEB2DC6EF5',</td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">  province_code: '33',</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">  regtime: 1348724066,</td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">  send_private_flag: 2,</td></tr><tr><td class="line">342</td><td class="hits"></td><td class="source">  sex: 1,</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">  tag: null,</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">  tweetinfo: </td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source">   [ { city_code: '1',</td></tr><tr><td class="line">346</td><td class="hits"></td><td class="source">       country_code: '1',</td></tr><tr><td class="line">347</td><td class="hits"></td><td class="source">       emotiontype: 0,</td></tr><tr><td class="line">348</td><td class="hits"></td><td class="source">       emotionurl: '',</td></tr><tr><td class="line">349</td><td class="hits"></td><td class="source">       from: '&#232;&#133;&#190;&#232;&#174;&#175;&#229;&#190;&#174;&#229;&#141;&#154;',</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">       fromurl: 'http://t.qq.com\n',</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source">       geo: '',</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source">       id: '70997003338788',</td></tr><tr><td class="line">353</td><td class="hits"></td><td class="source">       image: null,</td></tr><tr><td class="line">354</td><td class="hits"></td><td class="source">       latitude: '0',</td></tr><tr><td class="line">355</td><td class="hits"></td><td class="source">       location: '&#228;&#184;&#173;&#229;&#155;&#189; &#230;&#157;&#173;&#229;&#183;&#158;',</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">       longitude: '0',</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">       music: null,</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">       origtext: '#&#230;&#150;&#176;&#228;&#186;&#186;&#230;&#138;&#165;&#229;&#136;&#176;# &#228;&#188;&#159;&#229;&#164;&#167;&#231;&#154;&#132;&#230;&#151;&#133;&#231;&#168;&#139;&#233;&#131;&#189;&#230;&#152;&#175;&#228;&#187;&#142;&#231;&#172;&#172;&#228;&#184;&#128;&#230;&#157;&#161;&#229;&#190;&#174;&#229;&#141;&#154;&#229;&#188;&#128;&#229;&#167;&#139;&#231;&#154;&#132;&#239;&#188;&#129;',</td></tr><tr><td class="line">359</td><td class="hits"></td><td class="source">       province_code: '33',</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">       self: 1,</td></tr><tr><td class="line">361</td><td class="hits"></td><td class="source">       status: 0,</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">       text: '#&#230;&#150;&#176;&#228;&#186;&#186;&#230;&#138;&#165;&#229;&#136;&#176;# &#228;&#188;&#159;&#229;&#164;&#167;&#231;&#154;&#132;&#230;&#151;&#133;&#231;&#168;&#139;&#233;&#131;&#189;&#230;&#152;&#175;&#228;&#187;&#142;&#231;&#172;&#172;&#228;&#184;&#128;&#230;&#157;&#161;&#229;&#190;&#174;&#229;&#141;&#154;&#229;&#188;&#128;&#229;&#167;&#139;&#231;&#154;&#132;&#239;&#188;&#129;',</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">       timestamp: 1348724111,</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source">       type: 1,</td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">       video: null } ],</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source">  tweetnum: 1,</td></tr><tr><td class="line">367</td><td class="hits"></td><td class="source">  verifyinfo: '' }</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">369</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_user = function (data, args) {</td></tr><tr class="hit"> <td class="line">370</td><td class="hits">177</td><td class="source">  var user = {};</td></tr><tr class="hit"> <td class="line">371</td><td class="hits">177</td><td class="source">  user.id = data.name;</td></tr><tr class="hit"> <td class="line">372</td><td class="hits">177</td><td class="source">  user.t_url = 'http://t.qq.com/' + data.name;</td></tr><tr class="hit"> <td class="line">373</td><td class="hits">177</td><td class="source">  user.screen_name = data.nick;</td></tr><tr class="hit"> <td class="line">374</td><td class="hits">177</td><td class="source">  user.name = data.name;</td></tr><tr class="hit"> <td class="line">375</td><td class="hits">177</td><td class="source">  user.location = data.location || '';</td></tr><tr class="hit"> <td class="line">376</td><td class="hits">177</td><td class="source">  user.description = data.introduction || '';</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source">  // no url</td></tr><tr class="hit"> <td class="line">378</td><td class="hits">177</td><td class="source">  if (data.head) {</td></tr><tr class="hit"> <td class="line">379</td><td class="hits">173</td><td class="source">    user.profile_image_url = data.head + '/50'; // &#231;&#171;&#159;&#231;&#132;&#182;&#231;&#155;&#180;&#230;&#142;&#165;&#232;&#142;&#183;&#229;&#143;&#150;&#231;&#154;&#132;&#229;&#156;&#176;&#229;&#157;&#128;&#230;&#151;&#160;&#230;&#179;&#149;&#230;&#139;&#191;&#229;&#136;&#176;&#229;&#164;&#180;&#229;&#131;&#143;</td></tr><tr class="hit"> <td class="line">380</td><td class="hits">173</td><td class="source">    user.avatar_large = data.head + '/180';</td></tr><tr><td class="line">381</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"> <td class="line">382</td><td class="hits">4</td><td class="source">    user.profile_image_url = 'http://mat1.gtimg.com/www/mb/images/head_50.jpg';</td></tr><tr class="hit"> <td class="line">383</td><td class="hits">4</td><td class="source">    user.avatar_large = 'http://mat1.gtimg.com/www/mb/images/head_180.jpg';</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">385</td><td class="hits">177</td><td class="source">  user.gender = this.config.gender_map[data.sex||0];</td></tr><tr class="hit"> <td class="line">386</td><td class="hits">177</td><td class="source">  user.followers_count = data.fansnum || 0;</td></tr><tr class="hit"> <td class="line">387</td><td class="hits">177</td><td class="source">  user.friends_count = data.idolnum || 0;</td></tr><tr class="hit"> <td class="line">388</td><td class="hits">177</td><td class="source">  user.statuses_count = data.tweetnum || 0;</td></tr><tr class="hit"> <td class="line">389</td><td class="hits">177</td><td class="source">  user.favourites_count = data.favnum || 0;</td></tr><tr class="hit"> <td class="line">390</td><td class="hits">177</td><td class="source">  if (data.regtime) {</td></tr><tr class="hit"> <td class="line">391</td><td class="hits">2</td><td class="source">    user.created_at = new Date(data.regtime * 1000);</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">393</td><td class="hits">177</td><td class="source">  user.following = data.ismyidol || false;</td></tr><tr class="hit"> <td class="line">394</td><td class="hits">177</td><td class="source">  user.follow_me = data.ismyfans || false;</td></tr><tr><td class="line">395</td><td class="hits"></td><td class="source">  // send_private_flag : &#230;&#152;&#175;&#229;&#144;&#166;&#229;&#133;&#129;&#232;&#174;&#184;&#230;&#137;&#128;&#230;&#156;&#137;&#228;&#186;&#186;&#231;&#187;&#153;&#229;&#189;&#147;&#229;&#137;&#141;&#231;&#148;&#168;&#230;&#136;&#183;&#229;&#143;&#145;&#231;&#167;&#129;&#228;&#191;&#161;&#239;&#188;&#140;0-&#228;&#187;&#133;&#230;&#156;&#137;&#229;&#129;&#182;&#229;&#131;&#143;&#239;&#188;&#140;1-&#229;&#144;&#141;&#228;&#186;&#186;+&#229;&#144;&#172;&#228;&#188;&#151;&#239;&#188;&#140;2-&#230;&#137;&#128;&#230;&#156;&#137;&#228;&#186;&#186;,</td></tr><tr class="hit"> <td class="line">396</td><td class="hits">177</td><td class="source">  user.allow_all_act_msg = data.send_private_flag === 2;</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source">  // no geo_enabled</td></tr><tr class="hit"> <td class="line">398</td><td class="hits">177</td><td class="source">  user.verified = !!data.isvip;</td></tr><tr><td class="line">399</td><td class="hits"></td><td class="source">  // no verified_type</td></tr><tr class="hit"> <td class="line">400</td><td class="hits">177</td><td class="source">  user.verified_reason = data.verifyinfo || '';</td></tr><tr><td class="line">401</td><td class="hits"></td><td class="source">  // user.remark = </td></tr><tr class="hit"> <td class="line">402</td><td class="hits">177</td><td class="source">  user.allow_all_comment = true;</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source">  // user.online_status = true;</td></tr><tr class="hit"> <td class="line">404</td><td class="hits">177</td><td class="source">  user.bi_followers_count = data.mutual_fans_num || 0;</td></tr><tr><td class="line">405</td><td class="hits"></td><td class="source">  // user.lang</td></tr><tr class="hit"> <td class="line">406</td><td class="hits">177</td><td class="source">  if (data.tweetinfo &amp;&amp; data.tweetinfo[0]) {</td></tr><tr class="hit"> <td class="line">407</td><td class="hits">2</td><td class="source">    user.status = this.format_status(data.tweetinfo[0], args);</td></tr><tr><td class="line">408</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">409</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">410</td><td class="hits">177</td><td class="source">  if (data.tag) {</td></tr><tr class="hit"> <td class="line">411</td><td class="hits">1</td><td class="source">    user.tags = data.tag;</td></tr><tr><td class="line">412</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">413</td><td class="hits">177</td><td class="source">  return user;</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">416</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_count = function (count, args) {</td></tr><tr class="hit"> <td class="line">417</td><td class="hits">2</td><td class="source">  return count;</td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">420</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_geo = function (data, args) {</td></tr><tr class="hit"> <td class="line">421</td><td class="hits">17</td><td class="source">  var geo = {</td></tr><tr><td class="line">422</td><td class="hits"></td><td class="source">    longitude: data.longitude,</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source">    latitude: data.latitude,</td></tr><tr><td class="line">424</td><td class="hits"></td><td class="source">    // city_name string  City name &quot;&#229;&#185;&#191;&#229;&#183;&#158;&quot;</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source">    // province_name string  Province name &quot;&#229;&#185;&#191;&#228;&#184;&#156;&quot;</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source">    address: data.geo,</td></tr><tr><td class="line">427</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">428</td><td class="hits">17</td><td class="source">  return geo;</td></tr><tr><td class="line">429</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">431</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_comment = function (data, args) {</td></tr><tr class="hit"> <td class="line">432</td><td class="hits">17</td><td class="source">  var comment = this.format_status(data, args);</td></tr><tr class="hit"> <td class="line">433</td><td class="hits">17</td><td class="source">  if (comment.retweeted_status) {</td></tr><tr class="hit"> <td class="line">434</td><td class="hits">15</td><td class="source">    comment.status = comment.retweeted_status;</td></tr><tr class="hit"> <td class="line">435</td><td class="hits">15</td><td class="source">    delete comment.retweeted_status;</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">437</td><td class="hits">17</td><td class="source">  return comment;</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">440</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_message = function (message, args) {</td></tr><tr class="miss"> <td class="line">441</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">443</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">444</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_emotion = function (emotion, args) {</td></tr><tr class="miss"> <td class="line">445</td><td class="hits">0</td><td class="source">  throw new Error('Must override this method.');</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">448</td><td class="hits">1</td><td class="source">TQQAPI.prototype.format_favorite = function (status, args) {</td></tr><tr class="hit"> <td class="line">449</td><td class="hits">19</td><td class="source">  var favorite = {</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">    created_at: new Date(status.storetime * 1000),</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source">    status: this.format_status(status)</td></tr><tr><td class="line">452</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">453</td><td class="hits">19</td><td class="source">  return favorite;</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">456</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">457</td><td class="hits"></td><td class="source"> * Params converters</td></tr><tr><td class="line">458</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">459</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">460</td><td class="hits">1</td><td class="source">TQQAPI.prototype.convert_comment = function (comment) {</td></tr><tr><td class="line">461</td><td class="hits"></td><td class="source">  // http://wiki.open.t.qq.com/index.php/%E5%BE%AE%E5%8D%9A%E7%9B%B8%E5%85%B3/%E7%82%B9%E8%AF%84%E4%B8%80%E6%9D%A1%E5%BE%AE%E5%8D%9A</td></tr><tr class="hit"> <td class="line">462</td><td class="hits">6</td><td class="source">  var data = {</td></tr><tr><td class="line">463</td><td class="hits"></td><td class="source">    content: comment.comment,</td></tr><tr><td class="line">464</td><td class="hits"></td><td class="source">    reid: comment.id</td></tr><tr><td class="line">465</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">466</td><td class="hits">6</td><td class="source">  return data;</td></tr><tr><td class="line">467</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">469</td><td class="hits">1</td><td class="source">TQQAPI.prototype.convert_status = function (status) {</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">  // syncflag &#229;&#190;&#174;&#229;&#141;&#154;&#229;&#144;&#140;&#230;&#173;&#165;&#229;&#136;&#176;&#231;&#169;&#186;&#233;&#151;&#180;&#229;&#136;&#134;&#228;&#186;&#171;&#230;&#160;&#135;&#232;&#174;&#176;&#239;&#188;&#136;&#229;&#143;&#175;&#233;&#128;&#137;&#239;&#188;&#140;0-&#229;&#144;&#140;&#230;&#173;&#165;&#239;&#188;&#140;1-&#228;&#184;&#141;&#229;&#144;&#140;&#230;&#173;&#165;&#239;&#188;&#140;&#233;&#187;&#152;&#232;&#174;&#164;&#228;&#184;&#186;0&#239;&#188;&#137;&#239;&#188;&#140;&#231;&#155;&#174;&#229;&#137;&#141;&#228;&#187;&#133;&#230;&#148;&#175;&#230;&#140;&#129;oauth1.0&#233;&#137;&#180;&#230;&#157;&#131;&#230;&#150;&#185;&#229;&#188;&#143;</td></tr><tr class="hit"> <td class="line">471</td><td class="hits">9</td><td class="source">  var data = {</td></tr><tr><td class="line">472</td><td class="hits"></td><td class="source">    content: status.status</td></tr><tr><td class="line">473</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">474</td><td class="hits">9</td><td class="source">  if (status.long) {</td></tr><tr class="hit"> <td class="line">475</td><td class="hits">4</td><td class="source">    data.longitude = status.long;</td></tr><tr class="hit"> <td class="line">476</td><td class="hits">4</td><td class="source">    data.latitude = status.lat;</td></tr><tr><td class="line">477</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">478</td><td class="hits">9</td><td class="source">  if (status.id) {</td></tr><tr class="hit"> <td class="line">479</td><td class="hits">2</td><td class="source">    data.reid = status.id;</td></tr><tr><td class="line">480</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">481</td><td class="hits">9</td><td class="source">  return data;</td></tr><tr><td class="line">482</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">484</td><td class="hits">1</td><td class="source">TQQAPI.prototype.convert_user = function (user) {</td></tr><tr class="hit"> <td class="line">485</td><td class="hits">1</td><td class="source">  var data = {</td></tr><tr><td class="line">486</td><td class="hits"></td><td class="source">    name: user.uid || user.screen_name</td></tr><tr><td class="line">487</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">488</td><td class="hits">1</td><td class="source">  return data;</td></tr><tr><td class="line">489</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">490</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">491</td><td class="hits">1</td><td class="source">TQQAPI.prototype.convert_ids = function (ids) {</td></tr><tr class="hit"> <td class="line">492</td><td class="hits">2</td><td class="source">  return {</td></tr><tr><td class="line">493</td><td class="hits"></td><td class="source">    ids: ids,</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">    flag: '2'</td></tr><tr><td class="line">495</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">496</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">497</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">499</td><td class="hits"></td><td class="source"> * pageflag</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source"> &#229;&#136;&#134;&#233;&#161;&#181;&#230;&#160;&#135;&#232;&#175;&#134;&#239;&#188;&#136;0&#239;&#188;&#154;&#231;&#172;&#172;&#228;&#184;&#128;&#233;&#161;&#181;&#239;&#188;&#140;1&#239;&#188;&#154;&#229;&#144;&#145;&#228;&#184;&#139;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#140;2&#239;&#188;&#154;&#229;&#144;&#145;&#228;&#184;&#138;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#137;</td></tr><tr><td class="line">501</td><td class="hits"></td><td class="source"> pagetime</td></tr><tr><td class="line">502</td><td class="hits"></td><td class="source"> &#230;&#156;&#172;&#233;&#161;&#181;&#232;&#181;&#183;&#229;&#167;&#139;&#230;&#151;&#182;&#233;&#151;&#180;&#239;&#188;&#136;&#231;&#172;&#172;&#228;&#184;&#128;&#233;&#161;&#181;&#239;&#188;&#154;&#229;&#161;&#171;0&#239;&#188;&#140;&#229;&#144;&#145;&#228;&#184;&#138;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#154;&#229;&#161;&#171;&#228;&#184;&#138;&#228;&#184;&#128;&#230;&#172;&#161;&#232;&#175;&#183;&#230;&#177;&#130;&#232;&#191;&#148;&#229;&#155;&#158;&#231;&#154;&#132;&#231;&#172;&#172;&#228;&#184;&#128;&#230;&#157;&#161;&#232;&#174;&#176;&#229;&#189;&#149;&#230;&#151;&#182;&#233;&#151;&#180;&#239;&#188;&#140;&#229;&#144;&#145;&#228;&#184;&#139;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#154;&#229;&#161;&#171;&#228;&#184;&#138;&#228;&#184;&#128;&#230;&#172;&#161;&#232;&#175;&#183;&#230;&#177;&#130;&#232;&#191;&#148;&#229;&#155;&#158;&#231;&#154;&#132;&#230;&#156;&#128;&#229;&#144;&#142;&#228;&#184;&#128;&#230;&#157;&#161;&#232;&#174;&#176;&#229;&#189;&#149;&#230;&#151;&#182;&#233;&#151;&#180;&#239;&#188;&#137;</td></tr><tr><td class="line">503</td><td class="hits"></td><td class="source"> reqnum</td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source"> &#230;&#175;&#143;&#230;&#172;&#161;&#232;&#175;&#183;&#230;&#177;&#130;&#232;&#174;&#176;&#229;&#189;&#149;&#231;&#154;&#132;&#230;&#157;&#161;&#230;&#149;&#176;&#239;&#188;&#136;1-70&#230;&#157;&#161;&#239;&#188;&#137;</td></tr><tr><td class="line">505</td><td class="hits"></td><td class="source"> type</td></tr><tr><td class="line">506</td><td class="hits"></td><td class="source"> &#230;&#139;&#137;&#229;&#143;&#150;&#231;&#177;&#187;&#229;&#158;&#139;&#239;&#188;&#136;&#233;&#156;&#128;&#229;&#161;&#171;&#229;&#134;&#153;&#229;&#141;&#129;&#232;&#191;&#155;&#229;&#136;&#182;&#230;&#149;&#176;&#229;&#173;&#151;&#239;&#188;&#137;</td></tr><tr><td class="line">507</td><td class="hits"></td><td class="source">0x1 &#229;&#142;&#159;&#229;&#136;&#155;&#229;&#143;&#145;&#232;&#161;&#168; 0x2 &#232;&#189;&#172;&#232;&#189;&#189; &#229;&#166;&#130;&#233;&#156;&#128;&#230;&#139;&#137;&#229;&#143;&#150;&#229;&#164;&#154;&#228;&#184;&#170;&#231;&#177;&#187;&#229;&#158;&#139;&#232;&#175;&#183;&#228;&#189;&#191;&#231;&#148;&#168;|&#239;&#188;&#140;&#229;&#166;&#130;(0x1|0x2)&#229;&#190;&#151;&#229;&#136;&#176;3&#239;&#188;&#140;&#229;&#136;&#153;type=3&#229;&#141;&#179;&#229;&#143;&#175;&#239;&#188;&#140;&#229;&#161;&#171;&#233;&#155;&#182;&#232;&#161;&#168;&#231;&#164;&#186;&#230;&#139;&#137;&#229;&#143;&#150;&#230;&#137;&#128;&#230;&#156;&#137;&#231;&#177;&#187;&#229;&#158;&#139; </td></tr><tr><td class="line">508</td><td class="hits"></td><td class="source"> contenttype</td></tr><tr><td class="line">509</td><td class="hits"></td><td class="source"> &#229;&#134;&#133;&#229;&#174;&#185;&#232;&#191;&#135;&#230;&#187;&#164;&#227;&#128;&#130;0-&#232;&#161;&#168;&#231;&#164;&#186;&#230;&#137;&#128;&#230;&#156;&#137;&#231;&#177;&#187;&#229;&#158;&#139;&#239;&#188;&#140;1-&#229;&#184;&#166;&#230;&#150;&#135;&#230;&#156;&#172;&#239;&#188;&#140;2-&#229;&#184;&#166;&#233;&#147;&#190;&#230;&#142;&#165;&#239;&#188;&#140;4-&#229;&#184;&#166;&#229;&#155;&#190;&#231;&#137;&#135;&#239;&#188;&#140;8-&#229;&#184;&#166;&#232;&#167;&#134;&#233;&#162;&#145;&#239;&#188;&#140;0x10-&#229;&#184;&#166;&#233;&#159;&#179;&#233;&#162;&#145;</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source">  &#229;&#187;&#186;&#232;&#174;&#174;&#228;&#184;&#141;&#228;&#189;&#191;&#231;&#148;&#168;contenttype&#228;&#184;&#186;1&#231;&#154;&#132;&#231;&#177;&#187;&#229;&#158;&#139;&#239;&#188;&#140;&#229;&#166;&#130;&#230;&#158;&#156;&#232;&#166;&#129;&#230;&#139;&#137;&#229;&#143;&#150;&#229;&#143;&#170;&#230;&#156;&#137;&#230;&#150;&#135;&#230;&#156;&#172;&#231;&#154;&#132;&#229;&#190;&#174;&#229;&#141;&#154;&#239;&#188;&#140;&#229;&#187;&#186;&#232;&#174;&#174;&#228;&#189;&#191;&#231;&#148;&#168;0x80</td></tr><tr><td class="line">511</td><td class="hits"></td><td class="source"> * </td></tr><tr><td class="line">512</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">513</td><td class="hits">1</td><td class="source">TQQAPI.prototype.convert_cursor = function (cursor) {</td></tr><tr class="hit"> <td class="line">514</td><td class="hits">14</td><td class="source">  var data = {};</td></tr><tr><td class="line">515</td><td class="hits"></td><td class="source">  // type: &#230;&#139;&#137;&#229;&#143;&#150;&#231;&#177;&#187;&#229;&#158;&#139;, 0x1 &#229;&#142;&#159;&#229;&#136;&#155;&#229;&#143;&#145;&#232;&#161;&#168; 0x2 &#232;&#189;&#172;&#232;&#189;&#189; 0x8 &#229;&#155;&#158;&#229;&#164;&#141; 0x10 &#231;&#169;&#186;&#229;&#155;&#158; 0x20 &#230;&#143;&#144;&#229;&#143;&#138; 0x40 &#231;&#130;&#185;&#232;&#175;&#132;</td></tr><tr class="hit"> <td class="line">516</td><td class="hits">14</td><td class="source">  data.type = String(0x1 | 0x2 | 0x8 | 0x10 | 0x20);</td></tr><tr class="hit"> <td class="line">517</td><td class="hits">14</td><td class="source">  data.contenttype = '0';</td></tr><tr class="hit"> <td class="line">518</td><td class="hits">14</td><td class="source">  data.reqnum = cursor.count;</td></tr><tr class="hit"> <td class="line">519</td><td class="hits">14</td><td class="source">  if (cursor.max_id) {</td></tr><tr><td class="line">520</td><td class="hits"></td><td class="source">    // get older statuses</td></tr><tr class="miss"> <td class="line">521</td><td class="hits">0</td><td class="source">    data.pageflag = '1';</td></tr><tr class="miss"> <td class="line">522</td><td class="hits">0</td><td class="source">    data.pagetime = cursor.max_time;</td></tr><tr class="miss"> <td class="line">523</td><td class="hits">0</td><td class="source">    data.lastid = cursor.max_id;</td></tr><tr class="hit"> <td class="line">524</td><td class="hits">14</td><td class="source">  } else if (cursor.since_id) {</td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source">    // get newer statuses</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source">    // 0&#239;&#188;&#154;&#231;&#172;&#172;&#228;&#184;&#128;&#233;&#161;&#181;&#239;&#188;&#140;1&#239;&#188;&#154;&#229;&#144;&#145;&#228;&#184;&#139;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#140;2&#239;&#188;&#154;&#229;&#144;&#145;&#228;&#184;&#138;&#231;&#191;&#187;&#233;&#161;&#181;</td></tr><tr class="miss"> <td class="line">527</td><td class="hits">0</td><td class="source">    data.pageflag = '2';</td></tr><tr class="miss"> <td class="line">528</td><td class="hits">0</td><td class="source">    data.pagetime = cursor.since_time;</td></tr><tr><td class="line">529</td><td class="hits"></td><td class="source">    // data.lastid = cursor.sina_id;</td></tr><tr><td class="line">530</td><td class="hits"></td><td class="source">  } else {</td></tr><tr><td class="line">531</td><td class="hits"></td><td class="source">    // top page</td></tr><tr class="hit"> <td class="line">532</td><td class="hits">14</td><td class="source">    data.pageflag = '0';</td></tr><tr class="hit"> <td class="line">533</td><td class="hits">14</td><td class="source">    data.pagetime = '0';</td></tr><tr class="hit"> <td class="line">534</td><td class="hits">14</td><td class="source">    data.lastid = '0';</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">536</td><td class="hits">14</td><td class="source">  if (typeof cursor.callback === 'function') {</td></tr><tr class="hit"> <td class="line">537</td><td class="hits">7</td><td class="source">    data = cursor.callback(data);</td></tr><tr><td class="line">538</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">539</td><td class="hits">14</td><td class="source">  return data;</td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">542</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source"> * Status</td></tr><tr><td class="line">544</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">545</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">546</td><td class="hits">1</td><td class="source">TQQAPI.prototype.repost_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">547</td><td class="hits">1</td><td class="source">  cursor.callback = function (data) {</td></tr><tr class="hit"> <td class="line">548</td><td class="hits">1</td><td class="source">    data.rootid = cursor.id;</td></tr><tr class="hit"> <td class="line">549</td><td class="hits">1</td><td class="source">    data.flag = '0';</td></tr><tr><td class="line">550</td><td class="hits"></td><td class="source">    // twitterid &#229;&#190;&#174;&#229;&#141;&#154;id&#239;&#188;&#140;&#228;&#184;&#142;pageflag&#227;&#128;&#129;pagetime&#229;&#133;&#177;&#229;&#144;&#140;&#228;&#189;&#191;&#231;&#148;&#168;&#239;&#188;&#140;&#229;&#174;&#158;&#231;&#142;&#176;&#231;&#191;&#187;&#233;&#161;&#181;&#229;&#138;&#159;&#232;&#131;&#189;&#239;&#188;&#136;&#231;&#172;&#172;1&#233;&#161;&#181;&#229;&#161;&#171;0&#239;&#188;&#140;&#231;&#187;&#167;&#231;&#187;&#173;&#229;&#144;&#145;&#228;&#184;&#139;&#231;&#191;&#187;&#233;&#161;&#181;&#239;&#188;&#140;&#229;&#161;&#171;&#228;&#184;&#138;&#228;&#184;&#128;&#230;&#172;&#161;&#232;&#175;&#183;&#230;&#177;&#130;&#232;&#191;&#148;&#229;&#155;&#158;&#231;&#154;&#132;&#230;&#156;&#128;&#229;&#144;&#142;&#228;&#184;&#128;&#230;&#157;&#161;&#232;&#174;&#176;&#229;&#189;&#149;id&#239;&#188;&#137;</td></tr><tr class="hit"> <td class="line">551</td><td class="hits">1</td><td class="source">    if (data.lastid) {</td></tr><tr class="hit"> <td class="line">552</td><td class="hits">1</td><td class="source">      data.twitterid = data.lastid;</td></tr><tr class="hit"> <td class="line">553</td><td class="hits">1</td><td class="source">      delete data.lastid;</td></tr><tr><td class="line">554</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">555</td><td class="hits">1</td><td class="source">    return data;</td></tr><tr><td class="line">556</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">557</td><td class="hits">1</td><td class="source">  return TQQAPI.super_.prototype.repost_timeline.call(this, user, cursor, callback);</td></tr><tr><td class="line">558</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">559</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">560</td><td class="hits">1</td><td class="source">TQQAPI.prototype.user_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">561</td><td class="hits">2</td><td class="source">  cursor.callback = function (data) {</td></tr><tr class="hit"> <td class="line">562</td><td class="hits">2</td><td class="source">    if (cursor.uid || cursor.screen_name) {</td></tr><tr class="hit"> <td class="line">563</td><td class="hits">1</td><td class="source">      data.name = cursor.uid || cursor.screen_name;</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">565</td><td class="hits">2</td><td class="source">    return data;</td></tr><tr><td class="line">566</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">567</td><td class="hits">2</td><td class="source">  return TQQAPI.super_.prototype.user_timeline.call(this, user, cursor, callback);</td></tr><tr><td class="line">568</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">570</td><td class="hits">1</td><td class="source">TQQAPI.prototype.search = function (user, query, cursor, callback) {</td></tr><tr class="hit"> <td class="line">571</td><td class="hits">1</td><td class="source">  cursor = cursor || {};</td></tr><tr class="hit"> <td class="line">572</td><td class="hits">1</td><td class="source">  var q = {</td></tr><tr><td class="line">573</td><td class="hits"></td><td class="source">    keyword: query.q</td></tr><tr><td class="line">574</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">575</td><td class="hits">1</td><td class="source">  if (query.long &amp;&amp; query.lat &amp;&amp; query.radius) {</td></tr><tr class="miss"> <td class="line">576</td><td class="hits">0</td><td class="source">    q.longitude = query.long;</td></tr><tr class="miss"> <td class="line">577</td><td class="hits">0</td><td class="source">    q.latitude = query.lat;</td></tr><tr class="miss"> <td class="line">578</td><td class="hits">0</td><td class="source">    q.radius = query.radius;</td></tr><tr><td class="line">579</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">580</td><td class="hits">1</td><td class="source">  cursor.callback = function (data) {</td></tr><tr class="hit"> <td class="line">581</td><td class="hits">1</td><td class="source">    data.pagesize = data.reqnum || 20;</td></tr><tr class="hit"> <td class="line">582</td><td class="hits">1</td><td class="source">    return data;</td></tr><tr><td class="line">583</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">584</td><td class="hits">1</td><td class="source">  return TQQAPI.super_.prototype.search.call(this, user, q, cursor, callback);</td></tr><tr><td class="line">585</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">586</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">587</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">588</td><td class="hits"></td><td class="source"> * Comment</td></tr><tr><td class="line">589</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">590</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">591</td><td class="hits">1</td><td class="source">TQQAPI.prototype.comments_timeline = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">592</td><td class="hits">2</td><td class="source">  cursor.callback = function (data) {</td></tr><tr class="hit"> <td class="line">593</td><td class="hits">2</td><td class="source">    data.type = String(0x40);</td></tr><tr class="hit"> <td class="line">594</td><td class="hits">2</td><td class="source">    return data;</td></tr><tr><td class="line">595</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">596</td><td class="hits">2</td><td class="source">  return TQQAPI.super_.prototype.comments_timeline.call(this, user, cursor, callback);</td></tr><tr><td class="line">597</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">598</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">599</td><td class="hits">1</td><td class="source">TQQAPI.prototype.comments = function (user, cursor, callback) {</td></tr><tr class="hit"> <td class="line">600</td><td class="hits">1</td><td class="source">  cursor.callback = function (data) {</td></tr><tr class="hit"> <td class="line">601</td><td class="hits">1</td><td class="source">    data.rootid = cursor.id;</td></tr><tr class="hit"> <td class="line">602</td><td class="hits">1</td><td class="source">    data.flag = '1';</td></tr><tr class="hit"> <td class="line">603</td><td class="hits">1</td><td class="source">    if (data.lastid) {</td></tr><tr class="hit"> <td class="line">604</td><td class="hits">1</td><td class="source">      data.twitterid = data.lastid;</td></tr><tr class="hit"> <td class="line">605</td><td class="hits">1</td><td class="source">      delete data.lastid;</td></tr><tr><td class="line">606</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"> <td class="line">607</td><td class="hits">1</td><td class="source">    return data;</td></tr><tr><td class="line">608</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">609</td><td class="hits">1</td><td class="source">  return TQQAPI.super_.prototype.comments.call(this, user, cursor, callback);</td></tr><tr><td class="line">610</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">611</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">612</td><td class="hits">1</td><td class="source">TQQAPI.prototype.comment_destroy = function (user, cid, callback) {</td></tr><tr class="miss"> <td class="line">613</td><td class="hits">0</td><td class="source">  callback(new TypeError('comment_destroy not support.'));</td></tr><tr><td class="line">614</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">615</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="weibo.js">weibo.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">63</div><div class="hits">60</div><div class="misses">3</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/weibo.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var TBaseOauthV2 = require('./tbase_oauth_v2');</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var inherits = require('util').inherits;</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var weiboutil = require('./weibo_util');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">19</td><td class="hits">1</td><td class="source">function WeiboAPI(options) {</td></tr><tr class="hit"> <td class="line">20</td><td class="hits">2</td><td class="source">  WeiboAPI.super_.call(this);</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">22</td><td class="hits">2</td><td class="source">  var config = utils.extend({}, options, {</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    host:                 'https://api.weibo.com/2',</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    user_home_url:        'http://weibo.com/n/',</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    search_url:           'http://s.weibo.com/weibo/',</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">    oauth_host:           'https://api.weibo.com/oauth2',</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    oauth_authorize:      '/authorize',</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    oauth_access_token:   '/access_token',</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    verify_credentials:   '/users/show',</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    comments:             '/comments/show',</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    comment_create:       '/comments/create',</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    comment_reply:        '/comments/reply',</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    comment_destroy:      '/comments/destroy',</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    support_search: false,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">40</td><td class="hits">2</td><td class="source">  this.init(config);</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">43</td><td class="hits">1</td><td class="source">inherits(WeiboAPI, TBaseOauthV2);</td></tr><tr class="hit"> <td class="line">44</td><td class="hits">1</td><td class="source">module.exports = WeiboAPI;</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> * Result getters</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">50</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.get_result_items = function (data, playload, args) {</td></tr><tr class="hit"> <td class="line">51</td><td class="hits">20</td><td class="source">  return data.statuses || data.comments || data.reposts ||</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    data.messages || data.favorites || data;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> * Result formatters</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">59</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_search_status = function (status, args) {</td></tr><tr class="miss"> <td class="line">60</td><td class="hits">0</td><td class="source">  return status;</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">63</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_status = function (status, args) {</td></tr><tr class="hit"> <td class="line">64</td><td class="hits">266</td><td class="source">  status.id = status.idstr;</td></tr><tr class="hit"> <td class="line">65</td><td class="hits">266</td><td class="source">  status.created_at = new Date(status.created_at);</td></tr><tr class="hit"> <td class="line">66</td><td class="hits">266</td><td class="source">  if (status.user) {</td></tr><tr class="hit"> <td class="line">67</td><td class="hits">258</td><td class="source">    status.user = this.format_user(status.user, args);</td></tr><tr class="hit"> <td class="line">68</td><td class="hits">258</td><td class="source">    status.t_url = 'http://weibo.com/' + status.user.id + '/' + weiboutil.mid2url(status.mid);</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  // geo: { type: 'Point', coordinates: [ 22.354231, 113.421234 ] } latitude, longitude</td></tr><tr class="hit"> <td class="line">72</td><td class="hits">266</td><td class="source">  if (status.geo &amp;&amp; status.geo.type === 'Point' &amp;&amp; status.geo.coordinates) {</td></tr><tr class="hit"> <td class="line">73</td><td class="hits">22</td><td class="source">    var geo = {</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">      latitude: String(status.geo.coordinates[0]),</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">      longitude: String(status.geo.coordinates[1]),</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"> <td class="line">77</td><td class="hits">22</td><td class="source">    status.geo = geo;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">80</td><td class="hits">266</td><td class="source">  if (status.retweeted_status) {</td></tr><tr class="hit"> <td class="line">81</td><td class="hits">52</td><td class="source">    status.retweeted_status = this.format_status(status.retweeted_status, args);</td></tr><tr class="hit"> <td class="line">82</td><td class="hits">52</td><td class="source">    if (!status.retweeted_status.t_url) {</td></tr><tr class="hit"> <td class="line">83</td><td class="hits">3</td><td class="source">      status.retweeted_status.t_url =</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">        'http://weibo.com/' + status.user.id + '/' + weiboutil.mid2url(status.retweeted_status.mid);</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">87</td><td class="hits">266</td><td class="source">  return status;</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">90</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_user = function (user, args) {</td></tr><tr class="hit"> <td class="line">91</td><td class="hits">370</td><td class="source">  user.id = user.idstr;</td></tr><tr class="hit"> <td class="line">92</td><td class="hits">370</td><td class="source">  user.created_at = new Date(user.created_at);</td></tr><tr class="hit"> <td class="line">93</td><td class="hits">370</td><td class="source">  user.t_url = 'http://weibo.com/' + (user.domain || user.id);</td></tr><tr class="hit"> <td class="line">94</td><td class="hits">370</td><td class="source">  if (user.status) {</td></tr><tr class="hit"> <td class="line">95</td><td class="hits">3</td><td class="source">    user.status = this.format_status(user.status, args);</td></tr><tr class="hit"> <td class="line">96</td><td class="hits">3</td><td class="source">    if (!user.status.t_url) {</td></tr><tr class="hit"> <td class="line">97</td><td class="hits">3</td><td class="source">      user.status.t_url = user.t_url + '/' + weiboutil.mid2url(user.status.mid || user.status.id);</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">370</td><td class="source">  return user;</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">103</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_comment = function (comment, args) {</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">109</td><td class="source">  comment.id = comment.idstr;</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">109</td><td class="source">  comment.created_at = new Date(comment.created_at);</td></tr><tr class="hit"> <td class="line">106</td><td class="hits">109</td><td class="source">  if (comment.user) {</td></tr><tr class="hit"> <td class="line">107</td><td class="hits">109</td><td class="source">    comment.user = this.format_user(comment.user, args);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">109</td><td class="hits">109</td><td class="source">  if (comment.status) {</td></tr><tr class="hit"> <td class="line">110</td><td class="hits">79</td><td class="source">    comment.status = this.format_status(comment.status, args);</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">112</td><td class="hits">109</td><td class="source">  if (comment.reply_comment) {</td></tr><tr class="hit"> <td class="line">113</td><td class="hits">30</td><td class="source">    comment.reply_comment = this.format_comment(comment.reply_comment, args);</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">115</td><td class="hits">109</td><td class="source">  return comment;</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">118</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_message = function (message, args) {</td></tr><tr class="miss"> <td class="line">119</td><td class="hits">0</td><td class="source">  return message;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">122</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_emotion = function (emotion, args) {</td></tr><tr class="miss"> <td class="line">123</td><td class="hits">0</td><td class="source">  return emotion;</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">126</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_count = function (count, args) {</td></tr><tr class="hit"> <td class="line">127</td><td class="hits">2</td><td class="source">  count.id = String(count.id);</td></tr><tr class="hit"> <td class="line">128</td><td class="hits">2</td><td class="source">  return count;</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">131</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.format_favorite = function (favorite, args) {</td></tr><tr class="hit"> <td class="line">132</td><td class="hits">20</td><td class="source">  favorite.status = this.format_status(favorite.status);</td></tr><tr class="hit"> <td class="line">133</td><td class="hits">20</td><td class="source">  favorite.created_at = new Date(favorite.favorited_time);</td></tr><tr class="hit"> <td class="line">134</td><td class="hits">20</td><td class="source">  delete favorite.favorited_time;</td></tr><tr class="hit"> <td class="line">135</td><td class="hits">20</td><td class="source">  return favorite;</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source"> * User</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">142</td><td class="hits">1</td><td class="source">WeiboAPI.prototype.verify_credentials = function (user, callback) {</td></tr><tr class="hit"> <td class="line">143</td><td class="hits">1</td><td class="source">  var uid = user.uid || user.id;</td></tr><tr class="hit"> <td class="line">144</td><td class="hits">1</td><td class="source">  return this.user_show(user, uid, null, callback);</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="tbase_oauth_v2.js">tbase_oauth_v2.js</h2><div id="stats" class="high"><div class="percentage">87%</div><div class="sloc">55</div><div class="hits">48</div><div class="misses">7</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/tbase_oauth_v2.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var TBase = require('./tbase');</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var inherits = require('util').inherits;</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var querystring = require('querystring');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> * TAPI Base class, support OAuth v2.0</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">21</td><td class="hits">1</td><td class="source">function TBaseOauthV2() {</td></tr><tr class="hit"> <td class="line">22</td><td class="hits">3</td><td class="source">  TBaseOauthV2.super_.call(this);</td></tr><tr class="hit"> <td class="line">23</td><td class="hits">3</td><td class="source">  this.config.oauth_version = '2.0';</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">26</td><td class="hits">1</td><td class="source">inherits(TBaseOauthV2, TBase);</td></tr><tr class="hit"> <td class="line">27</td><td class="hits">1</td><td class="source">module.exports = TBaseOauthV2;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> * Result formatters</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">33</td><td class="hits">1</td><td class="source">TBaseOauthV2.prototype.format_access_token = function (token) {</td></tr><tr class="miss"> <td class="line">34</td><td class="hits">0</td><td class="source">  token = JSON.parse(token);</td></tr><tr class="miss"> <td class="line">35</td><td class="hits">0</td><td class="source">  return token;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> * OAuth</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">42</td><td class="hits">1</td><td class="source">TBaseOauthV2.prototype.convert_token = function (user) {</td></tr><tr class="hit"> <td class="line">43</td><td class="hits">6</td><td class="source">  var params = {</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    redirect_uri: user.oauth_callback || this.config.oauth_callback,</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    client_id: this.config.appkey,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    response_type: 'code',</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">48</td><td class="hits">6</td><td class="source">  var oauth_scope = user.oauth_scope || this.config.oauth_scope;</td></tr><tr class="hit"> <td class="line">49</td><td class="hits">6</td><td class="source">  if (oauth_scope) {</td></tr><tr class="miss"> <td class="line">50</td><td class="hits">0</td><td class="source">    params.oauth_scope = oauth_scope;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">52</td><td class="hits">6</td><td class="source">  if (user.state) {</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    // An unguessable random string. It is used to protect against cross-site request forgery attacks.</td></tr><tr class="miss"> <td class="line">54</td><td class="hits">0</td><td class="source">    params.state = user.state;</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"> <td class="line">56</td><td class="hits">6</td><td class="source">  return params;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">59</td><td class="hits">1</td><td class="source">TBaseOauthV2.prototype.get_authorization_url = function (user, callback) {</td></tr><tr class="hit"> <td class="line">60</td><td class="hits">4</td><td class="source">  var data = this.convert_token(user);</td></tr><tr class="hit"> <td class="line">61</td><td class="hits">4</td><td class="source">  data.response_type = 'code';</td></tr><tr class="hit"> <td class="line">62</td><td class="hits">4</td><td class="source">  var info = {</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    blogtype: user.blogtype,</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    auth_url: this.format_authorization_url(data)</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">66</td><td class="hits">4</td><td class="source">  process.nextTick(function () {</td></tr><tr class="hit"> <td class="line">67</td><td class="hits">4</td><td class="source">    callback(null, info);</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">69</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">72</td><td class="hits">1</td><td class="source">TBaseOauthV2.prototype.get_access_token = function (user, callback) {</td></tr><tr class="hit"> <td class="line">73</td><td class="hits">2</td><td class="source">  var params = {</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    type: 'POST',</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">    user: user,</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    playload: 'string',</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    api_host: this.config.oauth_host,</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">    request_method: 'get_access_token'</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">80</td><td class="hits">2</td><td class="source">  var data = this.convert_token(user);</td></tr><tr class="hit"> <td class="line">81</td><td class="hits">2</td><td class="source">  data.grant_type = 'authorization_code';</td></tr><tr class="hit"> <td class="line">82</td><td class="hits">2</td><td class="source">  data.client_secret = this.config.secret;</td></tr><tr class="hit"> <td class="line">83</td><td class="hits">2</td><td class="source">  var code = user.code || user.oauth_verifier || user.oauth_pin;</td></tr><tr class="hit"> <td class="line">84</td><td class="hits">2</td><td class="source">  if (code) {</td></tr><tr class="miss"> <td class="line">85</td><td class="hits">0</td><td class="source">    data.code = code;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">88</td><td class="hits">2</td><td class="source">  params.data = data;</td></tr><tr class="hit"> <td class="line">89</td><td class="hits">2</td><td class="source">  var self = this;</td></tr><tr class="hit"> <td class="line">90</td><td class="hits">2</td><td class="source">  var url = self.config.oauth_access_token;</td></tr><tr class="hit"> <td class="line">91</td><td class="hits">2</td><td class="source">  self.send_request(url, params, function (err, token) {</td></tr><tr class="hit"> <td class="line">92</td><td class="hits">2</td><td class="source">    if (err) {</td></tr><tr class="hit"> <td class="line">93</td><td class="hits">1</td><td class="source">      return callback(err);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    // { access_token: '2.00EkofzBtMpzNBb9bc3108d8MwDTTE',</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    // remind_in: '633971',</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    // expires_in: 633971,</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">    // uid: '1827455832' }</td></tr><tr class="hit"> <td class="line">99</td><td class="hits">1</td><td class="source">    token = self.format_access_token(token);</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">1</td><td class="source">    if (!token.access_token) {</td></tr><tr class="hit"> <td class="line">101</td><td class="hits">1</td><td class="source">      var message = token.error || JSON.stringify(token);</td></tr><tr class="hit"> <td class="line">102</td><td class="hits">1</td><td class="source">      err = new Error(message);</td></tr><tr class="hit"> <td class="line">103</td><td class="hits">1</td><td class="source">      err.data = token;</td></tr><tr class="hit"> <td class="line">104</td><td class="hits">1</td><td class="source">      err.name = self.errorname('get_access_token');</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">1</td><td class="source">      return callback(err);</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">107</td><td class="hits">0</td><td class="source">    token.blogtype = user.blogtype;</td></tr><tr class="miss"> <td class="line">108</td><td class="hits">0</td><td class="source">    callback(null, token);</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">110</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">113</td><td class="hits">1</td><td class="source">TBaseOauthV2.prototype.apply_auth = function (url, args, user) {</td></tr><tr class="hit"> <td class="line">114</td><td class="hits">49</td><td class="source">  args.data = args.data || {};</td></tr><tr class="hit"> <td class="line">115</td><td class="hits">49</td><td class="source">  args.data.access_token = user.access_token;</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="github.js">github.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">24</div><div class="hits">23</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/*!</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source"> * node-weibo - lib/github.js</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source"> * Copyright(c) 2012 fengmk2 &lt;fengmk2@gmail.com&gt;</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source"> * MIT Licensed</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">7</td><td class="hits">1</td><td class="source">&quot;use strict&quot;;</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source"> * Module dependencies.</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">13</td><td class="hits">1</td><td class="source">var TBaseOauthV2 = require('./tbase_oauth_v2');</td></tr><tr class="hit"> <td class="line">14</td><td class="hits">1</td><td class="source">var inherits = require('util').inherits;</td></tr><tr class="hit"> <td class="line">15</td><td class="hits">1</td><td class="source">var TSinaAPI = require('./tsina');</td></tr><tr class="hit"> <td class="line">16</td><td class="hits">1</td><td class="source">var utils = require('./utils');</td></tr><tr class="hit"> <td class="line">17</td><td class="hits">1</td><td class="source">var querystring = require('querystring');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">20</td><td class="hits">1</td><td class="source">function GithubAPI(options) {</td></tr><tr class="hit"> <td class="line">21</td><td class="hits">1</td><td class="source">  GithubAPI.super_.call(this);</td></tr><tr class="hit"> <td class="line">22</td><td class="hits">1</td><td class="source">   var config = utils.extend({}, options, {</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    host: 'https://api.github.com',</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">    result_format: '',</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">    oauth_key: '',</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">    oauth_secret: '',</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">    oauth_host: 'https://github.com',</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">    oauth_authorize: '/login/oauth/authorize',</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    oauth_access_token: '/login/oauth/access_token',</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">        </td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    verify_credentials: '/user',</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    user_show: '/users/{{uid}}',</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    support_favorites: false,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"> <td class="line">36</td><td class="hits">1</td><td class="source">  this.init(config);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">39</td><td class="hits">1</td><td class="source">inherits(GithubAPI, TBaseOauthV2);</td></tr><tr class="hit"> <td class="line">40</td><td class="hits">1</td><td class="source">module.exports = GithubAPI;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> * Utils methods</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">46</td><td class="hits">1</td><td class="source">GithubAPI.prototype.url_encode = function (text) {</td></tr><tr class="miss"> <td class="line">47</td><td class="hits">0</td><td class="source">  return text;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> * OAuth</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">54</td><td class="hits">1</td><td class="source">GithubAPI.prototype.convert_token = function (user) {</td></tr><tr class="hit"> <td class="line">55</td><td class="hits">3</td><td class="source">  var data = GithubAPI.super_.prototype.convert_token.call(this, user);</td></tr><tr class="hit"> <td class="line">56</td><td class="hits">3</td><td class="source">  data.state = Date.now();</td></tr><tr class="hit"> <td class="line">57</td><td class="hits">3</td><td class="source">  return data;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> * Result formatters</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source"> */</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">64</td><td class="hits">1</td><td class="source">GithubAPI.prototype.format_access_token = function (token) {</td></tr><tr class="hit"> <td class="line">65</td><td class="hits">1</td><td class="source">  token = querystring.parse(token);</td></tr><tr class="hit"> <td class="line">66</td><td class="hits">1</td><td class="source">  return token;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> *</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">{ </td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  public_repos: 67,</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">  following: 84,</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  created_at: '2009-11-21T08:07:35Z',</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  type: 'User',</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  email: 'fengmk2@gmail.com',</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">  bio: 'nodejs',</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  blog: 'http://fengmk2.github.com',</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  location: 'Hangzhou, China',</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  gravatar_id: '95b9d41231617a05ced5604d242c9670',</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">  avatar_url: 'https://secure.gravatar.com/avatar/95b9d41231617a05ced5604d242c9670?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png',</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  public_gists: 21,</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  followers: 293,</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  login: 'fengmk2',</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">  name: 'fengmk2',</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  company: 'http://www.taobao.com/',</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  id: 156269,</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  html_url: 'https://github.com/fengmk2',</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  hireable: false,</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">  url: 'https://api.github.com/users/fengmk2'</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source"> */</td></tr><tr class="hit"> <td class="line">93</td><td class="hits">1</td><td class="source">GithubAPI.prototype.format_user = function (data) {</td></tr><tr class="hit"> <td class="line">94</td><td class="hits">2</td><td class="source">  var user = {</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    id: data.login,</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    t_url: data.html_url,</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    screen_name: data.name,</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">    name: data.login,</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">    location: data.location,</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">    url: data.blog || data.url,</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    profile_image_url: data.avatar_url + '&amp;s=50',</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    avatar_large: data.avatar_url + '&amp;s=180',</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">    gender: 'n',</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">    following: false,</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    verified: false,</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">    follow_me: false,</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">    followers_count: data.followers,</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">    friends_count: data.following,</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    statuses_count: data.public_repos,</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">    favourites_count: 0,</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">    created_at: new Date(data.created_at),</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">    email: data.email,</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"> <td class="line">114</td><td class="hits">2</td><td class="source">  return user;</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr></tbody></table></div><div class="file"><h2 id="base64.js">base64.js</h2><div id="stats" class="low"><div class="percentage">41%</div><div class="sloc">90</div><div class="hits">37</div><div class="misses">53</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">/**</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">*</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">*  Base64 encode / decode</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">*  http://www.webtoolkit.info/</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">*</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">**/</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">// support atob and btoa native method in browser</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">10</td><td class="hits">1</td><td class="source">(function () {</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">12</td><td class="hits">1</td><td class="source">var Base64 = {</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">14</td><td class="hits"></td><td class="source">  // private property</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">  _keyStr : &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;,</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  // public method for encoding</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  encode: function (input) {</td></tr><tr class="hit"> <td class="line">19</td><td class="hits">8</td><td class="source">    var output = &quot;&quot;;</td></tr><tr class="hit"> <td class="line">20</td><td class="hits">8</td><td class="source">    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;</td></tr><tr class="hit"> <td class="line">21</td><td class="hits">8</td><td class="source">    var i = 0;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">23</td><td class="hits">8</td><td class="source">    input = Base64._utf8_encode(input);</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">25</td><td class="hits">8</td><td class="source">    while (i &lt; input.length) {</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">27</td><td class="hits">158</td><td class="source">      chr1 = input.charCodeAt(i++);</td></tr><tr class="hit"> <td class="line">28</td><td class="hits">158</td><td class="source">      chr2 = input.charCodeAt(i++);</td></tr><tr class="hit"> <td class="line">29</td><td class="hits">158</td><td class="source">      chr3 = input.charCodeAt(i++);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">31</td><td class="hits">158</td><td class="source">      enc1 = chr1 &gt;&gt; 2;</td></tr><tr class="hit"> <td class="line">32</td><td class="hits">158</td><td class="source">      enc2 = ((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4);</td></tr><tr class="hit"> <td class="line">33</td><td class="hits">158</td><td class="source">      enc3 = ((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6);</td></tr><tr class="hit"> <td class="line">34</td><td class="hits">158</td><td class="source">      enc4 = chr3 &amp; 63;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">36</td><td class="hits">158</td><td class="source">      if (isNaN(chr2)) {</td></tr><tr class="miss"> <td class="line">37</td><td class="hits">0</td><td class="source">        enc3 = enc4 = 64;</td></tr><tr class="hit"> <td class="line">38</td><td class="hits">158</td><td class="source">      } else if (isNaN(chr3)) {</td></tr><tr class="hit"> <td class="line">39</td><td class="hits">4</td><td class="source">        enc4 = 64;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">42</td><td class="hits">158</td><td class="source">      output = output +</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">      this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">      this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">48</td><td class="hits">8</td><td class="source">    return output;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  // public method for decoding</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  decode: function (input) {</td></tr><tr class="miss"> <td class="line">53</td><td class="hits">0</td><td class="source">    var output = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">54</td><td class="hits">0</td><td class="source">    var chr1, chr2, chr3;</td></tr><tr class="miss"> <td class="line">55</td><td class="hits">0</td><td class="source">    var enc1, enc2, enc3, enc4;</td></tr><tr class="miss"> <td class="line">56</td><td class="hits">0</td><td class="source">    var i = 0;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">58</td><td class="hits">0</td><td class="source">    input = input.replace(/[^A-Za-z0-9\+\/\=]/g, &quot;&quot;);</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">60</td><td class="hits">0</td><td class="source">    while (i &lt; input.length) {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">62</td><td class="hits">0</td><td class="source">      enc1 = this._keyStr.indexOf(input.charAt(i++));</td></tr><tr class="miss"> <td class="line">63</td><td class="hits">0</td><td class="source">      enc2 = this._keyStr.indexOf(input.charAt(i++));</td></tr><tr class="miss"> <td class="line">64</td><td class="hits">0</td><td class="source">      enc3 = this._keyStr.indexOf(input.charAt(i++));</td></tr><tr class="miss"> <td class="line">65</td><td class="hits">0</td><td class="source">      enc4 = this._keyStr.indexOf(input.charAt(i++));</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">67</td><td class="hits">0</td><td class="source">      chr1 = (enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);</td></tr><tr class="miss"> <td class="line">68</td><td class="hits">0</td><td class="source">      chr2 = ((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);</td></tr><tr class="miss"> <td class="line">69</td><td class="hits">0</td><td class="source">      chr3 = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">71</td><td class="hits">0</td><td class="source">      output = output + String.fromCharCode(chr1);</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">73</td><td class="hits">0</td><td class="source">      if (enc3 != 64) {</td></tr><tr class="miss"> <td class="line">74</td><td class="hits">0</td><td class="source">        output = output + String.fromCharCode(chr2);</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">76</td><td class="hits">0</td><td class="source">      if (enc4 != 64) {</td></tr><tr class="miss"> <td class="line">77</td><td class="hits">0</td><td class="source">        output = output + String.fromCharCode(chr3);</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">82</td><td class="hits">0</td><td class="source">    output = Base64._utf8_decode(output);</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">84</td><td class="hits">0</td><td class="source">    return output;</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  // private method for UTF-8 encoding</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  _utf8_encode : function (string) {</td></tr><tr class="hit"> <td class="line">90</td><td class="hits">8</td><td class="source">    string = string.replace(/\r\n/g,&quot;\n&quot;);</td></tr><tr class="hit"> <td class="line">91</td><td class="hits">8</td><td class="source">    var utftext = &quot;&quot;;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">93</td><td class="hits">8</td><td class="source">    for (var n = 0; n &lt; string.length; n++) {</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">95</td><td class="hits">228</td><td class="source">      var c = string.charCodeAt(n);</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">97</td><td class="hits">228</td><td class="source">      if (c &lt; 128) {</td></tr><tr class="hit"> <td class="line">98</td><td class="hits">102</td><td class="source">        utftext += String.fromCharCode(c);</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"> <td class="line">100</td><td class="hits">126</td><td class="source">      else if ((c &gt; 127) &amp;&amp; (c &lt; 2048)) {</td></tr><tr class="hit"> <td class="line">101</td><td class="hits">10</td><td class="source">        utftext += String.fromCharCode((c &gt;&gt; 6) | 192);</td></tr><tr class="hit"> <td class="line">102</td><td class="hits">10</td><td class="source">        utftext += String.fromCharCode((c &amp; 63) | 128);</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">      else {</td></tr><tr class="hit"> <td class="line">105</td><td class="hits">116</td><td class="source">        utftext += String.fromCharCode((c &gt;&gt; 12) | 224);</td></tr><tr class="hit"> <td class="line">106</td><td class="hits">116</td><td class="source">        utftext += String.fromCharCode(((c &gt;&gt; 6) &amp; 63) | 128);</td></tr><tr class="hit"> <td class="line">107</td><td class="hits">116</td><td class="source">        utftext += String.fromCharCode((c &amp; 63) | 128);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">112</td><td class="hits">8</td><td class="source">    return utftext;</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">  // private method for UTF-8 decoding</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">  _utf8_decode : function (utftext) {</td></tr><tr class="miss"> <td class="line">117</td><td class="hits">0</td><td class="source">    var string = &quot;&quot;;</td></tr><tr class="miss"> <td class="line">118</td><td class="hits">0</td><td class="source">    var i = 0;</td></tr><tr class="miss"> <td class="line">119</td><td class="hits">0</td><td class="source">    var c = 0, c1 = 0, c2 = 0;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">121</td><td class="hits">0</td><td class="source">    while ( i &lt; utftext.length ) {</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">123</td><td class="hits">0</td><td class="source">      c = utftext.charCodeAt(i);</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"> <td class="line">125</td><td class="hits">0</td><td class="source">      if (c &lt; 128) {</td></tr><tr class="miss"> <td class="line">126</td><td class="hits">0</td><td class="source">        string += String.fromCharCode(c);</td></tr><tr class="miss"> <td class="line">127</td><td class="hits">0</td><td class="source">        i++;</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">129</td><td class="hits">0</td><td class="source">      else if((c &gt; 191) &amp;&amp; (c &lt; 224)) {</td></tr><tr class="miss"> <td class="line">130</td><td class="hits">0</td><td class="source">        c2 = utftext.charCodeAt(i+1);</td></tr><tr class="miss"> <td class="line">131</td><td class="hits">0</td><td class="source">        string += String.fromCharCode(((c &amp; 31) &lt;&lt; 6) | (c2 &amp; 63));</td></tr><tr class="miss"> <td class="line">132</td><td class="hits">0</td><td class="source">        i += 2;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">      else {</td></tr><tr class="miss"> <td class="line">135</td><td class="hits">0</td><td class="source">        c2 = utftext.charCodeAt(i+1);</td></tr><tr class="miss"> <td class="line">136</td><td class="hits">0</td><td class="source">        c3 = utftext.charCodeAt(i+2);</td></tr><tr class="miss"> <td class="line">137</td><td class="hits">0</td><td class="source">        string += String.fromCharCode(((c &amp; 15) &lt;&lt; 12) | ((c2 &amp; 63) &lt;&lt; 6) | (c3 &amp; 63));</td></tr><tr class="miss"> <td class="line">138</td><td class="hits">0</td><td class="source">        i += 3;</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"> <td class="line">141</td><td class="hits">0</td><td class="source">    return string;</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">  /**</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">   * A str encode and decode use on phpwind</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">   * e.g.: var my_key = 'awejfosjdlxldfjlsdfwerwljxoasldf!@##@'</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">   *  // encode</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">   *  var encode_str = Base64.strcode('fawave&#229;&#143;&#145;&#229;&#168;&#129;', my_key);</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">   *  // decode</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">   *  var source_str = Base64.strcode(encode_str, my_key, true)</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">   * </td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">   * @param {String} str</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">   * @param {String} key</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">   * @param {Boolen} decode, default is `false`</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">   * @return {String} encode or decode string</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">   * @api public</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">   */</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">  strcode: function (str, key, decode) {</td></tr><tr class="miss"> <td class="line">159</td><td class="hits">0</td><td class="source">      var keybuffer = this.utf8_encode(key);</td></tr><tr class="miss"> <td class="line">160</td><td class="hits">0</td><td class="source">      var key_length = keybuffer.length;</td></tr><tr class="miss"> <td class="line">161</td><td class="hits">0</td><td class="source">      var buffer = null, encoding = 'base64';</td></tr><tr class="miss"> <td class="line">162</td><td class="hits">0</td><td class="source">      if(decode) {</td></tr><tr class="miss"> <td class="line">163</td><td class="hits">0</td><td class="source">        buffer = this.decode(str);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="miss"> <td class="line">165</td><td class="hits">0</td><td class="source">        buffer = this.utf8_encode(str);</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">167</td><td class="hits">0</td><td class="source">      var buf = '';</td></tr><tr class="miss"> <td class="line">168</td><td class="hits">0</td><td class="source">      for (var i = 0, len = buffer.length; i &lt; len; i++) {</td></tr><tr class="miss"> <td class="line">169</td><td class="hits">0</td><td class="source">        var k = i % key_length;</td></tr><tr class="miss"> <td class="line">170</td><td class="hits">0</td><td class="source">        buf += String.fromCharCode(buffer.charCodeAt(i) ^ keybuffer.charCodeAt(k));</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"> <td class="line">172</td><td class="hits">0</td><td class="source">      if (decode) {</td></tr><tr class="miss"> <td class="line">173</td><td class="hits">0</td><td class="source">        return this.utf8_decode(buffer);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="miss"> <td class="line">175</td><td class="hits">0</td><td class="source">        return this.encode(buffer);</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">180</td><td class="hits">1</td><td class="source">Base64.utf8_encode = Base64._utf8_encode;</td></tr><tr class="hit"> <td class="line">181</td><td class="hits">1</td><td class="source">Base64.utf8_decode = Base64._utf8_decode;</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"> <td class="line">183</td><td class="hits">1</td><td class="source">var root = this; // window on browser</td></tr><tr class="hit"> <td class="line">184</td><td class="hits">1</td><td class="source">if (typeof module === 'undefined') {</td></tr><tr class="miss"> <td class="line">185</td><td class="hits">0</td><td class="source">  root.weibo = root.weibo || {};</td></tr><tr class="miss"> <td class="line">186</td><td class="hits">0</td><td class="source">  root.weibo.base64 = Base64;</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="hit"> <td class="line">188</td><td class="hits">1</td><td class="source">  module.exports = Base64;</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">})();</td></tr></tbody></table></div></div></div></body></html>
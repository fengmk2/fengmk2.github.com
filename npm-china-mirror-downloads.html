<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>npm.taobao.org 月下载量统计</title>
</head>
<body>
  <h2>npm.taobao.org / cnpmjs.org 月下载量</h2>
  <div id="c1"></div>
  <h2>npm.taobao.org / cnpmjs.org 年下载量</h2>
  <div id="c2"></div>
  <script src="https://as.alipayobjects.com/g/datavis/g2/1.1.4/index.js"></script>
  <script>
var data = [
  {month: '2014-01', 'npm.taobao.org': 0, 'cnpmjs.org': 169889},
  {month: '2014-02', 'npm.taobao.org': 0, 'cnpmjs.org': 149522},
  {month: '2014-03', 'npm.taobao.org': 0, 'cnpmjs.org': 1130291},
  {month: '2014-04', 'npm.taobao.org': 0, 'cnpmjs.org': 1156330},
  {month: '2014-05', 'npm.taobao.org': 0, 'cnpmjs.org': 515621},
  {month: '2014-06', 'npm.taobao.org': 0, 'cnpmjs.org': 517845},
  {month: '2014-07', 'npm.taobao.org': 0, 'cnpmjs.org': 629654},
  {month: '2014-08', 'npm.taobao.org': 0, 'cnpmjs.org': 635415},
  {month: '2014-09', 'npm.taobao.org': 0, 'cnpmjs.org': 448631},
  {month: '2014-10', 'npm.taobao.org': 1844544, 'cnpmjs.org': 415652},
  {month: '2014-11', 'npm.taobao.org': 3328225, 'cnpmjs.org': 402044},
  {month: '2014-12', 'npm.taobao.org': 3381627, 'cnpmjs.org': 459287},
  {month: '2015-01', 'npm.taobao.org': 4777286, 'cnpmjs.org': 482132},
  {month: '2015-02 新年', 'npm.taobao.org': 4333816, 'cnpmjs.org': 423628},
  {month: '2015-03', 'npm.taobao.org': 7264010, 'cnpmjs.org': 849006},
  {month: '2015-04', 'npm.taobao.org': 8697106, 'cnpmjs.org': 1031368},
  {month: '2015-05', 'npm.taobao.org': 8373910, 'cnpmjs.org': 1003387},
  {month: '2015-06', 'npm.taobao.org': 6904747, 'cnpmjs.org': 1235985},
  {month: '2015-07', 'npm.taobao.org': 12276333, 'cnpmjs.org': 1505126},
  {month: '2015-08', 'npm.taobao.org': 7335825, 'cnpmjs.org': 1366610},
  {month: '2015-09', 'npm.taobao.org': 11118975, 'cnpmjs.org': 1742208},
  {month: '2015-10', 'npm.taobao.org': 9646503, 'cnpmjs.org': 1454715},
  {month: '2015-11', 'npm.taobao.org': 14444223, 'cnpmjs.org': 1707419},
  {month: '2015-12', 'npm.taobao.org': 27598034, 'cnpmjs.org': 1857297},
  {month: '2016-01', 'npm.taobao.org': 26794340, 'cnpmjs.org': 1645012},
  {month: '2016-02 新年', 'npm.taobao.org': 16174961, 'cnpmjs.org': 1262057},
  {month: '2016-03', 'npm.taobao.org': 22741556, 'cnpmjs.org': 2241355},
  {month: '2016-04', 'npm.taobao.org': 26065377, 'cnpmjs.org': 2059887},
  {month: '2016-05', 'npm.taobao.org': 26776883, 'cnpmjs.org': 2173102},
  {month: '2016-06', 'npm.taobao.org': 25692609, 'cnpmjs.org': 2063525},
  {month: '2016-07', 'npm.taobao.org': 34396891, 'cnpmjs.org': 2619863},
  {month: '2016-08', 'npm.taobao.org': 38744968, 'cnpmjs.org': 2342537},
  {month: '2016-09 G20', 'npm.taobao.org': 41987115, 'cnpmjs.org': 2680755},
  {month: '2016-10 国庆', 'npm.taobao.org': 46909227, 'cnpmjs.org': 3357999},
  {month: '2016-11 双十一', 'npm.taobao.org': 62170023, 'cnpmjs.org': 4639624},
  {month: '2016-12', 'npm.taobao.org': 67895414, 'cnpmjs.org': 5087981},
  {month: '2017-01 春节', 'npm.taobao.org': 58318302, 'cnpmjs.org': 3773280},
  {month: '2017-02', 'npm.taobao.org': 68284952, 'cnpmjs.org': 5325388},
  {month: '2017-03', 'npm.taobao.org': 96382073, 'cnpmjs.org': 6317825},
  {month: '2017-04', 'npm.taobao.org': 90960843, 'cnpmjs.org': 4972797},
  {month: '2017-05 五一', 'npm.taobao.org': 96997444, 'cnpmjs.org': 6355417},
  {month: '2017-06', 'npm.taobao.org': 105433225, 'cnpmjs.org': 7216383},
  {month: '2017-07', 'npm.taobao.org': 140596616, 'cnpmjs.org': 8516874},
  {month: '2017-08', 'npm.taobao.org': 133480545, 'cnpmjs.org': 8695480},
  {month: '2017-09', 'npm.taobao.org': 120496788, 'cnpmjs.org': 9674503},
  {month: '2017-10 国庆', 'npm.taobao.org': 106190797, 'cnpmjs.org': 9993397},
  {month: '2017-11', 'npm.taobao.org': 104707802, 'cnpmjs.org': 9593119},
  {month: '2017-12', 'npm.taobao.org': 103177173, 'cnpmjs.org': 6594322},
  {month: '2018-01', 'npm.taobao.org': 137098161, 'cnpmjs.org': 7297965},
  {month: '2018-02 春节', 'npm.taobao.org': 102453574, 'cnpmjs.org': 5250090},
  {month: '2018-03', 'npm.taobao.org': 151937072, 'cnpmjs.org': 10588028},
  {month: '2018-04', 'npm.taobao.org': 125841974, 'cnpmjs.org': 10350815},
  {month: '2018-05 五一', 'npm.taobao.org': 151372104, 'cnpmjs.org': 12352842},
  {month: '2018-06', 'npm.taobao.org': 128404282, 'cnpmjs.org': 13603453},
  {month: '2018-07', 'npm.taobao.org': 185275166, 'cnpmjs.org': 14344773},
  {month: '2018-08 扩容', 'npm.taobao.org': 237290671, 'cnpmjs.org': 13014488},
  {month: '2018-09', 'npm.taobao.org': 178376638, 'cnpmjs.org': 14522472},
  {month: '2018-10 国庆', 'npm.taobao.org': 204731215, 'cnpmjs.org': 15364387},
  {month: '2018-11', 'npm.taobao.org': 224764133, 'cnpmjs.org': 16335000},
  {month: '2018-12', 'npm.taobao.org': 244330578, 'cnpmjs.org': 14155131},
  {month: '2019-01', 'npm.taobao.org': 341407549, 'cnpmjs.org': 15710336},
  {month: '2019-02 春节', 'npm.taobao.org': 431933193, 'cnpmjs.org': 13304892},
  {month: '2019-03 缓存优化', 'npm.taobao.org': 586928994, 'cnpmjs.org': 31975009},
];

var chart = new G2.Chart({
  id: 'c1',
  width: 1200,
  height: 600,
  plotCfg: {
    margin: [20, 200, 80, 80]
  }
});
chart.on('tooltipchange', function(ev) {
  for (var i = 0; i < ev.items.length; i++) {
    var item = ev.items[i];
    item.value = Number(item.value).toLocaleString();
  }
});

var Frame = G2.Frame;
var frame = new Frame(data);
frame = Frame.combinColumns(frame,
  ['npm.taobao.org', 'cnpmjs.org'], '次数', '源站', 'month');

chart.source(frame);
chart.line().position('month*次数').color('源站');
chart.point().position('month*次数').color('源站');
chart.render();

// year
var data2 = [
  { year: '2014', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
  { year: '2015', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
  { year: '2016', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
  { year: '2017', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
  { year: '2018', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
  { year: '2019', 'npm.taobao.org': 0, 'cnpmjs.org': 0 },
];
for (var i = 0; i < data.length; i++) {
  var item = data[i];
  var year = item.month.split('-')[0];
  for (var j = 0; j < data2.length; j++) {
    var yearItem = data2[j];
    if (year === yearItem.year) {
      for (var domain in yearItem) {
        if (domain === 'year') continue;
        yearItem[domain] += item[domain] || 0;
      }
    }
  }
}

var chart2 = new G2.Chart({
  id: 'c2',
  width: 1200,
  height: 600,
  plotCfg: {
    margin: [20, 200, 80, 80]
  }
});

chart2.on('tooltipchange', function(ev) {
  for (var i = 0; i < ev.items.length; i++) {
    var item = ev.items[i];
    item.value = Number(item.value).toLocaleString();
  }
});

var Frame2 = G2.Frame;
var frame2 = new Frame(data2);
frame2 = Frame.combinColumns(frame2,
  ['npm.taobao.org', 'cnpmjs.org'], '次数', '源站', 'year');

chart2.source(frame2);
chart2.line().position('year*次数').color('源站');
chart2.point().position('year*次数').color('源站');
chart2.render();
</script>

</body>
</html>
